
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Built-in Functions - Spark 3.3.2 Documentation</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <link rel="stylesheet" href="css/docsearch.css">

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <nav class="navbar fixed-top navbar-expand-md navbar-light bg-light" id="topbar">
            <div class="container">
                <div class="navbar-header">
                    <div class="navbar-brand"><a href="index.html">
                        <img src="img/spark-logo-hd.png" style="height:50px;"/></a><span class="version">3.3.2</span>
                    </div>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarCollapse" aria-controls="navbarCollapse"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li class="nav-item"><a href="index.html" class="nav-link">Overview</a></li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarQuickStart" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming Guides</a>
                            <div class="dropdown-menu" aria-labelledby="navbarQuickStart">
                                <a class="dropdown-item" href="quick-start.html">Quick Start</a>
                                <a class="dropdown-item" href="rdd-programming-guide.html">RDDs, Accumulators, Broadcasts Vars</a>
                                <a class="dropdown-item" href="sql-programming-guide.html">SQL, DataFrames, and Datasets</a>
                                <a class="dropdown-item" href="structured-streaming-programming-guide.html">Structured Streaming</a>
                                <a class="dropdown-item" href="streaming-programming-guide.html">Spark Streaming (DStreams)</a>
                                <a class="dropdown-item" href="ml-guide.html">MLlib (Machine Learning)</a>
                                <a class="dropdown-item" href="graphx-programming-guide.html">GraphX (Graph Processing)</a>
                                <a class="dropdown-item" href="sparkr.html">SparkR (R on Spark)</a>
                                <a class="dropdown-item" href="api/python/getting_started/index.html">PySpark (Python on Spark)</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarAPIDocs" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">API Docs</a>
                            <div class="dropdown-menu" aria-labelledby="navbarAPIDocs">
                                <a class="dropdown-item" href="api/scala/org/apache/spark/index.html">Scala</a>
                                <a class="dropdown-item" href="api/java/index.html">Java</a>
                                <a class="dropdown-item" href="api/python/index.html">Python</a>
                                <a class="dropdown-item" href="api/R/index.html">R</a>
                                <a class="dropdown-item" href="api/sql/index.html">SQL, Built-in Functions</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDeploying" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Deploying</a>
                            <div class="dropdown-menu" aria-labelledby="navbarDeploying">
                                <a class="dropdown-item" href="cluster-overview.html">Overview</a>
                                <a class="dropdown-item" href="submitting-applications.html">Submitting Applications</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="spark-standalone.html">Spark Standalone</a>
                                <a class="dropdown-item" href="running-on-mesos.html">Mesos</a>
                                <a class="dropdown-item" href="running-on-yarn.html">YARN</a>
                                <a class="dropdown-item" href="running-on-kubernetes.html">Kubernetes</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarMore" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
                            <div class="dropdown-menu" aria-labelledby="navbarMore">
                                <a class="dropdown-item" href="configuration.html">Configuration</a>
                                <a class="dropdown-item" href="monitoring.html">Monitoring</a>
                                <a class="dropdown-item" href="tuning.html">Tuning Guide</a>
                                <a class="dropdown-item" href="job-scheduling.html">Job Scheduling</a>
                                <a class="dropdown-item" href="security.html">Security</a>
                                <a class="dropdown-item" href="hardware-provisioning.html">Hardware Provisioning</a>
                                <a class="dropdown-item" href="migration-guide.html">Migration Guide</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="building-spark.html">Building Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/contributing.html">Contributing to Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/third-party-projects.html">Third Party Projects</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <input type="text" id="docsearch-input" placeholder="Search the docsâ€¦">
                        </li>
                    </ul>
                    <!--<span class="navbar-text navbar-right"><span class="version-text">v3.3.2</span></span>-->
                </div>
            </div>
        </nav>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="sql-programming-guide.html">Spark SQL Guide</a></h3>
        
<ul>

    <li>
        <a href="sql-getting-started.html">
            
                Getting Started
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-data-sources.html">
            
                Data Sources
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-performance-tuning.html">
            
                Performance Tuning
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-distributed-sql-engine.html">
            
                Distributed SQL Engine
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-pyspark-pandas-with-arrow.html">
            
                PySpark Usage Guide for Pandas with Apache Arrow
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-migration-old.html">
            
                Migration Guide
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref.html">
            
                SQL Reference
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-ansi-compliance.html">
            
                ANSI Compliance
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datatypes.html">
            
                Data Types
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datetime-pattern.html">
            
                Datetime Pattern
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-number-pattern.html">
            
                Number Pattern
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-functions.html">
            
                Functions
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-identifier.html">
            
                Identifiers
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-literals.html">
            
                Literals
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-null-semantics.html">
            
                Null Semantics
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax.html">
            
                SQL Syntax
            
        </a>
    </li>
    
    

</ul>

    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" checked type="checkbox">
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar mr-3" id="content">
                    
                        <h1 class="title">Built-in Functions</h1>
                    

                    
<h3 id="aggregate-functions">Aggregate Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>any(expr)</td>
      <td>Returns true if at least one value of `expr` is true.</td>
    </tr>
    <tr>
      <td>approx_count_distinct(expr[, relativeSD])</td>
      <td>Returns the estimated cardinality by HyperLogLog++.
      `relativeSD` defines the maximum relative standard deviation allowed.</td>
    </tr>
    <tr>
      <td>approx_percentile(col, percentage [, accuracy])</td>
      <td>Returns the approximate `percentile` of the numeric or
      ansi interval column `col` which is the smallest value in the ordered `col` values (sorted
      from least to greatest) such that no more than `percentage` of `col` values is less than
      the value or equal to that value. The value of percentage must be between 0.0 and 1.0.
      The `accuracy` parameter (default: 10000) is a positive numeric literal which controls
      approximation accuracy at the cost of memory. Higher value of `accuracy` yields better
      accuracy, `1.0/accuracy` is the relative error of the approximation.
      When `percentage` is an array, each value of the percentage array must be between 0.0 and 1.0.
      In this case, returns the approximate percentile array of column `col` at the given
      percentage array.</td>
    </tr>
    <tr>
      <td>array_agg(expr)</td>
      <td>Collects and returns a list of non-unique elements.</td>
    </tr>
    <tr>
      <td>avg(expr)</td>
      <td>Returns the mean calculated from values of a group.</td>
    </tr>
    <tr>
      <td>bit_and(expr)</td>
      <td>Returns the bitwise AND of all non-null input values, or null if none.</td>
    </tr>
    <tr>
      <td>bit_or(expr)</td>
      <td>Returns the bitwise OR of all non-null input values, or null if none.</td>
    </tr>
    <tr>
      <td>bit_xor(expr)</td>
      <td>Returns the bitwise XOR of all non-null input values, or null if none.</td>
    </tr>
    <tr>
      <td>bool_and(expr)</td>
      <td>Returns true if all values of `expr` are true.</td>
    </tr>
    <tr>
      <td>bool_or(expr)</td>
      <td>Returns true if at least one value of `expr` is true.</td>
    </tr>
    <tr>
      <td>collect_list(expr)</td>
      <td>Collects and returns a list of non-unique elements.</td>
    </tr>
    <tr>
      <td>collect_set(expr)</td>
      <td>Collects and returns a set of unique elements.</td>
    </tr>
    <tr>
      <td>corr(expr1, expr2)</td>
      <td>Returns Pearson coefficient of correlation between a set of number pairs.</td>
    </tr>
    <tr>
      <td>count(*)</td>
      <td>Returns the total number of retrieved rows, including rows containing null.</td>
    </tr>
    <tr>
      <td>    count(expr[, expr...])</td>
      <td>Returns the number of rows for which the supplied expression(s) are all non-null.</td>
    </tr>
    <tr>
      <td>    count(DISTINCT expr[, expr...])</td>
      <td>Returns the number of rows for which the supplied expression(s) are unique and non-null.</td>
    </tr>
    <tr>
      <td>count_if(expr)</td>
      <td>Returns the number of `TRUE` values for the expression.</td>
    </tr>
    <tr>
      <td>count_min_sketch(col, eps, confidence, seed)</td>
      <td>Returns a count-min sketch of a column with the given esp,
      confidence and seed. The result is an array of bytes, which can be deserialized to a
      `CountMinSketch` before usage. Count-min sketch is a probabilistic data structure used for
      cardinality estimation using sub-linear space.</td>
    </tr>
    <tr>
      <td>covar_pop(expr1, expr2)</td>
      <td>Returns the population covariance of a set of number pairs.</td>
    </tr>
    <tr>
      <td>covar_samp(expr1, expr2)</td>
      <td>Returns the sample covariance of a set of number pairs.</td>
    </tr>
    <tr>
      <td>every(expr)</td>
      <td>Returns true if all values of `expr` are true.</td>
    </tr>
    <tr>
      <td>first(expr[, isIgnoreNull])</td>
      <td>Returns the first value of `expr` for a group of rows.
      If `isIgnoreNull` is true, returns only non-null values.</td>
    </tr>
    <tr>
      <td>first_value(expr[, isIgnoreNull])</td>
      <td>Returns the first value of `expr` for a group of rows.
      If `isIgnoreNull` is true, returns only non-null values.</td>
    </tr>
    <tr>
      <td>grouping(col)</td>
      <td>indicates whether a specified column in a GROUP BY is aggregated or
      not, returns 1 for aggregated or 0 for not aggregated in the result set.",</td>
    </tr>
    <tr>
      <td>grouping_id([col1[, col2 ..]])</td>
      <td>returns the level of grouping, equals to
      `(grouping(c1) &lt;&lt; (n-1)) + (grouping(c2) &lt;&lt; (n-2)) + ... + grouping(cn)`</td>
    </tr>
    <tr>
      <td>histogram_numeric(expr, nb)</td>
      <td>Computes a histogram on numeric 'expr' using nb bins.
      The return value is an array of (x,y) pairs representing the centers of the
      histogram's bins. As the value of 'nb' is increased, the histogram approximation
      gets finer-grained, but may yield artifacts around outliers. In practice, 20-40
      histogram bins appear to work well, with more bins being required for skewed or
      smaller datasets. Note that this function creates a histogram with non-uniform
      bin widths. It offers no guarantees in terms of the mean-squared-error of the
      histogram, but in practice is comparable to the histograms produced by the R/S-Plus
      statistical computing packages. Note: the output type of the 'x' field in the return value is
      propagated from the input value consumed in the aggregate function.</td>
    </tr>
    <tr>
      <td>kurtosis(expr)</td>
      <td>Returns the kurtosis value calculated from values of a group.</td>
    </tr>
    <tr>
      <td>last(expr[, isIgnoreNull])</td>
      <td>Returns the last value of `expr` for a group of rows.
      If `isIgnoreNull` is true, returns only non-null values</td>
    </tr>
    <tr>
      <td>last_value(expr[, isIgnoreNull])</td>
      <td>Returns the last value of `expr` for a group of rows.
      If `isIgnoreNull` is true, returns only non-null values</td>
    </tr>
    <tr>
      <td>max(expr)</td>
      <td>Returns the maximum value of `expr`.</td>
    </tr>
    <tr>
      <td>max_by(x, y)</td>
      <td>Returns the value of `x` associated with the maximum value of `y`.</td>
    </tr>
    <tr>
      <td>mean(expr)</td>
      <td>Returns the mean calculated from values of a group.</td>
    </tr>
    <tr>
      <td>min(expr)</td>
      <td>Returns the minimum value of `expr`.</td>
    </tr>
    <tr>
      <td>min_by(x, y)</td>
      <td>Returns the value of `x` associated with the minimum value of `y`.</td>
    </tr>
    <tr>
      <td>percentile(col, percentage [, frequency])</td>
      <td>Returns the exact percentile value of numeric
       column `col` at the given percentage. The value of percentage must be
       between 0.0 and 1.0. The value of frequency should be positive integral</td>
    </tr>
    <tr>
      <td>      percentile(col, array(percentage1 [, percentage2]...) [, frequency])</td>
      <td>Returns the exact
      percentile value array of numeric column `col` at the given percentage(s). Each value
      of the percentage array must be between 0.0 and 1.0. The value of frequency should be
      positive integral</td>
    </tr>
    <tr>
      <td>percentile_approx(col, percentage [, accuracy])</td>
      <td>Returns the approximate `percentile` of the numeric or
      ansi interval column `col` which is the smallest value in the ordered `col` values (sorted
      from least to greatest) such that no more than `percentage` of `col` values is less than
      the value or equal to that value. The value of percentage must be between 0.0 and 1.0.
      The `accuracy` parameter (default: 10000) is a positive numeric literal which controls
      approximation accuracy at the cost of memory. Higher value of `accuracy` yields better
      accuracy, `1.0/accuracy` is the relative error of the approximation.
      When `percentage` is an array, each value of the percentage array must be between 0.0 and 1.0.
      In this case, returns the approximate percentile array of column `col` at the given
      percentage array.</td>
    </tr>
    <tr>
      <td>regr_avgx(y, x)</td>
      <td>Returns the average of the independent variable for non-null pairs in a group, where `y` is the dependent variable and `x` is the independent variable.</td>
    </tr>
    <tr>
      <td>regr_avgy(y, x)</td>
      <td>Returns the average of the dependent variable for non-null pairs in a group, where `y` is the dependent variable and `x` is the independent variable.</td>
    </tr>
    <tr>
      <td>regr_count(y, x)</td>
      <td>Returns the number of non-null number pairs in a group, where `y` is the dependent variable and `x` is the independent variable.</td>
    </tr>
    <tr>
      <td>regr_r2(y, x)</td>
      <td>Returns the coefficient of determination for non-null pairs in a group, where `y` is the dependent variable and `x` is the independent variable.</td>
    </tr>
    <tr>
      <td>skewness(expr)</td>
      <td>Returns the skewness value calculated from values of a group.</td>
    </tr>
    <tr>
      <td>some(expr)</td>
      <td>Returns true if at least one value of `expr` is true.</td>
    </tr>
    <tr>
      <td>std(expr)</td>
      <td>Returns the sample standard deviation calculated from values of a group.</td>
    </tr>
    <tr>
      <td>stddev(expr)</td>
      <td>Returns the sample standard deviation calculated from values of a group.</td>
    </tr>
    <tr>
      <td>stddev_pop(expr)</td>
      <td>Returns the population standard deviation calculated from values of a group.</td>
    </tr>
    <tr>
      <td>stddev_samp(expr)</td>
      <td>Returns the sample standard deviation calculated from values of a group.</td>
    </tr>
    <tr>
      <td>sum(expr)</td>
      <td>Returns the sum calculated from values of a group.</td>
    </tr>
    <tr>
      <td>try_avg(expr)</td>
      <td>Returns the mean calculated from values of a group and the result is null on overflow.</td>
    </tr>
    <tr>
      <td>try_sum(expr)</td>
      <td>Returns the sum calculated from values of a group and the result is null on overflow.</td>
    </tr>
    <tr>
      <td>var_pop(expr)</td>
      <td>Returns the population variance calculated from values of a group.</td>
    </tr>
    <tr>
      <td>var_samp(expr)</td>
      <td>Returns the sample variance calculated from values of a group.</td>
    </tr>
    <tr>
      <td>variance(expr)</td>
      <td>Returns the sample variance calculated from values of a group.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- any</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">any</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- approx_count_distinct</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">approx_count_distinct</span><span class="p">(</span><span class="n">col1</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">approx_count_distinct</span><span class="p">(</span><span class="n">col1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="c1">-- approx_percentile</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                        </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">approx_percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="p">[</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="n">SE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>

<span class="c1">-- array_agg</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_agg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">collect_list</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- avg</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- bit_and</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bit_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- bit_or</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">bit_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- bit_xor</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_xor</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bit_xor</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">6</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- bool_and</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">bool_and</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- bool_or</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bool_or</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- collect_list</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">collect_list</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">collect_list</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- collect_set</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">collect_set</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">collect_set</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">          </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- corr</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">corr</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">corr</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">8660254037844387</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- count</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- count_if</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">count_if</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">count_if</span><span class="p">(((</span><span class="n">col</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">count_if</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">count_if</span><span class="p">((</span><span class="n">col</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- count_min_sketch</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">count_min_sketch</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">count_min_sketch</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">00000001000000000</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="c1">-- covar_pop</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">covar_pop</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">covar_pop</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">6666666666666666</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- covar_samp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">covar_samp</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">covar_samp</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- every</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">every</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- first</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="k">first</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- first_value</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">first_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- grouping</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">grouping</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">people</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">cube</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----+--------------+--------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="o">|</span><span class="k">grouping</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+--------------+--------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">null</span><span class="o">|</span><span class="w">             </span><span class="mi">1</span><span class="o">|</span><span class="w">       </span><span class="mi">7</span><span class="o">|</span>
<span class="o">|</span><span class="n">Alice</span><span class="o">|</span><span class="w">             </span><span class="mi">0</span><span class="o">|</span><span class="w">       </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Bob</span><span class="o">|</span><span class="w">             </span><span class="mi">0</span><span class="o">|</span><span class="w">       </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+--------------+--------+</span>

<span class="c1">-- grouping_id</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">grouping_id</span><span class="p">(),</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">165</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">)</span><span class="w"> </span><span class="n">people</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">cube</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----+-------------+--------+-----------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="o">|</span><span class="n">grouping_id</span><span class="p">()</span><span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="o">|</span><span class="k">avg</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+-------------+--------+-----------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">null</span><span class="o">|</span><span class="w">            </span><span class="mi">2</span><span class="o">|</span><span class="w">       </span><span class="mi">2</span><span class="o">|</span><span class="w">      </span><span class="mi">165</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="n">Alice</span><span class="o">|</span><span class="w">            </span><span class="mi">0</span><span class="o">|</span><span class="w">       </span><span class="mi">2</span><span class="o">|</span><span class="w">      </span><span class="mi">165</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="n">Alice</span><span class="o">|</span><span class="w">            </span><span class="mi">1</span><span class="o">|</span><span class="w">       </span><span class="mi">2</span><span class="o">|</span><span class="w">      </span><span class="mi">165</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="k">null</span><span class="o">|</span><span class="w">            </span><span class="mi">3</span><span class="o">|</span><span class="w">       </span><span class="mi">7</span><span class="o">|</span><span class="w">      </span><span class="mi">172</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Bob</span><span class="o">|</span><span class="w">            </span><span class="mi">1</span><span class="o">|</span><span class="w">       </span><span class="mi">5</span><span class="o">|</span><span class="w">      </span><span class="mi">180</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Bob</span><span class="o">|</span><span class="w">            </span><span class="mi">0</span><span class="o">|</span><span class="w">       </span><span class="mi">5</span><span class="o">|</span><span class="w">      </span><span class="mi">180</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="k">null</span><span class="o">|</span><span class="w">            </span><span class="mi">2</span><span class="o">|</span><span class="w">       </span><span class="mi">5</span><span class="o">|</span><span class="w">      </span><span class="mi">180</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+-------------+--------+-----------+</span>

<span class="c1">-- histogram_numeric</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">histogram_numeric</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">histogram_numeric</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="p">[</span><span class="err">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">....</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- kurtosis</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">kurtosis</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">kurtosis</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7014368047529618</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">kurtosis</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">kurtosis</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">19432323191699075</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- last</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">last</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- last_value</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">last_value</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- max</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">max</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">50</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- max_by</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">max_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)),</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">max_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- mean</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">mean</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">mean</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- min</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">min</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">      </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- min_by</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">min_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)),</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)),</span><span class="w"> </span><span class="p">((</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">min_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">a</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- percentile</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">75</span><span class="p">))</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">percentile</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">75</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="p">[</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">5</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>

<span class="c1">-- percentile_approx</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                        </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">percentile_approx</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="p">[</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="n">SE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>

<span class="c1">-- regr_avgx</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">2</span><span class="p">.</span><span class="mi">75</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- regr_avgy</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">1</span><span class="p">.</span><span class="mi">75</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">   </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">1</span><span class="p">.</span><span class="mi">6666666666666667</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">regr_avgy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- regr_count</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">regr_count</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- regr_r2</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">2727272727272726</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">7500000000000001</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">regr_r2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- skewness</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">skewness</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">skewness</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">1</span><span class="p">.</span><span class="mi">1135657469022013</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">skewness</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">skewness</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|-</span><span class="mi">1</span><span class="p">.</span><span class="mi">1135657469022011</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- some</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">false</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="k">some</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- std</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">std</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">std</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- stddev</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">stddev</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">stddev</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- stddev_pop</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">stddev_pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">stddev_pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">816496580927726</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- stddev_samp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">stddev_samp</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">stddev_samp</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- sum</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">25</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- try_avg</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="s1">&#39;2147483647 months&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="s1">&#39;1 months&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_avg</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- try_sum</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">25</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">9223372036854775807</span><span class="n">L</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">try_sum</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- var_pop</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">var_pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">var_pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">6666666666666666</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- var_samp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">var_samp</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">var_samp</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- variance</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">variance</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">variance</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
</code></pre></div>

<h3 id="window-functions">Window Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cume_dist()</td>
      <td>Computes the position of a value relative to all values in the partition.</td>
    </tr>
    <tr>
      <td>dense_rank()</td>
      <td>Computes the rank of a value in a group of values. The result is one plus the
      previously assigned rank value. Unlike the function rank, dense_rank will not produce gaps
      in the ranking sequence.</td>
    </tr>
    <tr>
      <td>lag(input[, offset[, default]])</td>
      <td>Returns the value of `input` at the `offset`th row
      before the current row in the window. The default value of `offset` is 1 and the default
      value of `default` is null. If the value of `input` at the `offset`th row is null,
      null is returned. If there is no such offset row (e.g., when the offset is 1, the first
      row of the window does not have any previous row), `default` is returned.</td>
    </tr>
    <tr>
      <td>lead(input[, offset[, default]])</td>
      <td>Returns the value of `input` at the `offset`th row
      after the current row in the window. The default value of `offset` is 1 and the default
      value of `default` is null. If the value of `input` at the `offset`th row is null,
      null is returned. If there is no such an offset row (e.g., when the offset is 1, the last
      row of the window does not have any subsequent row), `default` is returned.</td>
    </tr>
    <tr>
      <td>nth_value(input[, offset])</td>
      <td>Returns the value of `input` at the row that is the `offset`th row
      from beginning of the window frame. Offset starts at 1. If ignoreNulls=true, we will skip
      nulls when finding the `offset`th row. Otherwise, every row counts for the `offset`. If
      there is no such an `offset`th row (e.g., when the offset is 10, size of the window frame
      is less than 10), null is returned.</td>
    </tr>
    <tr>
      <td>ntile(n)</td>
      <td>Divides the rows for each window partition into `n` buckets ranging
      from 1 to at most `n`.</td>
    </tr>
    <tr>
      <td>percent_rank()</td>
      <td>Computes the percentage ranking of a value in a group of values.</td>
    </tr>
    <tr>
      <td>rank()</td>
      <td>Computes the rank of a value in a group of values. The result is one plus the number
      of rows preceding or equal to the current row in the ordering of the partition. The values
      will produce gaps in the sequence.</td>
    </tr>
    <tr>
      <td>row_number()</td>
      <td>Assigns a unique, sequential number to each row, starting with one,
      according to the ordering of rows within the window partition.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-1">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- cume_dist</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">cume_dist</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">cume_dist</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                            </span><span class="mi">0</span><span class="p">.</span><span class="mi">6666666666666666</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                            </span><span class="mi">0</span><span class="p">.</span><span class="mi">6666666666666666</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                           </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                           </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- dense_rank</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">dense_rank</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">DENSE_RANK</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- lag</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">lag</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+-----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">lag</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">FOLLOWING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">FOLLOWING</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+-----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="k">null</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                          </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                          </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+-----------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- lead</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">lead</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">lead</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">FOLLOWING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">FOLLOWING</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                      </span><span class="k">null</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- nth_value</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">nth_value</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">nth_value</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                                 </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                                 </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                                 </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                              </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+------------------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- ntile</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">ntile</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">ntile</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                         </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- percent_rank</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">percent_rank</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">PERCENT_RANK</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+----------------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- rank</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">RANK</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="mi">3</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                       </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- row_number</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">  </span><span class="n">b</span><span class="o">|</span><span class="n">row_number</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">UNBOUNDED</span><span class="w"> </span><span class="n">PRECEDING</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">CURRENT</span><span class="w"> </span><span class="k">ROW</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">3</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span><span class="w">                                                                                                             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+--------------------------------------------------------------------------------------------------------------+</span>
</code></pre></div>

<h3 id="array-functions">Array Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>array(expr, ...)</td>
      <td>Returns an array with the given elements.</td>
    </tr>
    <tr>
      <td>array_contains(array, value)</td>
      <td>Returns true if the array contains the value.</td>
    </tr>
    <tr>
      <td>array_distinct(array)</td>
      <td>Removes duplicate values from the array.</td>
    </tr>
    <tr>
      <td>array_except(array1, array2)</td>
      <td>Returns an array of the elements in array1 but not in array2,
    without duplicates.</td>
    </tr>
    <tr>
      <td>array_intersect(array1, array2)</td>
      <td>Returns an array of the elements in the intersection of array1 and
    array2, without duplicates.</td>
    </tr>
    <tr>
      <td>array_join(array, delimiter[, nullReplacement])</td>
      <td>Concatenates the elements of the given array
      using the delimiter and an optional string to replace nulls. If no value is set for
      nullReplacement, any null value is filtered.</td>
    </tr>
    <tr>
      <td>array_max(array)</td>
      <td>Returns the maximum value in the array. NaN is greater than
    any non-NaN elements for double/float type. NULL elements are skipped.</td>
    </tr>
    <tr>
      <td>array_min(array)</td>
      <td>Returns the minimum value in the array. NaN is greater than
    any non-NaN elements for double/float type. NULL elements are skipped.</td>
    </tr>
    <tr>
      <td>array_position(array, element)</td>
      <td>Returns the (1-based) index of the first element of the array as long.</td>
    </tr>
    <tr>
      <td>array_remove(array, element)</td>
      <td>Remove all elements that equal to element from array.</td>
    </tr>
    <tr>
      <td>array_repeat(element, count)</td>
      <td>Returns the array containing element count times.</td>
    </tr>
    <tr>
      <td>array_union(array1, array2)</td>
      <td>Returns an array of the elements in the union of array1 and array2,
      without duplicates.</td>
    </tr>
    <tr>
      <td>arrays_overlap(a1, a2)</td>
      <td>Returns true if a1 contains at least a non-null element present also in a2. If the arrays have no common element and they are both non-empty and either of them contains a null element null is returned, false otherwise.</td>
    </tr>
    <tr>
      <td>arrays_zip(a1, a2, ...)</td>
      <td>Returns a merged array of structs in which the N-th struct contains all
    N-th values of input arrays.</td>
    </tr>
    <tr>
      <td>flatten(arrayOfArrays)</td>
      <td>Transforms an array of arrays into a single array.</td>
    </tr>
    <tr>
      <td>sequence(start, stop, step)</td>
      <td>Generates an array of elements from start to stop (inclusive),
      incrementing by step. The type of the returned elements is the same as the type of argument
      expressions.

      Supported types are: byte, short, integer, long, date, timestamp.

      The start and stop expressions must resolve to the same type.
      If start and stop expressions resolve to the 'date' or 'timestamp' type
      then the step expression must resolve to the 'interval' or 'year-month interval' or
      'day-time interval' type, otherwise to the same type as the start and stop expressions.</td>
    </tr>
    <tr>
      <td>shuffle(array)</td>
      <td>Returns a random permutation of the given array.</td>
    </tr>
    <tr>
      <td>slice(x, start, length)</td>
      <td>Subsets array x starting from index start (array indices start at 1, or starting from the end if start is negative) with the specified length.</td>
    </tr>
    <tr>
      <td>sort_array(array[, ascendingOrder])</td>
      <td>Sorts the input array in ascending or descending order
      according to the natural ordering of the array elements. NaN is greater than any non-NaN
      elements for double/float type. Null elements will be placed at the beginning of the returned
      array in ascending order or at the end of the returned array in descending order.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-2">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- array</span>
<span class="k">SELECT</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">     </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- array_contains</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_contains</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">array_contains</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- array_distinct</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_distinct</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">array_distinct</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="c1">-- array_except</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_except</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">array_except</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                                         </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>

<span class="c1">-- array_intersect</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_intersect</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>
<span class="o">|</span><span class="n">array_intersect</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>

<span class="c1">-- array_join</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;world&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span><span class="w"> </span><span class="n">world</span><span class="p">),</span><span class="w">  </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="n">hello</span><span class="w"> </span><span class="n">world</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">world</span><span class="p">),</span><span class="w">  </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="n">hello</span><span class="w"> </span><span class="n">world</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">array_join</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">world</span><span class="p">),</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">,)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">hello</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">world</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="c1">-- array_max</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_max</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">array_max</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="c1">-- array_min</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_min</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">array_min</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="c1">-- array_position</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_position</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">array_position</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                                </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- array_remove</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_remove</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">array_remove</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="c1">-- array_repeat</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_repeat</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">array_repeat</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="p">[</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="mi">123</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- array_union</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">array_union</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">array_union</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="c1">-- arrays_overlap</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">arrays_overlap</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">arrays_overlap</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="c1">-- arrays_zip</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">arrays_zip</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">arrays_zip</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="p">[</span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">arrays_zip</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="n">arrays_zip</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="p">[</span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>

<span class="c1">-- flatten</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">flatten</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">flatten</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="c1">-- sequence</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2018-03-01&#39;</span><span class="p">),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">month</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">sequence</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="p">),</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span><span class="p">),</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                  </span><span class="p">[</span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="w"> </span><span class="mi">2018</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">sequence</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2018-03-01&#39;</span><span class="p">),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="s1">&#39;0-1&#39;</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">month</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">sequence</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="p">),</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span><span class="p">),</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0-1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                            </span><span class="p">[</span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="w"> </span><span class="mi">2018</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------+</span>

<span class="c1">-- shuffle</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">shuffle</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">shuffle</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">shuffle</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="n">shuffle</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>

<span class="c1">-- slice</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="n">slice</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">slice</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- sort_array</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sort_array</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="n">sort_array</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="p">[</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
</code></pre></div>

<h3 id="map-functions">Map Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>element_at(array, index)</td>
      <td>Returns element of array at given (1-based) index. If Index is 0,
      Spark will throw an error. If index &lt; 0, accesses elements from the last to the first.
      The function returns NULL if the index exceeds the length of the array and
      `spark.sql.ansi.enabled` is set to false.
      If `spark.sql.ansi.enabled` is set to true, it throws ArrayIndexOutOfBoundsException
      for invalid indices.</td>
    </tr>
    <tr>
      <td>    element_at(map, key)</td>
      <td>Returns value for given key. The function returns NULL
      if the key is not contained in the map and `spark.sql.ansi.enabled` is set to false.
      If `spark.sql.ansi.enabled` is set to true, it throws NoSuchElementException instead.</td>
    </tr>
    <tr>
      <td>map(key0, value0, key1, value1, ...)</td>
      <td>Creates a map with the given key/value pairs.</td>
    </tr>
    <tr>
      <td>map_concat(map, ...)</td>
      <td>Returns the union of all the given maps</td>
    </tr>
    <tr>
      <td>map_contains_key(map, key)</td>
      <td>Returns true if the map contains the key.</td>
    </tr>
    <tr>
      <td>map_entries(map)</td>
      <td>Returns an unordered array of all entries in the given map.</td>
    </tr>
    <tr>
      <td>map_from_arrays(keys, values)</td>
      <td>Creates a map with a pair of the given key/value arrays. All elements
      in keys should not be null</td>
    </tr>
    <tr>
      <td>map_from_entries(arrayOfEntries)</td>
      <td>Returns a map created from the given array of entries.</td>
    </tr>
    <tr>
      <td>map_keys(map)</td>
      <td>Returns an unordered array containing the keys of the map.</td>
    </tr>
    <tr>
      <td>map_values(map)</td>
      <td>Returns an unordered array containing the values of the map.</td>
    </tr>
    <tr>
      <td>str_to_map(text[, pairDelim[, keyValueDelim]])</td>
      <td>Creates a map after splitting the text into key/value pairs using delimiters. Default delimiters are ',' for `pairDelim` and ':' for `keyValueDelim`. Both `pairDelim` and `keyValueDelim` are treated as regular expressions.</td>
    </tr>
    <tr>
      <td>try_element_at(array, index)</td>
      <td>Returns element of array at given (1-based) index. If Index is 0,
      Spark will throw an error. If index &lt; 0, accesses elements from the last to the first.
      The function always returns NULL if the index exceeds the length of the array.</td>
    </tr>
    <tr>
      <td>    try_element_at(map, key)</td>
      <td>Returns value for given key. The function always returns NULL
      if the key is not contained in the map.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-3">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- element_at</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">element_at</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">element_at</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">element_at</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="n">element_at</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>

<span class="c1">-- map</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="err">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">4</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- map_concat</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_concat</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">map_concat</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="err">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- map_contains_key</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_contains_key</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">map_contains_key</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                                </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">map_contains_key</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">map_contains_key</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="c1">-- map_entries</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_entries</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">map_entries</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="p">[</span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="err">}</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- map_from_arrays</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_from_arrays</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">map_from_arrays</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="err">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">4</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>

<span class="c1">-- map_from_entries</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_from_entries</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">struct</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="n">map_from_entries</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="n">struct</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                   </span><span class="err">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">b</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>

<span class="c1">-- map_keys</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_keys</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">map_keys</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- map_values</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">map_values</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">map_values</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="c1">-- str_to_map</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;a:1,b:2,c:3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">str_to_map</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="k">c</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">,,</span><span class="w"> </span><span class="p">:)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">         </span><span class="err">{</span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">str_to_map</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="p">,,</span><span class="w"> </span><span class="p">:)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="err">{</span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">null</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- try_element_at</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_element_at</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">try_element_at</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                                </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_element_at</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">try_element_at</span><span class="p">(</span><span class="k">map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
</code></pre></div>

<h3 id="date-and-timestamp-functions">Date and Timestamp Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>add_months(start_date, num_months)</td>
      <td>Returns the date that is `num_months` after `start_date`.</td>
    </tr>
    <tr>
      <td>current_date()</td>
      <td>Returns the current date at the start of query evaluation. All calls of current_date within the same query return the same value.</td>
    </tr>
    <tr>
      <td>    current_date</td>
      <td>Returns the current date at the start of query evaluation.</td>
    </tr>
    <tr>
      <td>current_timestamp()</td>
      <td>Returns the current timestamp at the start of query evaluation. All calls of current_timestamp within the same query return the same value.</td>
    </tr>
    <tr>
      <td>    current_timestamp</td>
      <td>Returns the current timestamp at the start of query evaluation.</td>
    </tr>
    <tr>
      <td>current_timezone()</td>
      <td>Returns the current session local timezone.</td>
    </tr>
    <tr>
      <td>date_add(start_date, num_days)</td>
      <td>Returns the date that is `num_days` after `start_date`.</td>
    </tr>
    <tr>
      <td>date_format(timestamp, fmt)</td>
      <td>Converts `timestamp` to a value of string in the format specified by the date format `fmt`.</td>
    </tr>
    <tr>
      <td>date_from_unix_date(days)</td>
      <td>Create date from the number of days since 1970-01-01.</td>
    </tr>
    <tr>
      <td>date_part(field, source)</td>
      <td>Extracts a part of the date/timestamp or interval source.</td>
    </tr>
    <tr>
      <td>date_sub(start_date, num_days)</td>
      <td>Returns the date that is `num_days` before `start_date`.</td>
    </tr>
    <tr>
      <td>date_trunc(fmt, ts)</td>
      <td>Returns timestamp `ts` truncated to the unit specified by the format model `fmt`.</td>
    </tr>
    <tr>
      <td>datediff(endDate, startDate)</td>
      <td>Returns the number of days from `startDate` to `endDate`.</td>
    </tr>
    <tr>
      <td>day(date)</td>
      <td>Returns the day of month of the date/timestamp.</td>
    </tr>
    <tr>
      <td>dayofmonth(date)</td>
      <td>Returns the day of month of the date/timestamp.</td>
    </tr>
    <tr>
      <td>dayofweek(date)</td>
      <td>Returns the day of the week for date/timestamp (1 = Sunday, 2 = Monday, ..., 7 = Saturday).</td>
    </tr>
    <tr>
      <td>dayofyear(date)</td>
      <td>Returns the day of year of the date/timestamp.</td>
    </tr>
    <tr>
      <td>extract(field FROM source)</td>
      <td>Extracts a part of the date/timestamp or interval source.</td>
    </tr>
    <tr>
      <td>from_unixtime(unix_time[, fmt])</td>
      <td>Returns `unix_time` in the specified `fmt`.</td>
    </tr>
    <tr>
      <td>from_utc_timestamp(timestamp, timezone)</td>
      <td>Given a timestamp like '2017-07-14 02:40:00.0', interprets it as a time in UTC, and renders that time as a timestamp in the given time zone. For example, 'GMT+1' would yield '2017-07-14 03:40:00.0'.</td>
    </tr>
    <tr>
      <td>hour(timestamp)</td>
      <td>Returns the hour component of the string/timestamp.</td>
    </tr>
    <tr>
      <td>last_day(date)</td>
      <td>Returns the last day of the month which the date belongs to.</td>
    </tr>
    <tr>
      <td>make_date(year, month, day)</td>
      <td>Create date from year, month and day fields. If the configuration `spark.sql.ansi.enabled` is false, the function returns NULL on invalid inputs. Otherwise, it will throw an error instead.</td>
    </tr>
    <tr>
      <td>make_dt_interval([days[, hours[, mins[, secs]]]])</td>
      <td>Make DayTimeIntervalType duration from days, hours, mins and secs.</td>
    </tr>
    <tr>
      <td>make_interval([years[, months[, weeks[, days[, hours[, mins[, secs]]]]]]])</td>
      <td>Make interval from years, months, weeks, days, hours, mins and secs.</td>
    </tr>
    <tr>
      <td>make_timestamp(year, month, day, hour, min, sec[, timezone])</td>
      <td>Create timestamp from year, month, day, hour, min, sec and timezone fields. The result data type is consistent with the value of configuration `spark.sql.timestampType`. If the configuration `spark.sql.ansi.enabled` is false, the function returns NULL on invalid inputs. Otherwise, it will throw an error instead.</td>
    </tr>
    <tr>
      <td>make_ym_interval([years[, months]])</td>
      <td>Make year-month interval from years, months.</td>
    </tr>
    <tr>
      <td>minute(timestamp)</td>
      <td>Returns the minute component of the string/timestamp.</td>
    </tr>
    <tr>
      <td>month(date)</td>
      <td>Returns the month component of the date/timestamp.</td>
    </tr>
    <tr>
      <td>months_between(timestamp1, timestamp2[, roundOff])</td>
      <td>If `timestamp1` is later than `timestamp2`, then the result
      is positive. If `timestamp1` and `timestamp2` are on the same day of month, or both
      are the last day of month, time of day will be ignored. Otherwise, the difference is
      calculated based on 31 days per month, and rounded to 8 digits unless roundOff=false.</td>
    </tr>
    <tr>
      <td>next_day(start_date, day_of_week)</td>
      <td>Returns the first date which is later than `start_date` and named as indicated.
      The function returns NULL if at least one of the input parameters is NULL.
      When both of the input parameters are not NULL and day_of_week is an invalid input,
      the function throws IllegalArgumentException if `spark.sql.ansi.enabled` is set to true, otherwise NULL.</td>
    </tr>
    <tr>
      <td>now()</td>
      <td>Returns the current timestamp at the start of query evaluation.</td>
    </tr>
    <tr>
      <td>quarter(date)</td>
      <td>Returns the quarter of the year for date, in the range 1 to 4.</td>
    </tr>
    <tr>
      <td>second(timestamp)</td>
      <td>Returns the second component of the string/timestamp.</td>
    </tr>
    <tr>
      <td>session_window(time_column, gap_duration)</td>
      <td>Generates session window given a timestamp specifying column and gap duration.
      See <a href="https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#types-of-time-windows">'Types of time windows'</a> in Structured Streaming guide doc for detailed explanation and examples.</td>
    </tr>
    <tr>
      <td>timestamp_micros(microseconds)</td>
      <td>Creates timestamp from the number of microseconds since UTC epoch.</td>
    </tr>
    <tr>
      <td>timestamp_millis(milliseconds)</td>
      <td>Creates timestamp from the number of milliseconds since UTC epoch.</td>
    </tr>
    <tr>
      <td>timestamp_seconds(seconds)</td>
      <td>Creates timestamp from the number of seconds (can be fractional) since UTC epoch.</td>
    </tr>
    <tr>
      <td>to_date(date_str[, fmt])</td>
      <td>Parses the `date_str` expression with the `fmt` expression to
      a date. Returns null with invalid input. By default, it follows casting rules to a date if
      the `fmt` is omitted.</td>
    </tr>
    <tr>
      <td>to_timestamp(timestamp_str[, fmt])</td>
      <td>Parses the `timestamp_str` expression with the `fmt` expression
      to a timestamp. Returns null with invalid input. By default, it follows casting rules to
      a timestamp if the `fmt` is omitted. The result data type is consistent with the value of
      configuration `spark.sql.timestampType`.</td>
    </tr>
    <tr>
      <td>to_unix_timestamp(timeExp[, fmt])</td>
      <td>Returns the UNIX timestamp of the given time.</td>
    </tr>
    <tr>
      <td>to_utc_timestamp(timestamp, timezone)</td>
      <td>Given a timestamp like '2017-07-14 02:40:00.0', interprets it as a time in the given time zone, and renders that time as a timestamp in UTC. For example, 'GMT+1' would yield '2017-07-14 01:40:00.0'.</td>
    </tr>
    <tr>
      <td>trunc(date, fmt)</td>
      <td>Returns `date` with the time portion of the day truncated to the unit specified by the format model `fmt`.</td>
    </tr>
    <tr>
      <td>unix_date(date)</td>
      <td>Returns the number of days since 1970-01-01.</td>
    </tr>
    <tr>
      <td>unix_micros(timestamp)</td>
      <td>Returns the number of microseconds since 1970-01-01 00:00:00 UTC.</td>
    </tr>
    <tr>
      <td>unix_millis(timestamp)</td>
      <td>Returns the number of milliseconds since 1970-01-01 00:00:00 UTC. Truncates higher levels of precision.</td>
    </tr>
    <tr>
      <td>unix_seconds(timestamp)</td>
      <td>Returns the number of seconds since 1970-01-01 00:00:00 UTC. Truncates higher levels of precision.</td>
    </tr>
    <tr>
      <td>unix_timestamp([timeExp[, fmt]])</td>
      <td>Returns the UNIX timestamp of current or specified time.</td>
    </tr>
    <tr>
      <td>weekday(date)</td>
      <td>Returns the day of the week for date/timestamp (0 = Monday, 1 = Tuesday, ..., 6 = Sunday).</td>
    </tr>
    <tr>
      <td>weekofyear(date)</td>
      <td>Returns the week of the year of the given date. A week is considered to start on a Monday and week 1 is the first week with &gt;3 days.</td>
    </tr>
    <tr>
      <td>window(time_column, window_duration[, slide_duration[, start_time]])</td>
      <td>Bucketize rows into one or more time windows given a timestamp specifying column.
      Window starts are inclusive but the window ends are exclusive, e.g. 12:05 will be in the window [12:05,12:10) but not in [12:00,12:05).
      Windows can support microsecond precision. Windows in the order of months are not supported.
      See <a href="https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#window-operations-on-event-time">'Window Operations on Event Time'</a> in Structured Streaming guide doc for detailed explanation and examples.</td>
    </tr>
    <tr>
      <td>year(date)</td>
      <td>Returns the year component of the date/timestamp.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-4">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- add_months</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">add_months</span><span class="p">(</span><span class="s1">&#39;2016-08-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">add_months</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">2016</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- current_date</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">current_date</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="k">current_date</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">16</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">current_date</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="k">current_date</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">16</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- current_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">54</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">54</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- current_timezone</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">current_timezone</span><span class="p">();</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">current_timezone</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">Etc</span><span class="o">/</span><span class="n">UTC</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- date_add</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_add</span><span class="p">(</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">date_add</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">31</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- date_format</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_format</span><span class="p">(</span><span class="s1">&#39;2016-04-08&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">date_format</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">2016</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- date_from_unix_date</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_from_unix_date</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">date_from_unix_date</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- date_part</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                   </span><span class="mi">2019</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;week&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="n">week</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                     </span><span class="mi">33</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;doy&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">DATE</span><span class="s1">&#39;2019-08-12&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="n">doy</span><span class="p">,</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2019-08-12&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">224</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;SECONDS&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="s1">&#39;2019-10-01 00:00:01.000001&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="n">SECONDS</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-10-01 00:00:01.000001&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                  </span><span class="mi">1</span><span class="p">.</span><span class="mi">000001</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;days&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">days</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">minutes</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;5 03:07&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MINUTE</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;seconds&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">milliseconds</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">microseconds</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;05:00:30.001001&#39;</span><span class="w"> </span><span class="n">HOUR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="mi">30</span><span class="p">.</span><span class="mi">001001</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;MONTH&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2021-11&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="k">MONTH</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2021-11&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                </span><span class="mi">11</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_part</span><span class="p">(</span><span class="s1">&#39;MINUTE&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;123 23:55:59.002001&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_part</span><span class="p">(</span><span class="k">MINUTE</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;123 23:55:59.002001&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                             </span><span class="mi">55</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>

<span class="c1">-- date_sub</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_sub</span><span class="p">(</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">date_sub</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">29</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- date_trunc</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2015-03-05T09:32:05.359&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="n">date_trunc</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="n">T09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">05</span><span class="p">.</span><span class="mi">359</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;MM&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2015-03-05T09:32:05.359&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">date_trunc</span><span class="p">(</span><span class="n">MM</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="n">T09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">05</span><span class="p">.</span><span class="mi">359</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;DD&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2015-03-05T09:32:05.359&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">date_trunc</span><span class="p">(</span><span class="n">DD</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="n">T09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">05</span><span class="p">.</span><span class="mi">359</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;HOUR&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2015-03-05T09:32:05.359&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="n">date_trunc</span><span class="p">(</span><span class="n">HOUR</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="n">T09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">05</span><span class="p">.</span><span class="mi">359</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;MILLISECOND&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2015-03-05T09:32:05.123456&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="n">date_trunc</span><span class="p">(</span><span class="n">MILLISECOND</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="n">T09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">05</span><span class="p">.</span><span class="mi">123456</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">32</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>

<span class="c1">-- datediff</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="s1">&#39;2009-07-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">datediff</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2009-07-31&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">datediff</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">31</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="c1">-- day</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">day</span><span class="p">(</span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="k">day</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- dayofmonth</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">dayofmonth</span><span class="p">(</span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">dayofmonth</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- dayofweek</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">dayofweek</span><span class="p">(</span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">dayofweek</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- dayofyear</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">dayofyear</span><span class="p">(</span><span class="s1">&#39;2016-04-09&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">dayofyear</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">09</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">100</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- extract</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                     </span><span class="mi">2019</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="n">week</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">timestamp</span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="n">week</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-08-12 01:00:00.123456&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                       </span><span class="mi">33</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="n">doy</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">DATE</span><span class="s1">&#39;2019-08-12&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="n">doy</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2019-08-12&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                                </span><span class="mi">224</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="n">SECONDS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">timestamp</span><span class="s1">&#39;2019-10-01 00:00:01.000001&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="n">SECONDS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2019-10-01 00:00:01.000001&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="mi">1</span><span class="p">.</span><span class="mi">000001</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="n">days</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">days</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">minutes</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="n">days</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;5 03:07&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MINUTE</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                  </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="n">seconds</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">milliseconds</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">microseconds</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="n">seconds</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;05:00:30.001001&#39;</span><span class="w"> </span><span class="n">HOUR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                      </span><span class="mi">30</span><span class="p">.</span><span class="mi">001001</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2021-11&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2021-11&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                  </span><span class="mi">11</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">MINUTE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;123 23:55:59.002001&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">extract</span><span class="p">(</span><span class="k">MINUTE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;123 23:55:59.002001&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                               </span><span class="mi">55</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>

<span class="c1">-- from_unixtime</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">from_unixtime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd HH:mm:ss&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">from_unixtime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="w"> </span><span class="n">HH</span><span class="p">:</span><span class="n">mm</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">from_unixtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">from_unixtime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="w"> </span><span class="n">HH</span><span class="p">:</span><span class="n">mm</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>

<span class="c1">-- from_utc_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">from_utc_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-08-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Asia/Seoul&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">from_utc_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="n">Asia</span><span class="o">/</span><span class="n">Seoul</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>

<span class="c1">-- hour</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">hour</span><span class="p">(</span><span class="s1">&#39;2009-07-30 12:58:59&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">hour</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">12</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">12</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- last_day</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">last_day</span><span class="p">(</span><span class="s1">&#39;2009-01-12&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">last_day</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">2009</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">31</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- make_date</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">make_date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">make_date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">2013</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">15</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">make_date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="c1">-- make_dt_interval</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">make_dt_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="p">.</span><span class="mi">001001</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">make_dt_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">001001</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1 12:30...|</span>
<span class="s1">+-------------------------------------+</span>

<span class="s1">SELECT make_dt_interval(2);</span>
<span class="s1">+-----------------------------------+</span>
<span class="s1">|make_dt_interval(2, 0, 0, 0.000000)|</span>
<span class="s1">+-----------------------------------+</span>
<span class="s1">|               INTERVAL &#39;</span><span class="mi">2</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_dt_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">make_dt_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                                    </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="c1">-- make_interval</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">make_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="p">.</span><span class="mi">001001</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">make_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">001001</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">100</span><span class="w"> </span><span class="n">years</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">mont</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">make_interval</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">000001</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">make_interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">000001</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">1</span><span class="w"> </span><span class="n">months</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">days</span><span class="w"> </span><span class="mi">1</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="c1">-- make_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">.</span><span class="mi">887</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">.</span><span class="mi">887</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">2014</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">06</span><span class="p">:</span><span class="mi">30</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">.</span><span class="mi">887</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CET&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">.</span><span class="mi">887</span><span class="p">,</span><span class="w"> </span><span class="n">CET</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="mi">2014</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">30</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">59</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">59</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">2019</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">59</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">59</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">make_timestamp</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                                  </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- make_ym_interval</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1-2&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1-0&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_ym_interval</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">make_ym_interval</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">   </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-0-11&#39;</span><span class="w"> </span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">make_ym_interval</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2-0&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- minute</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">minute</span><span class="p">(</span><span class="s1">&#39;2009-07-30 12:58:59&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="k">minute</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">12</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="mi">58</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="c1">-- month</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">month</span><span class="p">(</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="k">month</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- months_between</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">months_between</span><span class="p">(</span><span class="s1">&#39;1997-02-28 10:30:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1996-10-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="n">months_between</span><span class="p">(</span><span class="mi">1997</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="w"> </span><span class="mi">1996</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                           </span><span class="mi">3</span><span class="p">.</span><span class="mi">94959677</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">months_between</span><span class="p">(</span><span class="s1">&#39;1997-02-28 10:30:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1996-10-30&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="n">months_between</span><span class="p">(</span><span class="mi">1997</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="w"> </span><span class="mi">1996</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                    </span><span class="mi">3</span><span class="p">.</span><span class="mi">9495967741935485</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>

<span class="c1">-- next_day</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">next_day</span><span class="p">(</span><span class="s1">&#39;2015-01-14&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TU&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">next_day</span><span class="p">(</span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="n">TU</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="c1">-- now</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">now</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="n">now</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">54</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- quarter</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">quarter</span><span class="p">(</span><span class="s1">&#39;2016-08-31&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">quarter</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- second</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">second</span><span class="p">(</span><span class="s1">&#39;2009-07-30 12:58:59&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="k">second</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">12</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="mi">59</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="c1">-- session_window</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">.</span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">.</span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:04:30&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:10:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:01:00&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;5 minutes&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">              </span><span class="k">start</span><span class="o">|</span><span class="w">                </span><span class="k">end</span><span class="o">|</span><span class="n">cnt</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">.</span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">.</span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:04:30&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:10:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:01:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:04:30&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">session_window</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A1&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;5 minutes&#39;</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A2&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;1 minute&#39;</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;10 minutes&#39;</span><span class="w"> </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">              </span><span class="k">start</span><span class="o">|</span><span class="w">                </span><span class="k">end</span><span class="o">|</span><span class="n">cnt</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">30</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">30</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>

<span class="c1">-- timestamp_micros</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">timestamp_micros</span><span class="p">(</span><span class="mi">1230219000123123</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">timestamp_micros</span><span class="p">(</span><span class="mi">1230219000123123</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">2008</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="c1">-- timestamp_millis</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">timestamp_millis</span><span class="p">(</span><span class="mi">1230219000123</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">timestamp_millis</span><span class="p">(</span><span class="mi">1230219000123</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">2008</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- timestamp_seconds</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">timestamp_seconds</span><span class="p">(</span><span class="mi">1230219000</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">timestamp_seconds</span><span class="p">(</span><span class="mi">1230219000</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">2008</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">timestamp_seconds</span><span class="p">(</span><span class="mi">1230219000</span><span class="p">.</span><span class="mi">123</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">timestamp_seconds</span><span class="p">(</span><span class="mi">1230219000</span><span class="p">.</span><span class="mi">123</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2008</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- to_date</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2016-12-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- to_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-12-31 00:12:00&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">to_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-12-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">to_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="c1">-- to_unix_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_unix_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-04-08&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="n">to_unix_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="mi">1460073600</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------+</span>

<span class="c1">-- to_utc_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_utc_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-08-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Asia/Seoul&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">to_utc_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="n">Asia</span><span class="o">/</span><span class="n">Seoul</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">2016</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="c1">-- trunc</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="s1">&#39;2019-08-04&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;week&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">trunc</span><span class="p">(</span><span class="mi">2019</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span><span class="p">,</span><span class="w"> </span><span class="n">week</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2019</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">29</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="s1">&#39;2019-08-04&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;quarter&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">trunc</span><span class="p">(</span><span class="mi">2019</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span><span class="p">,</span><span class="w"> </span><span class="n">quarter</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">2019</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="s1">&#39;2009-02-12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MM&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">trunc</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="n">MM</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">2009</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="s1">&#39;2015-10-27&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YEAR&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">trunc</span><span class="p">(</span><span class="mi">2015</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- unix_date</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_date</span><span class="p">(</span><span class="nb">DATE</span><span class="p">(</span><span class="ss">&quot;1970-01-02&quot;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">unix_date</span><span class="p">(</span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- unix_micros</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_micros</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="p">(</span><span class="s1">&#39;1970-01-01 00:00:01Z&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">unix_micros</span><span class="p">(</span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="n">Z</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">1000000</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- unix_millis</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_millis</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="p">(</span><span class="s1">&#39;1970-01-01 00:00:01Z&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">unix_millis</span><span class="p">(</span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="n">Z</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="mi">1000</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- unix_seconds</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_seconds</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="p">(</span><span class="s1">&#39;1970-01-01 00:00:01Z&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">unix_seconds</span><span class="p">(</span><span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="n">Z</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="c1">-- unix_timestamp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_timestamp</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="k">current_timestamp</span><span class="p">(),</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="w"> </span><span class="n">HH</span><span class="p">:</span><span class="n">mm</span><span class="p">:</span><span class="n">ss</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                              </span><span class="mi">1676541248</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">unix_timestamp</span><span class="p">(</span><span class="s1">&#39;2016-04-08&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="mi">1460073600</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- weekday</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">weekday</span><span class="p">(</span><span class="s1">&#39;2009-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">weekday</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- weekofyear</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">weekofyear</span><span class="p">(</span><span class="s1">&#39;2008-02-20&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">weekofyear</span><span class="p">(</span><span class="mi">2008</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">8</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- window</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">.</span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">.</span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:04:30&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:06:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:01:00&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;5 minutes&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">              </span><span class="k">start</span><span class="o">|</span><span class="w">                </span><span class="k">end</span><span class="o">|</span><span class="n">cnt</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">.</span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">.</span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:04:30&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:06:00&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:01:00&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tab</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;10 minutes&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;5 minutes&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">start</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w">  </span><span class="n">a</span><span class="o">|</span><span class="w">              </span><span class="k">start</span><span class="o">|</span><span class="w">                </span><span class="k">end</span><span class="o">|</span><span class="n">cnt</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2020</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A1</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2020</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">A2</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------------+-------------------+---+</span>

<span class="c1">-- year</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">year</span><span class="p">(</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="k">year</span><span class="p">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">2016</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
</code></pre></div>

<h3 id="json-functions">JSON Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>from_json(jsonStr, schema[, options])</td>
      <td>Returns a struct value with the given `jsonStr` and `schema`.</td>
    </tr>
    <tr>
      <td>get_json_object(json_txt, path)</td>
      <td>Extracts a json object from `path`.</td>
    </tr>
    <tr>
      <td>json_array_length(jsonArray)</td>
      <td>Returns the number of elements in the outermost JSON array.</td>
    </tr>
    <tr>
      <td>json_object_keys(json_object)</td>
      <td>Returns all the keys of the outermost JSON object as an array.</td>
    </tr>
    <tr>
      <td>json_tuple(jsonStr, p1, p2, ..., pn)</td>
      <td>Returns a tuple like the function get_json_object, but it takes multiple names. All the input parameters and output column types are string.</td>
    </tr>
    <tr>
      <td>schema_of_json(json[, options])</td>
      <td>Returns schema in the DDL format of JSON string.</td>
    </tr>
    <tr>
      <td>to_json(expr[, options])</td>
      <td>Returns a JSON string with a given struct value</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-5">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- from_json</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">from_json</span><span class="p">(</span><span class="s1">&#39;{&quot;a&quot;:1, &quot;b&quot;:0.8}&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a INT, b DOUBLE&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">from_json</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;b&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="err">}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">from_json</span><span class="p">(</span><span class="s1">&#39;{&quot;time&quot;:&quot;26/08/2015&quot;}&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;time Timestamp&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;timestampFormat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">from_json</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;time&quot;</span><span class="p">:</span><span class="ss">&quot;26/08/2015&quot;</span><span class="err">}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="err">{</span><span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">26</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">from_json</span><span class="p">(</span><span class="s1">&#39;{&quot;teacher&quot;: &quot;Alice&quot;, &quot;student&quot;: [{&quot;name&quot;: &quot;Bob&quot;, &quot;rank&quot;: 1}, {&quot;name&quot;: &quot;Charlie&quot;, &quot;rank&quot;: 2}]}&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;STRUCT&lt;teacher: STRING, student: ARRAY&lt;STRUCT&lt;name: STRING, rank: INT&gt;&gt;&gt;&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">from_json</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;teacher&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;student&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">{</span><span class="ss">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;rank&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="ss">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;Charlie&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;rank&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="err">}</span><span class="p">]</span><span class="err">}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                                    </span><span class="err">{</span><span class="n">Alice</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="err">{</span><span class="n">Bob</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="err">}</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------+</span>

<span class="c1">-- get_json_object</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">get_json_object</span><span class="p">(</span><span class="s1">&#39;{&quot;a&quot;:&quot;b&quot;}&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$.a&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">get_json_object</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;a&quot;</span><span class="p">:</span><span class="ss">&quot;b&quot;</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">.</span><span class="n">a</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- json_array_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">json_array_length</span><span class="p">(</span><span class="s1">&#39;[1,2,3,4]&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">json_array_length</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">json_array_length</span><span class="p">(</span><span class="s1">&#39;[1,2,3,{&quot;f1&quot;:1,&quot;f2&quot;:[5,6]},4]&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="n">json_array_length</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="err">{</span><span class="ss">&quot;f1&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="ss">&quot;f2&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span><span class="err">}</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                               </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">json_array_length</span><span class="p">(</span><span class="s1">&#39;[1,2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">json_array_length</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- json_object_keys</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">json_object_keys</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">json_object_keys</span><span class="p">(</span><span class="err">{}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="p">[]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">json_object_keys</span><span class="p">(</span><span class="s1">&#39;{&quot;key&quot;: &quot;value&quot;}&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">json_object_keys</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;value&quot;</span><span class="err">}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="p">[</span><span class="k">key</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">json_object_keys</span><span class="p">(</span><span class="s1">&#39;{&quot;f1&quot;:&quot;abc&quot;,&quot;f2&quot;:{&quot;f3&quot;:&quot;a&quot;, &quot;f4&quot;:&quot;b&quot;}}&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="n">json_object_keys</span><span class="p">(</span><span class="err">{</span><span class="ss">&quot;f1&quot;</span><span class="p">:</span><span class="ss">&quot;abc&quot;</span><span class="p">,</span><span class="ss">&quot;f2&quot;</span><span class="p">:</span><span class="err">{</span><span class="ss">&quot;f3&quot;</span><span class="p">:</span><span class="ss">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;f4&quot;</span><span class="p">:</span><span class="ss">&quot;b&quot;</span><span class="err">}}</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                </span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="n">f2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="c1">-- json_tuple</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">json_tuple</span><span class="p">(</span><span class="s1">&#39;{&quot;a&quot;:1, &quot;b&quot;:2}&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="w"> </span><span class="n">c0</span><span class="o">|</span><span class="w"> </span><span class="n">c1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>

<span class="c1">-- schema_of_json</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">schema_of_json</span><span class="p">(</span><span class="s1">&#39;[{&quot;col&quot;:0}]&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">schema_of_json</span><span class="p">([</span><span class="err">{</span><span class="ss">&quot;col&quot;</span><span class="p">:</span><span class="mi">0</span><span class="err">}</span><span class="p">])</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">       </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRUCT</span><span class="o">&lt;</span><span class="n">col</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">schema_of_json</span><span class="p">(</span><span class="s1">&#39;[{&quot;col&quot;:01}]&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;allowNumericLeadingZeros&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">schema_of_json</span><span class="p">([</span><span class="err">{</span><span class="ss">&quot;col&quot;</span><span class="p">:</span><span class="mi">01</span><span class="err">}</span><span class="p">])</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRUCT</span><span class="o">&lt;</span><span class="n">col</span><span class="p">:...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- to_json</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_json</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">to_json</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="err">{</span><span class="ss">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="ss">&quot;b&quot;</span><span class="p">:</span><span class="mi">2</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_json</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2015-08-26&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">)),</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;timestampFormat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">to_json</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="k">time</span><span class="p">,</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                             </span><span class="err">{</span><span class="ss">&quot;time&quot;</span><span class="p">:</span><span class="ss">&quot;26/08/20...|</span>
<span class="ss">+-----------------------------------------------------------------+</span>

<span class="ss">SELECT to_json(array(named_struct(&#39;a&#39;, 1, &#39;b&#39;, 2)));</span>
<span class="ss">+----------------------------------------+</span>
<span class="ss">|to_json(array(named_struct(a, 1, b, 2)))|</span>
<span class="ss">+----------------------------------------+</span>
<span class="ss">|                         [{&quot;</span><span class="n">a</span><span class="ss">&quot;:1,&quot;</span><span class="n">b</span><span class="ss">&quot;:2}]|</span>
<span class="ss">+----------------------------------------+</span>

<span class="ss">SELECT to_json(map(&#39;a&#39;, named_struct(&#39;b&#39;, 1)));</span>
<span class="ss">+-----------------------------------+</span>
<span class="ss">|to_json(map(a, named_struct(b, 1)))|</span>
<span class="ss">+-----------------------------------+</span>
<span class="ss">|                      {&quot;</span><span class="n">a</span><span class="ss">&quot;:{&quot;</span><span class="n">b</span><span class="ss">&quot;:1}}|</span>
<span class="ss">+-----------------------------------+</span>

<span class="ss">SELECT to_json(map(named_struct(&#39;a&#39;, 1),named_struct(&#39;b&#39;, 2)));</span>
<span class="ss">+----------------------------------------------------+</span>
<span class="ss">|to_json(map(named_struct(a, 1), named_struct(b, 2)))|</span>
<span class="ss">+----------------------------------------------------+</span>
<span class="ss">|                                     {&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="ss">&quot;:{&quot;</span><span class="n">b</span><span class="ss">&quot;:2}}|</span>
<span class="ss">+----------------------------------------------------+</span>

<span class="ss">SELECT to_json(map(&#39;a&#39;, 1));</span>
<span class="ss">+------------------+</span>
<span class="ss">|to_json(map(a, 1))|</span>
<span class="ss">+------------------+</span>
<span class="ss">|           {&quot;</span><span class="n">a</span><span class="ss">&quot;:1}|</span>
<span class="ss">+------------------+</span>

<span class="ss">SELECT to_json(array((map(&#39;a&#39;, 1))));</span>
<span class="ss">+-------------------------+</span>
<span class="ss">|to_json(array(map(a, 1)))|</span>
<span class="ss">+-------------------------+</span>
<span class="ss">|                [{&quot;</span><span class="n">a</span><span class="err">&quot;</span><span class="p">:</span><span class="mi">1</span><span class="err">}</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
</code></pre></div>

<h3 id="mathematical-functions">Mathematical Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>expr1 % expr2</td>
      <td>Returns the remainder after `expr1`/`expr2`.</td>
    </tr>
    <tr>
      <td>expr1 * expr2</td>
      <td>Returns `expr1`*`expr2`.</td>
    </tr>
    <tr>
      <td>expr1 + expr2</td>
      <td>Returns `expr1`+`expr2`.</td>
    </tr>
    <tr>
      <td>expr1 - expr2</td>
      <td>Returns `expr1`-`expr2`.</td>
    </tr>
    <tr>
      <td>expr1 / expr2</td>
      <td>Returns `expr1`/`expr2`. It always performs floating point division.</td>
    </tr>
    <tr>
      <td>abs(expr)</td>
      <td>Returns the absolute value of the numeric or interval value.</td>
    </tr>
    <tr>
      <td>acos(expr)</td>
      <td>Returns the inverse cosine (a.k.a. arc cosine) of `expr`, as if computed by
      `java.lang.Math.acos`.</td>
    </tr>
    <tr>
      <td>acosh(expr)</td>
      <td>Returns inverse hyperbolic cosine of `expr`.</td>
    </tr>
    <tr>
      <td>asin(expr)</td>
      <td>Returns the inverse sine (a.k.a. arc sine) the arc sin of `expr`,
      as if computed by `java.lang.Math.asin`.</td>
    </tr>
    <tr>
      <td>asinh(expr)</td>
      <td>Returns inverse hyperbolic sine of `expr`.</td>
    </tr>
    <tr>
      <td>atan(expr)</td>
      <td>Returns the inverse tangent (a.k.a. arc tangent) of `expr`, as if computed by
      `java.lang.Math.atan`</td>
    </tr>
    <tr>
      <td>atan2(exprY, exprX)</td>
      <td>Returns the angle in radians between the positive x-axis of a plane
      and the point given by the coordinates (`exprX`, `exprY`), as if computed by
      `java.lang.Math.atan2`.</td>
    </tr>
    <tr>
      <td>atanh(expr)</td>
      <td>Returns inverse hyperbolic tangent of `expr`.</td>
    </tr>
    <tr>
      <td>bin(expr)</td>
      <td>Returns the string representation of the long value `expr` represented in binary.</td>
    </tr>
    <tr>
      <td>bround(expr, d)</td>
      <td>Returns `expr` rounded to `d` decimal places using HALF_EVEN rounding mode.</td>
    </tr>
    <tr>
      <td>cbrt(expr)</td>
      <td>Returns the cube root of `expr`.</td>
    </tr>
    <tr>
      <td>ceil(expr[, scale])</td>
      <td>Returns the smallest number after rounding up that is not smaller than `expr`. An optional `scale` parameter can be specified to control the rounding behavior.</td>
    </tr>
    <tr>
      <td>ceiling(expr[, scale])</td>
      <td>Returns the smallest number after rounding up that is not smaller than `expr`. An optional `scale` parameter can be specified to control the rounding behavior.</td>
    </tr>
    <tr>
      <td>conv(num, from_base, to_base)</td>
      <td>Convert `num` from `from_base` to `to_base`.</td>
    </tr>
    <tr>
      <td>cos(expr)</td>
      <td>Returns the cosine of `expr`, as if computed by
      `java.lang.Math.cos`.</td>
    </tr>
    <tr>
      <td>cosh(expr)</td>
      <td>Returns the hyperbolic cosine of `expr`, as if computed by
        `java.lang.Math.cosh`.</td>
    </tr>
    <tr>
      <td>cot(expr)</td>
      <td>Returns the cotangent of `expr`, as if computed by `1/java.lang.Math.tan`.</td>
    </tr>
    <tr>
      <td>csc(expr)</td>
      <td>Returns the cosecant of `expr`, as if computed by `1/java.lang.Math.sin`.</td>
    </tr>
    <tr>
      <td>degrees(expr)</td>
      <td>Converts radians to degrees.</td>
    </tr>
    <tr>
      <td>expr1 div expr2</td>
      <td>Divide `expr1` by `expr2`. It returns NULL if an operand is NULL or `expr2` is 0. The result is casted to long.</td>
    </tr>
    <tr>
      <td>e()</td>
      <td>Returns Euler's number, e.</td>
    </tr>
    <tr>
      <td>exp(expr)</td>
      <td>Returns e to the power of `expr`.</td>
    </tr>
    <tr>
      <td>expm1(expr) - Returns exp(`expr`)</td>
      <td>1.</td>
    </tr>
    <tr>
      <td>factorial(expr)</td>
      <td>Returns the factorial of `expr`. `expr` is [0..20]. Otherwise, null.</td>
    </tr>
    <tr>
      <td>floor(expr[, scale])</td>
      <td>Returns the largest number after rounding down that is not greater than `expr`. An optional `scale` parameter can be specified to control the rounding behavior.</td>
    </tr>
    <tr>
      <td>greatest(expr, ...)</td>
      <td>Returns the greatest value of all parameters, skipping null values.</td>
    </tr>
    <tr>
      <td>hex(expr)</td>
      <td>Converts `expr` to hexadecimal.</td>
    </tr>
    <tr>
      <td>hypot(expr1, expr2)</td>
      <td>Returns sqrt(`expr1`**2 + `expr2`**2).</td>
    </tr>
    <tr>
      <td>least(expr, ...)</td>
      <td>Returns the least value of all parameters, skipping null values.</td>
    </tr>
    <tr>
      <td>ln(expr)</td>
      <td>Returns the natural logarithm (base e) of `expr`.</td>
    </tr>
    <tr>
      <td>log(base, expr)</td>
      <td>Returns the logarithm of `expr` with `base`.</td>
    </tr>
    <tr>
      <td>log10(expr)</td>
      <td>Returns the logarithm of `expr` with base 10.</td>
    </tr>
    <tr>
      <td>log1p(expr)</td>
      <td>Returns log(1 + `expr`).</td>
    </tr>
    <tr>
      <td>log2(expr)</td>
      <td>Returns the logarithm of `expr` with base 2.</td>
    </tr>
    <tr>
      <td>expr1 mod expr2</td>
      <td>Returns the remainder after `expr1`/`expr2`.</td>
    </tr>
    <tr>
      <td>negative(expr)</td>
      <td>Returns the negated value of `expr`.</td>
    </tr>
    <tr>
      <td>pi()</td>
      <td>Returns pi.</td>
    </tr>
    <tr>
      <td>pmod(expr1, expr2)</td>
      <td>Returns the positive value of `expr1` mod `expr2`.</td>
    </tr>
    <tr>
      <td>positive(expr)</td>
      <td>Returns the value of `expr`.</td>
    </tr>
    <tr>
      <td>pow(expr1, expr2)</td>
      <td>Raises `expr1` to the power of `expr2`.</td>
    </tr>
    <tr>
      <td>power(expr1, expr2)</td>
      <td>Raises `expr1` to the power of `expr2`.</td>
    </tr>
    <tr>
      <td>radians(expr)</td>
      <td>Converts degrees to radians.</td>
    </tr>
    <tr>
      <td>rand([seed])</td>
      <td>Returns a random value with independent and identically distributed (i.i.d.) uniformly distributed values in [0, 1).</td>
    </tr>
    <tr>
      <td>randn([seed])</td>
      <td>Returns a random value with independent and identically distributed (i.i.d.) values drawn from the standard normal distribution.</td>
    </tr>
    <tr>
      <td>random([seed])</td>
      <td>Returns a random value with independent and identically distributed (i.i.d.) uniformly distributed values in [0, 1).</td>
    </tr>
    <tr>
      <td>rint(expr)</td>
      <td>Returns the double value that is closest in value to the argument and is equal to a mathematical integer.</td>
    </tr>
    <tr>
      <td>round(expr, d)</td>
      <td>Returns `expr` rounded to `d` decimal places using HALF_UP rounding mode.</td>
    </tr>
    <tr>
      <td>sec(expr)</td>
      <td>Returns the secant of `expr`, as if computed by `1/java.lang.Math.cos`.</td>
    </tr>
    <tr>
      <td>shiftleft(base, expr)</td>
      <td>Bitwise left shift.</td>
    </tr>
    <tr>
      <td>sign(expr)</td>
      <td>Returns -1.0, 0.0 or 1.0 as `expr` is negative, 0 or positive.</td>
    </tr>
    <tr>
      <td>signum(expr)</td>
      <td>Returns -1.0, 0.0 or 1.0 as `expr` is negative, 0 or positive.</td>
    </tr>
    <tr>
      <td>sin(expr)</td>
      <td>Returns the sine of `expr`, as if computed by `java.lang.Math.sin`.</td>
    </tr>
    <tr>
      <td>sinh(expr)</td>
      <td>Returns hyperbolic sine of `expr`, as if computed by `java.lang.Math.sinh`.</td>
    </tr>
    <tr>
      <td>sqrt(expr)</td>
      <td>Returns the square root of `expr`.</td>
    </tr>
    <tr>
      <td>tan(expr)</td>
      <td>Returns the tangent of `expr`, as if computed by `java.lang.Math.tan`.</td>
    </tr>
    <tr>
      <td>tanh(expr)</td>
      <td>Returns the hyperbolic tangent of `expr`, as if computed by
      `java.lang.Math.tanh`.</td>
    </tr>
    <tr>
      <td>try_add(expr1, expr2)</td>
      <td>Returns the sum of `expr1`and `expr2` and the result is null on overflow. The acceptable input types are the same with the `+` operator.</td>
    </tr>
    <tr>
      <td>try_divide(dividend, divisor)</td>
      <td>Returns `dividend`/`divisor`. It always performs floating point division. Its result is always null if `expr2` is 0. `dividend` must be a numeric or an interval. `divisor` must be a numeric.</td>
    </tr>
    <tr>
      <td>try_multiply(expr1, expr2)</td>
      <td>Returns `expr1`*`expr2` and the result is null on overflow. The acceptable input types are the same with the `*` operator.</td>
    </tr>
    <tr>
      <td>try_subtract(expr1, expr2)</td>
      <td>Returns `expr1`-`expr2` and the result is null on overflow. The acceptable input types are the same with the `-` operator.</td>
    </tr>
    <tr>
      <td>unhex(expr)</td>
      <td>Converts hexadecimal `expr` to binary.</td>
    </tr>
    <tr>
      <td>width_bucket(value, min_value, max_value, num_bucket)</td>
      <td>Returns the bucket number to which
      `value` would be assigned in an equiwidth histogram with `num_bucket` buckets,
      in the range `min_value` to `max_value`."</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-6">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- %</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">MOD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- *</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">6</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- +</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- -</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- /</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="n">L</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">L</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- abs</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="k">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="o">-</span><span class="s1">&#39;1-1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="k">abs</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-1-1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1-1&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="c1">-- acos</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">acos</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">ACOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">acos</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">ACOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="n">NaN</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- acosh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">acosh</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ACOSH</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">acosh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ACOSH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">NaN</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- asin</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">asin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">ASIN</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">asin</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">ASIN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="n">NaN</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- asinh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">asinh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ASINH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- atan</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">atan</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">ATAN</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- atan2</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">ATAN2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- atanh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">atanh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ATANH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">atanh</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ATANH</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">NaN</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- bin</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bin</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">bin</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1101</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bin</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">bin</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">11111111111111111</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bin</span><span class="p">(</span><span class="mi">13</span><span class="p">.</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">bin</span><span class="p">(</span><span class="mi">13</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">1101</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- bround</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bround</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">bround</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bround</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">bround</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- cbrt</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">cbrt</span><span class="p">(</span><span class="mi">27</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="n">CBRT</span><span class="p">(</span><span class="mi">27</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- ceil</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="n">CEIL</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">CEIL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">ceil</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">3</span><span class="p">.</span><span class="mi">142</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">ceil</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">1000</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- ceiling</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ceiling</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">ceiling</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceiling</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="n">ceiling</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceiling</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">ceiling</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">3</span><span class="p">.</span><span class="mi">142</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ceiling</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">ceiling</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">1000</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- conv</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">conv</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">conv</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">conv</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">conv</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="o">-</span><span class="mi">16</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- cos</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="n">COS</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>

<span class="c1">-- cosh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">cosh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">COSH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- cot</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">cot</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">COT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">6420926159343306</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- csc</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">csc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">CSC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">1</span><span class="p">.</span><span class="mi">1883951057781212</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- degrees</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">degrees</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">141592653589793</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">DEGREES</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">141592653589793</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">180</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- div</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">div</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">div</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1-1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="w"> </span><span class="n">div</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1-1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">MONTH</span><span class="w"> </span><span class="n">div</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                   </span><span class="o">-</span><span class="mi">13</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>

<span class="c1">-- e</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">E</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">2</span><span class="p">.</span><span class="mi">718281828459045</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- exp</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="n">EXP</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>

<span class="c1">-- expm1</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">expm1</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">EXPM1</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- factorial</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">120</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- floor</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">FLOOR</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">         </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">FLOOR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">3</span><span class="p">.</span><span class="mi">141</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">1411</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- greatest</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">greatest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">greatest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="c1">-- hex</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">11</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">    </span><span class="n">hex</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">537061726</span><span class="n">B2053514C</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- hypot</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">hypot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">HYPOT</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- least</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">least</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">least</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- ln</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----+</span>
<span class="o">|</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+</span>

<span class="c1">-- log</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">LOG</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- log10</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">LOG10</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- log1p</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">log1p</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">LOG1P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- log2</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">log2</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">LOG2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- mod</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">MOD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- negative</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">negative</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">negative</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">         </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- pi</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">pi</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">PI</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">3</span><span class="p">.</span><span class="mi">141592653589793</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- pmod</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">pmod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">pmod</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">pmod</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">pmod</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- positive</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">positive</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----+</span>
<span class="o">|</span><span class="p">(</span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----+</span>

<span class="c1">-- pow</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="c1">-- power</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="n">POWER</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- radians</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">radians</span><span class="p">(</span><span class="mi">180</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">3</span><span class="p">.</span><span class="mi">141592653589793</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- rand</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rand</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">rand</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">09109379190094202</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">7604953758285915</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="n">rand</span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">7604953758285915</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- randn</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">randn</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">randn</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0673051133316651</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">randn</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="n">randn</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">1</span><span class="p">.</span><span class="mi">6034991609278433</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">randn</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">randn</span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">1</span><span class="p">.</span><span class="mi">6034991609278433</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- random</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">random</span><span class="p">();</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">rand</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">4731149010070248</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">7604953758285915</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="n">rand</span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">7604953758285915</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- rint</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rint</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">3456</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">rint</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">3456</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- round</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">round</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- sec</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sec</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="n">SEC</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>

<span class="c1">-- shiftleft</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">shiftleft</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">shiftleft</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">              </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- sign</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sign</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">sign</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">     </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">sign</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="o">-</span><span class="s1">&#39;100&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">sign</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-100&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- signum</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">signum</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="n">SIGNUM</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">signum</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="o">-</span><span class="s1">&#39;100&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">SIGNUM</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;-100&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- sin</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="n">SIN</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>

<span class="c1">-- sinh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sinh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">SINH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- sqrt</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">SQRT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- tan</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">tan</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="n">TAN</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------+</span>

<span class="c1">-- tanh</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">tanh</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">TANH</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">    </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- try_add</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="mi">2147483647</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="mi">2147483647</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="nb">date</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="nb">date</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">year</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="w">                                   </span><span class="mi">2022</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="k">timestamp</span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">day</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2021-01-01 00:00:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_add</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">year</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">try_add</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>

<span class="c1">-- try_divide</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_divide</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">try_divide</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_divide</span><span class="p">(</span><span class="mi">2</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="n">L</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">try_divide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">try_divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_divide</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">try_divide</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0-1&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_divide</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">try_divide</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">MONTH</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- try_multiply</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">try_multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="mi">6</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">try_multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_multiply</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">try_multiply</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;6-0&#39;</span><span class="w"> </span><span class="n">YE</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="c1">-- try_subtract</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">date</span><span class="s1">&#39;2021-01-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2021-01-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">date</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">year</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                        </span><span class="mi">2020</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="k">timestamp</span><span class="s1">&#39;2021-01-02 00:00:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">day</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2021-01-02 00:00:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                            </span><span class="mi">2021</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">year</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="n">try_subtract</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>

<span class="c1">-- unhex</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;UTF-8&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="mi">537061726</span><span class="n">B2053514C</span><span class="p">),</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+</span>

<span class="c1">-- width_bucket</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                         </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                         </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">width_bucket</span><span class="p">(</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                      </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------+</span>
</code></pre></div>

<h3 id="string-functions">String Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ascii(str)</td>
      <td>Returns the numeric value of the first character of `str`.</td>
    </tr>
    <tr>
      <td>base64(bin)</td>
      <td>Converts the argument from a binary `bin` to a base 64 string.</td>
    </tr>
    <tr>
      <td>bit_length(expr)</td>
      <td>Returns the bit length of string data or number of bits of binary data.</td>
    </tr>
    <tr>
      <td>btrim(str)</td>
      <td>Removes the leading and trailing space characters from `str`.</td>
    </tr>
    <tr>
      <td>    btrim(str, trimStr)</td>
      <td>Remove the leading and trailing `trimStr` characters from `str`.</td>
    </tr>
    <tr>
      <td>char(expr)</td>
      <td>Returns the ASCII character having the binary equivalent to `expr`. If n is larger than 256 the result is equivalent to chr(n % 256)</td>
    </tr>
    <tr>
      <td>char_length(expr)</td>
      <td>Returns the character length of string data or number of bytes of binary data. The length of string data includes the trailing spaces. The length of binary data includes binary zeros.</td>
    </tr>
    <tr>
      <td>character_length(expr)</td>
      <td>Returns the character length of string data or number of bytes of binary data. The length of string data includes the trailing spaces. The length of binary data includes binary zeros.</td>
    </tr>
    <tr>
      <td>chr(expr)</td>
      <td>Returns the ASCII character having the binary equivalent to `expr`. If n is larger than 256 the result is equivalent to chr(n % 256)</td>
    </tr>
    <tr>
      <td>concat_ws(sep[, str | array(str)]+)</td>
      <td>Returns the concatenation of the strings separated by `sep`.</td>
    </tr>
    <tr>
      <td>contains(left, right)</td>
      <td>Returns a boolean. The value is True if right is found inside left.
    Returns NULL if either input expression is NULL. Otherwise, returns False.
    Both left or right must be of STRING or BINARY type.</td>
    </tr>
    <tr>
      <td>decode(bin, charset)</td>
      <td>Decodes the first argument using the second argument character set.</td>
    </tr>
    <tr>
      <td>    decode(expr, search, result [, search, result ] ... [, default])</td>
      <td>Compares expr
      to each search value in order. If expr is equal to a search value, decode returns
      the corresponding result. If no match is found, then it returns default. If default
      is omitted, it returns null.</td>
    </tr>
    <tr>
      <td>elt(n, input1, input2, ...)</td>
      <td>Returns the `n`-th input, e.g., returns `input2` when `n` is 2.
    The function returns NULL if the index exceeds the length of the array
    and `spark.sql.ansi.enabled` is set to false. If `spark.sql.ansi.enabled` is set to true,
    it throws ArrayIndexOutOfBoundsException for invalid indices.</td>
    </tr>
    <tr>
      <td>encode(str, charset)</td>
      <td>Encodes the first argument using the second argument character set.</td>
    </tr>
    <tr>
      <td>endswith(left, right)</td>
      <td>Returns a boolean. The value is True if left ends with right.
    Returns NULL if either input expression is NULL. Otherwise, returns False.
    Both left or right must be of STRING or BINARY type.</td>
    </tr>
    <tr>
      <td>find_in_set(str, str_array)</td>
      <td>Returns the index (1-based) of the given string (`str`) in the comma-delimited list (`str_array`).
      Returns 0, if the string was not found or if the given string (`str`) contains a comma.</td>
    </tr>
    <tr>
      <td>format_number(expr1, expr2)</td>
      <td>Formats the number `expr1` like '#,###,###.##', rounded to `expr2`
      decimal places. If `expr2` is 0, the result has no decimal point or fractional part.
      `expr2` also accept a user specified format.
      This is supposed to function like MySQL's FORMAT.</td>
    </tr>
    <tr>
      <td>format_string(strfmt, obj, ...)</td>
      <td>Returns a formatted string from printf-style format strings.</td>
    </tr>
    <tr>
      <td>initcap(str)</td>
      <td>Returns `str` with the first letter of each word in uppercase.
      All other letters are in lowercase. Words are delimited by white space.</td>
    </tr>
    <tr>
      <td>instr(str, substr)</td>
      <td>Returns the (1-based) index of the first occurrence of `substr` in `str`.</td>
    </tr>
    <tr>
      <td>lcase(str)</td>
      <td>Returns `str` with all characters changed to lowercase.</td>
    </tr>
    <tr>
      <td>left(str, len)</td>
      <td>Returns the leftmost `len`(`len` can be string type) characters from the string `str`,if `len` is less or equal than 0 the result is an empty string.</td>
    </tr>
    <tr>
      <td>length(expr)</td>
      <td>Returns the character length of string data or number of bytes of binary data. The length of string data includes the trailing spaces. The length of binary data includes binary zeros.</td>
    </tr>
    <tr>
      <td>levenshtein(str1, str2)</td>
      <td>Returns the Levenshtein distance between the two given strings.</td>
    </tr>
    <tr>
      <td>locate(substr, str[, pos])</td>
      <td>Returns the position of the first occurrence of `substr` in `str` after position `pos`.
      The given `pos` and return value are 1-based.</td>
    </tr>
    <tr>
      <td>lower(str)</td>
      <td>Returns `str` with all characters changed to lowercase.</td>
    </tr>
    <tr>
      <td>lpad(str, len[, pad])</td>
      <td>Returns `str`, left-padded with `pad` to a length of `len`.
      If `str` is longer than `len`, the return value is shortened to `len` characters or bytes.
      If `pad` is not specified, `str` will be padded to the left with space characters if it is
      a character string, and with zeros if it is a byte sequence.</td>
    </tr>
    <tr>
      <td>ltrim(str)</td>
      <td>Removes the leading space characters from `str`.</td>
    </tr>
    <tr>
      <td>octet_length(expr)</td>
      <td>Returns the byte length of string data or number of bytes of binary data.</td>
    </tr>
    <tr>
      <td>overlay(input, replace, pos[, len])</td>
      <td>Replace `input` with `replace` that starts at `pos` and is of length `len`.</td>
    </tr>
    <tr>
      <td>parse_url(url, partToExtract[, key])</td>
      <td>Extracts a part from a URL.</td>
    </tr>
    <tr>
      <td>position(substr, str[, pos])</td>
      <td>Returns the position of the first occurrence of `substr` in `str` after position `pos`.
      The given `pos` and return value are 1-based.</td>
    </tr>
    <tr>
      <td>printf(strfmt, obj, ...)</td>
      <td>Returns a formatted string from printf-style format strings.</td>
    </tr>
    <tr>
      <td>regexp_extract(str, regexp[, idx])</td>
      <td>Extract the first string in the `str` that match the `regexp`
    expression and corresponding to the regex group index.</td>
    </tr>
    <tr>
      <td>regexp_extract_all(str, regexp[, idx])</td>
      <td>Extract all strings in the `str` that match the `regexp`
    expression and corresponding to the regex group index.</td>
    </tr>
    <tr>
      <td>regexp_replace(str, regexp, rep[, position])</td>
      <td>Replaces all substrings of `str` that match `regexp` with `rep`.</td>
    </tr>
    <tr>
      <td>repeat(str, n)</td>
      <td>Returns the string which repeats the given string value n times.</td>
    </tr>
    <tr>
      <td>replace(str, search[, replace])</td>
      <td>Replaces all occurrences of `search` with `replace`.</td>
    </tr>
    <tr>
      <td>right(str, len)</td>
      <td>Returns the rightmost `len`(`len` can be string type) characters from the string `str`,if `len` is less or equal than 0 the result is an empty string.</td>
    </tr>
    <tr>
      <td>rpad(str, len[, pad])</td>
      <td>Returns `str`, right-padded with `pad` to a length of `len`.
      If `str` is longer than `len`, the return value is shortened to `len` characters.
      If `pad` is not specified, `str` will be padded to the right with space characters if it is
      a character string, and with zeros if it is a binary string.</td>
    </tr>
    <tr>
      <td>rtrim(str)</td>
      <td>Removes the trailing space characters from `str`.</td>
    </tr>
    <tr>
      <td>sentences(str[, lang, country])</td>
      <td>Splits `str` into an array of array of words.</td>
    </tr>
    <tr>
      <td>soundex(str)</td>
      <td>Returns Soundex code of the string.</td>
    </tr>
    <tr>
      <td>space(n)</td>
      <td>Returns a string consisting of `n` spaces.</td>
    </tr>
    <tr>
      <td>split(str, regex, limit)</td>
      <td>Splits `str` around occurrences that match `regex` and returns an array with a length of at most `limit`</td>
    </tr>
    <tr>
      <td>split_part(str, delimiter, partNum)</td>
      <td>Splits `str` by delimiter and return
      requested part of the split (1-based). If any input is null, returns null.
      if `partNum` is out of range of split parts, returns empty string. If `partNum` is 0,
      throws an error. If `partNum` is negative, the parts are counted backward from the
      end of the string. If the `delimiter` is an empty string, the `str` is not split.</td>
    </tr>
    <tr>
      <td>startswith(left, right)</td>
      <td>Returns a boolean. The value is True if left starts with right.
    Returns NULL if either input expression is NULL. Otherwise, returns False.
    Both left or right must be of STRING or BINARY type.</td>
    </tr>
    <tr>
      <td>substr(str, pos[, len])</td>
      <td>Returns the substring of `str` that starts at `pos` and is of length `len`, or the slice of byte array that starts at `pos` and is of length `len`.</td>
    </tr>
    <tr>
      <td>    substr(str FROM pos[ FOR len]])</td>
      <td>Returns the substring of `str` that starts at `pos` and is of length `len`, or the slice of byte array that starts at `pos` and is of length `len`.</td>
    </tr>
    <tr>
      <td>substring(str, pos[, len])</td>
      <td>Returns the substring of `str` that starts at `pos` and is of length `len`, or the slice of byte array that starts at `pos` and is of length `len`.</td>
    </tr>
    <tr>
      <td>    substring(str FROM pos[ FOR len]])</td>
      <td>Returns the substring of `str` that starts at `pos` and is of length `len`, or the slice of byte array that starts at `pos` and is of length `len`.</td>
    </tr>
    <tr>
      <td>substring_index(str, delim, count)</td>
      <td>Returns the substring from `str` before `count` occurrences of the delimiter `delim`.
      If `count` is positive, everything to the left of the final delimiter (counting from the
      left) is returned. If `count` is negative, everything to the right of the final delimiter
      (counting from the right) is returned. The function substring_index performs a case-sensitive match
      when searching for `delim`.</td>
    </tr>
    <tr>
      <td>to_binary(str[, fmt])</td>
      <td>Converts the input `str` to a binary value based on the supplied `fmt`.
      `fmt` can be a case-insensitive string literal of "hex", "utf-8", or "base64".
      By default, the binary format for conversion is "hex" if `fmt` is omitted.
      The function returns NULL if at least one of the input parameters is NULL.</td>
    </tr>
    <tr>
      <td>to_number(expr, fmt)</td>
      <td>Convert string 'expr' to a number based on the string format 'fmt'.
       Throws an exception if the conversion fails. The format can consist of the following
       characters, case insensitive:
         '0' or '9': Specifies an expected digit between 0 and 9. A sequence of 0 or 9 in the format
           string matches a sequence of digits in the input string. If the 0/9 sequence starts with
           0 and is before the decimal point, it can only match a digit sequence of the same size.
           Otherwise, if the sequence starts with 9 or is after the decimal poin, it can match a
           digit sequence that has the same or smaller size.
         '.' or 'D': Specifies the position of the decimal point (optional, only allowed once).
         ',' or 'G': Specifies the position of the grouping (thousands) separator (,). There must be
           one or more 0 or 9 to the left of the rightmost grouping separator. 'expr' must match the
           grouping separator relevant for the size of the number.
         '$': Specifies the location of the $ currency sign. This character may only be specified
           once.
         'S' or 'MI': Specifies the position of a '-' or '+' sign (optional, only allowed once at
           the beginning or end of the format string). Note that 'S' allows '-' but 'MI' does not.
         'PR': Only allowed at the end of the format string; specifies that 'expr' indicates a
           negative number with wrapping angled brackets.
           ('&lt;1&gt;').</td>
    </tr>
    <tr>
      <td>translate(input, from, to)</td>
      <td>Translates the `input` string by replacing the characters present in the `from` string with the corresponding characters in the `to` string.</td>
    </tr>
    <tr>
      <td>trim(str)</td>
      <td>Removes the leading and trailing space characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(BOTH FROM str)</td>
      <td>Removes the leading and trailing space characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(LEADING FROM str)</td>
      <td>Removes the leading space characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(TRAILING FROM str)</td>
      <td>Removes the trailing space characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(trimStr FROM str)</td>
      <td>Remove the leading and trailing `trimStr` characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(BOTH trimStr FROM str)</td>
      <td>Remove the leading and trailing `trimStr` characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(LEADING trimStr FROM str)</td>
      <td>Remove the leading `trimStr` characters from `str`.</td>
    </tr>
    <tr>
      <td>    trim(TRAILING trimStr FROM str)</td>
      <td>Remove the trailing `trimStr` characters from `str`.</td>
    </tr>
    <tr>
      <td>try_to_binary(str[, fmt])</td>
      <td>This is a special version of `to_binary` that performs the same operation, but returns a NULL value instead of raising an error if the conversion cannot be performed.</td>
    </tr>
    <tr>
      <td>try_to_number(expr, fmt)</td>
      <td>Convert string 'expr' to a number based on the string format `fmt`.
       Returns NULL if the string 'expr' does not match the expected format. The format follows the
       same semantics as the to_number function.</td>
    </tr>
    <tr>
      <td>ucase(str)</td>
      <td>Returns `str` with all characters changed to uppercase.</td>
    </tr>
    <tr>
      <td>unbase64(str)</td>
      <td>Converts the argument from a base 64 string `str` to a binary.</td>
    </tr>
    <tr>
      <td>upper(str)</td>
      <td>Returns `str` with all characters changed to uppercase.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-7">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- ascii</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ascii</span><span class="p">(</span><span class="s1">&#39;222&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="n">ascii</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">50</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">ascii</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="n">ascii</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">50</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- base64</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">base64</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">base64</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">U3BhcmsgU1FM</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- bit_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">bit_length</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="k">bit_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">72</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- btrim</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">btrim</span><span class="p">(</span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">btrim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">btrim</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">btrim</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">btrim</span><span class="p">(</span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">btrim</span><span class="p">(</span><span class="n">SSparkSQLS</span><span class="p">,</span><span class="w"> </span><span class="n">SL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="n">parkSQ</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">btrim</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;SL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="n">btrim</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">SSparkSQLS</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="n">SL</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                             </span><span class="n">parkSQ</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>

<span class="c1">-- char</span>
<span class="k">SELECT</span><span class="w"> </span><span class="nb">char</span><span class="p">(</span><span class="mi">65</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="nb">char</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">A</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- char_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">char_length</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">char_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">char_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHARACTER_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="k">character_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- character_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="k">character_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">char_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHARACTER_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="k">character_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- chr</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">chr</span><span class="p">(</span><span class="mi">65</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="n">chr</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">A</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- concat_ws</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Spark&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">concat_ws</span><span class="p">(</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">concat_ws</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">            </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- contains</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Spark&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="k">contains</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">Spark</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SPARK&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="k">contains</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">SPARK</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="k">contains</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="s1">&#39;537061726b&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="k">contains</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;537061726B&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="c1">-- decode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">abc</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Southlake&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;New Jersey&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seattle&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Non domestic&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Southlake</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">San</span><span class="w"> </span><span class="n">Francisco</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Jersey</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Seattle</span><span class="p">,</span><span class="w"> </span><span class="n">Non</span><span class="w"> </span><span class="n">domestic</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                     </span><span class="n">San</span><span class="w"> </span><span class="n">Francisco</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Southlake&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;New Jersey&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seattle&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Non domestic&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Southlake</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">San</span><span class="w"> </span><span class="n">Francisco</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Jersey</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Seattle</span><span class="p">,</span><span class="w"> </span><span class="n">Non</span><span class="w"> </span><span class="n">domestic</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                      </span><span class="n">Non</span><span class="w"> </span><span class="n">domestic</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Southlake&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;New Jersey&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seattle&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Southlake</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">San</span><span class="w"> </span><span class="n">Francisco</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Jersey</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Seattle</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Spark&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rocks&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">decode</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">rocks</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                                        </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="c1">-- elt</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">elt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scala&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;java&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">elt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">scala</span><span class="p">,</span><span class="w"> </span><span class="n">java</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">scala</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- encode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">encode</span><span class="p">(</span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">61</span><span class="w"> </span><span class="mi">62</span><span class="w"> </span><span class="mi">63</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- endswith</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">endswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Spark&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">endswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">Spark</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">endswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">endswith</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="s1">&#39;537061726b&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">endswith</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;537061726B&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                         </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">endswith</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="s1">&#39;53514c&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">endswith</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;53514C&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="w">                                      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>

<span class="c1">-- find_in_set</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span><span class="s1">&#39;abc,b,ab,c,def&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">find_in_set</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span><span class="w"> </span><span class="n">abc</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">ab</span><span class="p">,</span><span class="k">c</span><span class="p">,</span><span class="n">def</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- format_number</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">format_number</span><span class="p">(</span><span class="mi">12332</span><span class="p">.</span><span class="mi">123456</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="n">format_number</span><span class="p">(</span><span class="mi">12332</span><span class="p">.</span><span class="mi">123456</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">12</span><span class="p">,</span><span class="mi">332</span><span class="p">.</span><span class="mi">1235</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">format_number</span><span class="p">(</span><span class="mi">12332</span><span class="p">.</span><span class="mi">123456</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;##################.###&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="n">format_number</span><span class="p">(</span><span class="mi">12332</span><span class="p">.</span><span class="mi">123456</span><span class="p">,</span><span class="w"> </span><span class="o">##################</span><span class="p">.</span><span class="o">###</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="mi">12332</span><span class="p">.</span><span class="mi">123</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------+</span>

<span class="c1">-- format_string</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">format_string</span><span class="p">(</span><span class="ss">&quot;Hello World %d %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;days&quot;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="n">format_string</span><span class="p">(</span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="o">%</span><span class="n">d</span><span class="w"> </span><span class="o">%</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">days</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">days</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------+</span>

<span class="c1">-- initcap</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">initcap</span><span class="p">(</span><span class="s1">&#39;sPark sql&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">initcap</span><span class="p">(</span><span class="n">sPark</span><span class="w"> </span><span class="k">sql</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">         </span><span class="n">Spark</span><span class="w"> </span><span class="k">Sql</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- instr</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">instr</span><span class="p">(</span><span class="s1">&#39;SparkSQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">instr</span><span class="p">(</span><span class="n">SparkSQL</span><span class="p">,</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">6</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- lcase</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">lcase</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">lcase</span><span class="p">(</span><span class="n">SparkSql</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">sparksql</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- left</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="k">left</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="n">Spa</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="k">length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">char_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CHARACTER_LENGTH</span><span class="p">(</span><span class="s1">&#39;Spark SQL &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="k">character_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- levenshtein</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">levenshtein</span><span class="p">(</span><span class="s1">&#39;kitten&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sitting&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">levenshtein</span><span class="p">(</span><span class="n">kitten</span><span class="p">,</span><span class="w"> </span><span class="n">sitting</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="c1">-- locate</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">locate</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">locate</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">locate</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">locate</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">POSITION</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">locate</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- lower</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="k">lower</span><span class="p">(</span><span class="n">SparkSql</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">sparksql</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- lpad</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;??&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">lpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="o">??</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="o">???</span><span class="n">hi</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;??&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">lpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">??</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">h</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">lpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">  </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">            </span><span class="n">hi</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">lpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">lpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">aabb</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;00&#39;</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">000000</span><span class="n">AABB</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">lpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;1122&#39;</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">lpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">aabb</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">unhex</span><span class="p">(</span><span class="mi">1122</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="mi">112211</span><span class="n">AABB</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- ltrim</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ltrim</span><span class="p">(</span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">ltrim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">SparkSQL</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- octet_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">octet_length</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">octet_length</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">9</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- overlay</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="n">Spark_SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="s1">&#39;CORE&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">CORE</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="n">Spark</span><span class="w"> </span><span class="n">CORE</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="s1">&#39;ANSI &#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="n">Spark</span><span class="w"> </span><span class="n">ANSI</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="s1">&#39;tructured&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">tructured</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="n">Structured</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                      </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">5</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;CORE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="n">CORE</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                         </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">2</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ANSI &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="n">ANSI</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                         </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">2</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">PLACING</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;tructured&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="k">overlay</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">encode</span><span class="p">(</span><span class="n">tructured</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                             </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">75</span><span class="w"> </span><span class="mi">63</span><span class="w"> </span><span class="mi">7</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------+</span>

<span class="c1">-- parse_url</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HOST&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">HOST</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                     </span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;QUERY&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">QUERY</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                               </span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;QUERY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">QUERY</span><span class="p">,</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                            </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="c1">-- position</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">position</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="k">position</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">position</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="k">position</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">POSITION</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="s1">&#39;foobarbar&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">locate</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">foobarbar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- printf</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="ss">&quot;Hello World %d %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;days&quot;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">printf</span><span class="p">(</span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="o">%</span><span class="n">d</span><span class="w"> </span><span class="o">%</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">days</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">days</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="c1">-- regexp_extract</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_extract</span><span class="p">(</span><span class="s1">&#39;100-200&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(\\d+)-(\\d+)&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">regexp_extract</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                                    </span><span class="mi">100</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="c1">-- regexp_extract_all</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_extract_all</span><span class="p">(</span><span class="s1">&#39;100-200, 300-400&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(\\d+)-(\\d+)&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="o">|</span><span class="n">regexp_extract_all</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------+</span>

<span class="c1">-- regexp_replace</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_replace</span><span class="p">(</span><span class="s1">&#39;100-200&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(\\d+)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;num&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">regexp_replace</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="p">),</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                               </span><span class="n">num</span><span class="o">-</span><span class="n">num</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- repeat</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">repeat</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">        </span><span class="mi">123123</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- replace</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DEF&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="k">replace</span><span class="p">(</span><span class="n">ABCabc</span><span class="p">,</span><span class="w"> </span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">DEF</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="n">ABCDEF</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- right</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">right</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="k">right</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- rpad</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;??&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">rpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="o">??</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="n">hi</span><span class="o">???|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;??&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">rpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">??</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">h</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">rpad</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">  </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">         </span><span class="n">hi</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">rpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">rpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">aabb</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;00&#39;</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="n">AABB000000</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">rpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;1122&#39;</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">rpad</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">aabb</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">unhex</span><span class="p">(</span><span class="mi">1122</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="n">AABB112211</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- rtrim</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rtrim</span><span class="p">(</span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">rtrim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- sentences</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sentences</span><span class="p">(</span><span class="s1">&#39;Hi there! Good morning.&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="n">sentences</span><span class="p">(</span><span class="n">Hi</span><span class="w"> </span><span class="n">there</span><span class="o">!</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="n">morning</span><span class="p">.,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="p">[[</span><span class="n">Hi</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="k">Go</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------+</span>

<span class="c1">-- soundex</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">soundex</span><span class="p">(</span><span class="s1">&#39;Miller&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">soundex</span><span class="p">(</span><span class="n">Miller</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">M460</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- space</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">concat</span><span class="p">(</span><span class="k">space</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">concat</span><span class="p">(</span><span class="k">space</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- split</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[ABC]&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">split</span><span class="p">(</span><span class="n">oneAtwoBthreeC</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ABC</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="p">[</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="p">,</span><span class="w"> </span><span class="n">three</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[ABC]&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">split</span><span class="p">(</span><span class="n">oneAtwoBthreeC</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ABC</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="p">[</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="p">,</span><span class="w"> </span><span class="n">three</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[ABC]&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">split</span><span class="p">(</span><span class="n">oneAtwoBthreeC</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ABC</span><span class="p">],</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="p">[</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">twoBthreeC</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- split_part</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="s1">&#39;11.12.13&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">split_part</span><span class="p">(</span><span class="mi">11</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="p">.,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">13</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- startswith</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Spark&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="n">startswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="n">Spark</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SQL&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">startswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="k">SQL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="n">startswith</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">startswith</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="s1">&#39;537061726b&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="n">startswith</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;537061726B&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                            </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">startswith</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="s1">&#39;53514c&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">startswith</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;537061726B2053514C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="s1">&#39;53514C&#39;</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>

<span class="c1">-- substr</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">substr</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="n">k</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">substr</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">substr</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="n">k</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">k</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="n">k</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- substring</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">k</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="n">k</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                              </span><span class="n">k</span><span class="w"> </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2147483647</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                                 </span><span class="k">SQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="k">substring</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="n">k</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- substring_index</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;www.apache.org&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="n">substring_index</span><span class="p">(</span><span class="n">www</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="p">,</span><span class="w"> </span><span class="p">.,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="n">www</span><span class="p">.</span><span class="n">apache</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------+</span>

<span class="c1">-- to_binary</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_binary</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">to_binary</span><span class="p">(</span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="p">[</span><span class="mi">61</span><span class="w"> </span><span class="mi">62</span><span class="w"> </span><span class="mi">63</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="c1">-- to_number</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;454&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;999&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">to_number</span><span class="p">(</span><span class="mi">454</span><span class="p">,</span><span class="w"> </span><span class="mi">999</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">454</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;454.00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;000.00&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">to_number</span><span class="p">(</span><span class="mi">454</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span><span class="w"> </span><span class="mi">000</span><span class="p">.</span><span class="mi">00</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">454</span><span class="p">.</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;12,454&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;99,999&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">to_number</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">454</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">12454</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;$78.12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$99.99&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">to_number</span><span class="p">(</span><span class="err">$</span><span class="mi">78</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="mi">99</span><span class="p">.</span><span class="mi">99</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">78</span><span class="p">.</span><span class="mi">12</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;12,454.8-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;99,999.9S&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">to_number</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">454</span><span class="p">.</span><span class="mi">8</span><span class="o">-</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="mi">999</span><span class="p">.</span><span class="mi">9</span><span class="n">S</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="o">-</span><span class="mi">12454</span><span class="p">.</span><span class="mi">8</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- translate</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">translate</span><span class="p">(</span><span class="s1">&#39;AaBbCc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;123&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="k">translate</span><span class="p">(</span><span class="n">AaBbCc</span><span class="p">,</span><span class="w"> </span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="mi">123</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="n">A1B2C3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------+</span>

<span class="c1">-- trim</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="k">trim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">BOTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="k">trim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">LEADING</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">ltrim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">SparkSQL</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">TRAILING</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;    SparkSQL   &#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">rtrim</span><span class="p">(</span><span class="w">    </span><span class="n">SparkSQL</span><span class="w">   </span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">SparkSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="s1">&#39;SL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="k">TRIM</span><span class="p">(</span><span class="k">BOTH</span><span class="w"> </span><span class="n">SL</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SSparkSQLS</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="n">parkSQ</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">BOTH</span><span class="w"> </span><span class="s1">&#39;SL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="k">TRIM</span><span class="p">(</span><span class="k">BOTH</span><span class="w"> </span><span class="n">SL</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SSparkSQLS</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="n">parkSQ</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">LEADING</span><span class="w"> </span><span class="s1">&#39;SL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="k">TRIM</span><span class="p">(</span><span class="k">LEADING</span><span class="w"> </span><span class="n">SL</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SSparkSQLS</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="n">parkSQLS</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">TRAILING</span><span class="w"> </span><span class="s1">&#39;SL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;SSparkSQLS&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="k">TRIM</span><span class="p">(</span><span class="k">TRAILING</span><span class="w"> </span><span class="n">SL</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SSparkSQLS</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                         </span><span class="n">SSparkSQ</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- try_to_binary</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_binary</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">try_to_binary</span><span class="p">(</span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="p">[</span><span class="mi">61</span><span class="w"> </span><span class="mi">62</span><span class="w"> </span><span class="mi">63</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">select</span><span class="w"> </span><span class="n">try_to_binary</span><span class="p">(</span><span class="s1">&#39;a!&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">try_to_binary</span><span class="p">(</span><span class="n">a</span><span class="o">!</span><span class="p">,</span><span class="w"> </span><span class="n">base64</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                     </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="k">select</span><span class="w"> </span><span class="n">try_to_binary</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;invalidFormat&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="n">try_to_binary</span><span class="p">(</span><span class="n">abc</span><span class="p">,</span><span class="w"> </span><span class="n">invalidFormat</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------+</span>

<span class="c1">-- try_to_number</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_number</span><span class="p">(</span><span class="s1">&#39;454&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;999&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="n">try_to_number</span><span class="p">(</span><span class="mi">454</span><span class="p">,</span><span class="w"> </span><span class="mi">999</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                    </span><span class="mi">454</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_number</span><span class="p">(</span><span class="s1">&#39;454.00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;000.00&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">try_to_number</span><span class="p">(</span><span class="mi">454</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span><span class="w"> </span><span class="mi">000</span><span class="p">.</span><span class="mi">00</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">454</span><span class="p">.</span><span class="mi">00</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_number</span><span class="p">(</span><span class="s1">&#39;12,454&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;99,999&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">try_to_number</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">454</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">12454</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_number</span><span class="p">(</span><span class="s1">&#39;$78.12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$99.99&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">try_to_number</span><span class="p">(</span><span class="err">$</span><span class="mi">78</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="mi">99</span><span class="p">.</span><span class="mi">99</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                        </span><span class="mi">78</span><span class="p">.</span><span class="mi">12</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">try_to_number</span><span class="p">(</span><span class="s1">&#39;12,454.8-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;99,999.9S&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="n">try_to_number</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">454</span><span class="p">.</span><span class="mi">8</span><span class="o">-</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="mi">999</span><span class="p">.</span><span class="mi">9</span><span class="n">S</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">                           </span><span class="o">-</span><span class="mi">12454</span><span class="p">.</span><span class="mi">8</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="c1">-- ucase</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ucase</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">ucase</span><span class="p">(</span><span class="n">SparkSql</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">SPARKSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- unbase64</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">unbase64</span><span class="p">(</span><span class="s1">&#39;U3BhcmsgU1FM&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">unbase64</span><span class="p">(</span><span class="n">U3BhcmsgU1FM</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">2</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- upper</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">upper</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="k">upper</span><span class="p">(</span><span class="n">SparkSql</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">       </span><span class="n">SPARKSQL</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</code></pre></div>

<h3 id="conditional-functions">Conditional Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>coalesce(expr1, expr2, ...)</td>
      <td>Returns the first non-null argument if exists. Otherwise, null.</td>
    </tr>
    <tr>
      <td>if(expr1, expr2, expr3)</td>
      <td>If `expr1` evaluates to true, then returns `expr2`; otherwise returns `expr3`.</td>
    </tr>
    <tr>
      <td>ifnull(expr1, expr2)</td>
      <td>Returns `expr2` if `expr1` is null, or `expr1` otherwise.</td>
    </tr>
    <tr>
      <td>nanvl(expr1, expr2)</td>
      <td>Returns `expr1` if it's not NaN, or `expr2` otherwise.</td>
    </tr>
    <tr>
      <td>nullif(expr1, expr2)</td>
      <td>Returns null if `expr1` equals to `expr2`, or `expr1` otherwise.</td>
    </tr>
    <tr>
      <td>nvl(expr1, expr2)</td>
      <td>Returns `expr2` if `expr1` is null, or `expr1` otherwise.</td>
    </tr>
    <tr>
      <td>nvl2(expr1, expr2, expr3)</td>
      <td>Returns `expr2` if `expr1` is not null, or `expr3` otherwise.</td>
    </tr>
    <tr>
      <td>CASE WHEN expr1 THEN expr2 [WHEN expr3 THEN expr4]* [ELSE expr5] END</td>
      <td>When `expr1` = true, returns `expr2`; else when `expr3` = true, returns `expr4`; else returns `expr5`.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-8">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- coalesce</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">coalesce</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="k">coalesce</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="c1">-- if</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">IF</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                  </span><span class="n">a</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- ifnull</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ifnull</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="n">ifnull</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="c1">-- nanvl</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">nanvl</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">double</span><span class="p">),</span><span class="w"> </span><span class="mi">123</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="n">nanvl</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="n">NaN</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">),</span><span class="w"> </span><span class="mi">123</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="mi">123</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+</span>

<span class="c1">-- nullif</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">nullif</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="k">nullif</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- nvl</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">nvl</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="n">nvl</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="c1">-- nvl2</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">nvl2</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">nvl2</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- when</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="k">END</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="k">END</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="k">END</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="k">END</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                              </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
</code></pre></div>

<h3 id="bitwise-functions">Bitwise Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>expr1 &amp; expr2</td>
      <td>Returns the result of bitwise AND of `expr1` and `expr2`.</td>
    </tr>
    <tr>
      <td>expr1 ^ expr2</td>
      <td>Returns the result of bitwise exclusive OR of `expr1` and `expr2`.</td>
    </tr>
    <tr>
      <td>bit_count(expr)</td>
      <td>Returns the number of bits that are set in the argument expr as an unsigned 64-bit integer, or NULL if the argument is NULL.</td>
    </tr>
    <tr>
      <td>bit_get(expr, pos)</td>
      <td>Returns the value of the bit (0 or 1) at the specified position.
      The positions are numbered from right to left, starting at zero.
      The position argument cannot be negative.</td>
    </tr>
    <tr>
      <td>getbit(expr, pos)</td>
      <td>Returns the value of the bit (0 or 1) at the specified position.
      The positions are numbered from right to left, starting at zero.
      The position argument cannot be negative.</td>
    </tr>
    <tr>
      <td>shiftright(base, expr)</td>
      <td>Bitwise (signed) right shift.</td>
    </tr>
    <tr>
      <td>shiftrightunsigned(base, expr)</td>
      <td>Bitwise unsigned right shift.</td>
    </tr>
    <tr>
      <td>expr1 | expr2</td>
      <td>Returns the result of bitwise OR of `expr1` and `expr2`.</td>
    </tr>
    <tr>
      <td>~ expr</td>
      <td>Returns the result of bitwise NOT of `expr`.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-9">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- &amp;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- ^</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">6</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- bit_count</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_count</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">bit_count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">           </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="c1">-- bit_get</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_get</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">bit_get</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">bit_get</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="n">bit_get</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- getbit</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">getbit</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">getbit</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">getbit</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">getbit</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">            </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- shiftright</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">shiftright</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">shiftright</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- shiftrightunsigned</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">shiftrightunsigned</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">shiftrightunsigned</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="c1">-- |</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="c1">-- ~</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="w"> </span><span class="o">~</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
</code></pre></div>

<h3 id="conversion-functions">Conversion Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>bigint(expr)</td>
      <td>Casts the value `expr` to the target data type `bigint`.</td>
    </tr>
    <tr>
      <td>binary(expr)</td>
      <td>Casts the value `expr` to the target data type `binary`.</td>
    </tr>
    <tr>
      <td>boolean(expr)</td>
      <td>Casts the value `expr` to the target data type `boolean`.</td>
    </tr>
    <tr>
      <td>cast(expr AS type)</td>
      <td>Casts the value `expr` to the target data type `type`.</td>
    </tr>
    <tr>
      <td>date(expr)</td>
      <td>Casts the value `expr` to the target data type `date`.</td>
    </tr>
    <tr>
      <td>decimal(expr)</td>
      <td>Casts the value `expr` to the target data type `decimal`.</td>
    </tr>
    <tr>
      <td>double(expr)</td>
      <td>Casts the value `expr` to the target data type `double`.</td>
    </tr>
    <tr>
      <td>float(expr)</td>
      <td>Casts the value `expr` to the target data type `float`.</td>
    </tr>
    <tr>
      <td>int(expr)</td>
      <td>Casts the value `expr` to the target data type `int`.</td>
    </tr>
    <tr>
      <td>smallint(expr)</td>
      <td>Casts the value `expr` to the target data type `smallint`.</td>
    </tr>
    <tr>
      <td>string(expr)</td>
      <td>Casts the value `expr` to the target data type `string`.</td>
    </tr>
    <tr>
      <td>timestamp(expr)</td>
      <td>Casts the value `expr` to the target data type `timestamp`.</td>
    </tr>
    <tr>
      <td>tinyint(expr)</td>
      <td>Casts the value `expr` to the target data type `tinyint`.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-10">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- cast</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">int</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="k">CAST</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">10</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</code></pre></div>

<h3 id="predicate-functions">Predicate Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>! expr</td>
      <td>Logical not.</td>
    </tr>
    <tr>
      <td>expr1 &lt; expr2</td>
      <td>Returns true if `expr1` is less than `expr2`.</td>
    </tr>
    <tr>
      <td>expr1 &lt;= expr2</td>
      <td>Returns true if `expr1` is less than or equal to `expr2`.</td>
    </tr>
    <tr>
      <td>expr1 &lt;=&gt; expr2</td>
      <td>Returns same result as the EQUAL(=) operator for non-null operands,
      but returns true if both are null, false if one of the them is null.</td>
    </tr>
    <tr>
      <td>expr1 = expr2</td>
      <td>Returns true if `expr1` equals `expr2`, or false otherwise.</td>
    </tr>
    <tr>
      <td>expr1 == expr2</td>
      <td>Returns true if `expr1` equals `expr2`, or false otherwise.</td>
    </tr>
    <tr>
      <td>expr1 &gt; expr2</td>
      <td>Returns true if `expr1` is greater than `expr2`.</td>
    </tr>
    <tr>
      <td>expr1 &gt;= expr2</td>
      <td>Returns true if `expr1` is greater than or equal to `expr2`.</td>
    </tr>
    <tr>
      <td>expr1 and expr2</td>
      <td>Logical AND.</td>
    </tr>
    <tr>
      <td>str ilike pattern[ ESCAPE escape]</td>
      <td>Returns true if str matches `pattern` with `escape` case-insensitively, null if any arguments are null, false otherwise.</td>
    </tr>
    <tr>
      <td>expr1 in(expr2, expr3, ...)</td>
      <td>Returns true if `expr` equals to any valN.</td>
    </tr>
    <tr>
      <td>isnan(expr)</td>
      <td>Returns true if `expr` is NaN, or false otherwise.</td>
    </tr>
    <tr>
      <td>isnotnull(expr)</td>
      <td>Returns true if `expr` is not null, or false otherwise.</td>
    </tr>
    <tr>
      <td>isnull(expr)</td>
      <td>Returns true if `expr` is null, or false otherwise.</td>
    </tr>
    <tr>
      <td>str like pattern[ ESCAPE escape]</td>
      <td>Returns true if str matches `pattern` with `escape`, null if any arguments are null, false otherwise.</td>
    </tr>
    <tr>
      <td>not expr</td>
      <td>Logical not.</td>
    </tr>
    <tr>
      <td>expr1 or expr2</td>
      <td>Logical OR.</td>
    </tr>
    <tr>
      <td>regexp(str, regexp)</td>
      <td>Returns true if `str` matches `regexp`, or false otherwise.</td>
    </tr>
    <tr>
      <td>regexp_like(str, regexp)</td>
      <td>Returns true if `str` matches `regexp`, or false otherwise.</td>
    </tr>
    <tr>
      <td>rlike(str, regexp)</td>
      <td>Returns true if `str` matches `regexp`, or false otherwise.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-11">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- !</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- &lt;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-08-01 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                         </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- &lt;=</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-08-01 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- &lt;=&gt;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NULL</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- =</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- ==</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="w">         </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>

<span class="c1">-- &gt;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span><span class="w">   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-08-01 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- &gt;=</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>
<span class="o">|</span><span class="w">    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2.1&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-07-30 04:17:52&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2009-08-01 04:17:52&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="mi">2009</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span><span class="w"> </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                         </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- and</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">false</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- ilike</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">ilike</span><span class="p">(</span><span class="s1">&#39;Spark&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_Park&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="k">ilike</span><span class="p">(</span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="n">_Park</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\Users\John&#39;</span><span class="w"> </span><span class="k">ilike</span><span class="w"> </span><span class="s1">&#39;\%SystemDrive\%\\users%&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="k">ilike</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="err">\</span><span class="o">%</span><span class="n">SystemDrive</span><span class="err">\</span><span class="o">%</span><span class="err">\\</span><span class="n">users</span><span class="o">%</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\USERS\\John&#39;</span><span class="w"> </span><span class="k">ilike</span><span class="w"> </span><span class="s1">&#39;\%SystemDrive\%\\\\Users%&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="k">ilike</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">USERS</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="err">\</span><span class="o">%</span><span class="n">SystemDrive</span><span class="err">\</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="o">%</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%/Users/John&#39;</span><span class="w"> </span><span class="k">ilike</span><span class="w"> </span><span class="s1">&#39;/%SYSTEMDrive/%//Users%&#39;</span><span class="w"> </span><span class="k">ESCAPE</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="k">ilike</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%/</span><span class="n">Users</span><span class="o">/</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">/%</span><span class="n">SYSTEMDrive</span><span class="o">/%//</span><span class="n">Users</span><span class="o">%</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="c1">-- in</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">in</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">in</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                             </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                              </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------+</span>

<span class="c1">-- isnan</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">double</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="n">isnan</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="n">NaN</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------+</span>

<span class="c1">-- isnotnull</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">isnotnull</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- isnull</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">isnull</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="c1">-- like</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">like</span><span class="p">(</span><span class="s1">&#39;Spark&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_park&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">Spark</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="n">_park</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">            </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\Users\John&#39;</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;\%SystemDrive\%\\Users%&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="err">\</span><span class="o">%</span><span class="n">SystemDrive</span><span class="err">\</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="o">%|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                 </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\Users\\John&#39;</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;\%SystemDrive\%\\\\Users%&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="err">\</span><span class="o">%</span><span class="n">SystemDrive</span><span class="err">\</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="o">%|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                 </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%/Users/John&#39;</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;/%SystemDrive/%//Users%&#39;</span><span class="w"> </span><span class="k">ESCAPE</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|%</span><span class="n">SystemDrive</span><span class="o">%/</span><span class="n">Users</span><span class="o">/</span><span class="n">John</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="o">/%</span><span class="n">SystemDrive</span><span class="o">/%//</span><span class="n">Users</span><span class="o">%|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                 </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="c1">-- not</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">     </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span><span class="w">       </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>
<span class="o">|</span><span class="w">      </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- or</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">false</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">false</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">true</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="p">(</span><span class="k">false</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="c1">-- regexp</span>
<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\Users\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="n">REGEXP</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\\Users\\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="n">REGEXP</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                    </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------+</span>

<span class="c1">-- regexp_like</span>
<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_like</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\Users\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                         </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_like</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\\Users\\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                         </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="c1">-- rlike</span>
<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rlike</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\Users\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">RLIKE</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>

<span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">.</span><span class="n">escapedStringLiterals</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="w">                 </span><span class="k">key</span><span class="o">|</span><span class="n">value</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>
<span class="o">|</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">parser</span><span class="p">....</span><span class="o">|</span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-----+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">rlike</span><span class="p">(</span><span class="s1">&#39;%SystemDrive%\\Users\\John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%SystemDrive%\\\\Users.*&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">RLIKE</span><span class="p">(</span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="n">SystemDrive</span><span class="o">%</span><span class="err">\\</span><span class="n">Users</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                   </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
</code></pre></div>

<h3 id="csv-functions">Csv Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>from_csv(csvStr, schema[, options])</td>
      <td>Returns a struct value with the given `csvStr` and `schema`.</td>
    </tr>
    <tr>
      <td>schema_of_csv(csv[, options])</td>
      <td>Returns schema in the DDL format of CSV string.</td>
    </tr>
    <tr>
      <td>to_csv(expr[, options])</td>
      <td>Returns a CSV string with a given struct value</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-12">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- from_csv</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;1, 0.8&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a INT, b DOUBLE&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">from_csv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">        </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="err">}</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;26/08/2015&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;time Timestamp&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;timestampFormat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">from_csv</span><span class="p">(</span><span class="mi">26</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">2015</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="err">{</span><span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">26</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- schema_of_csv</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">schema_of_csv</span><span class="p">(</span><span class="s1">&#39;1,abc&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">schema_of_csv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">abc</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">STRUCT</span><span class="o">&lt;</span><span class="n">_c0</span><span class="p">:</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- to_csv</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">to_csv</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="n">to_csv</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>
<span class="o">|</span><span class="w">                             </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">to_csv</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2015-08-26&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">)),</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;timestampFormat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">to_csv</span><span class="p">(</span><span class="n">named_struct</span><span class="p">(</span><span class="k">time</span><span class="p">,</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">dd</span><span class="p">)))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                      </span><span class="mi">26</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">2015</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------+</span>
</code></pre></div>

<h3 id="misc-functions">Misc Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>aes_decrypt(expr, key[, mode[, padding]])</td>
      <td>Returns a decrypted value of `expr` using AES in `mode` with `padding`.
      Key lengths of 16, 24 and 32 bits are supported. Supported combinations of (`mode`, `padding`) are ('ECB', 'PKCS') and ('GCM', 'NONE').
      The default mode is GCM.</td>
    </tr>
    <tr>
      <td>aes_encrypt(expr, key[, mode[, padding]])</td>
      <td>Returns an encrypted value of `expr` using AES in given `mode` with the specified `padding`.
      Key lengths of 16, 24 and 32 bits are supported. Supported combinations of (`mode`, `padding`) are ('ECB', 'PKCS') and ('GCM', 'NONE').
      The default mode is GCM.</td>
    </tr>
    <tr>
      <td>assert_true(expr)</td>
      <td>Throws an exception if `expr` is not true.</td>
    </tr>
    <tr>
      <td>current_catalog()</td>
      <td>Returns the current catalog.</td>
    </tr>
    <tr>
      <td>current_database()</td>
      <td>Returns the current database.</td>
    </tr>
    <tr>
      <td>current_user()</td>
      <td>user name of current execution context.</td>
    </tr>
    <tr>
      <td>input_file_block_length()</td>
      <td>Returns the length of the block being read, or -1 if not available.</td>
    </tr>
    <tr>
      <td>input_file_block_start()</td>
      <td>Returns the start offset of the block being read, or -1 if not available.</td>
    </tr>
    <tr>
      <td>input_file_name()</td>
      <td>Returns the name of the file being read, or empty string if not available.</td>
    </tr>
    <tr>
      <td>java_method(class, method[, arg1[, arg2 ..]])</td>
      <td>Calls a method with reflection.</td>
    </tr>
    <tr>
      <td>monotonically_increasing_id()</td>
      <td>Returns monotonically increasing 64-bit integers. The generated ID is guaranteed
      to be monotonically increasing and unique, but not consecutive. The current implementation
      puts the partition ID in the upper 31 bits, and the lower 33 bits represent the record number
      within each partition. The assumption is that the data frame has less than 1 billion
      partitions, and each partition has less than 8 billion records.
      The function is non-deterministic because its result depends on partition IDs.</td>
    </tr>
    <tr>
      <td>reflect(class, method[, arg1[, arg2 ..]])</td>
      <td>Calls a method with reflection.</td>
    </tr>
    <tr>
      <td>spark_partition_id()</td>
      <td>Returns the current partition id.</td>
    </tr>
    <tr>
      <td>typeof(expr)</td>
      <td>Return DDL-formatted type string for the data type of the input.</td>
    </tr>
    <tr>
      <td>uuid()</td>
      <td>Returns an universally unique identifier (UUID) string. The value is returned as a canonical UUID 36-character string.</td>
    </tr>
    <tr>
      <td>version()</td>
      <td>Returns the Spark version. The string contains 2 fields, the first being a release version and the second being a git revision.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-13">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- aes_decrypt</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;83F16B2AA704794132802D248E6BFD4E380078182D1544813898AC97E709B28A94&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;0000111122223333&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="mi">83</span><span class="n">F16B2AA704794132802D248E6BFD4E380078182D1544813898AC97E709B28A94</span><span class="p">),</span><span class="w"> </span><span class="mi">0000111122223333</span><span class="p">,</span><span class="w"> </span><span class="n">GCM</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                                                      </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="p">]</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="s1">&#39;6E7CA17BBB468D3084B5744BCA729FB7B2B7BCB8E4472847D02670489D95FA97DBBA7D3210&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;0000111122223333&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GCM&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="mi">6</span><span class="n">E7CA17BBB468D3084B5744BCA729FB7B2B7BCB8E4472847D02670489D95FA97DBBA7D3210</span><span class="p">),</span><span class="w"> </span><span class="mi">0000111122223333</span><span class="p">,</span><span class="w"> </span><span class="n">GCM</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                                                                          </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">2</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unbase64</span><span class="p">(</span><span class="s1">&#39;3lmwu+Mw0H3fi5NDvcu9lg==&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;1234567890abcdef&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ECB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PKCS&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">aes_decrypt</span><span class="p">(</span><span class="n">unbase64</span><span class="p">(</span><span class="mi">3</span><span class="n">lmwu</span><span class="o">+</span><span class="n">Mw0H3fi5NDvcu9lg</span><span class="o">==</span><span class="p">),</span><span class="w"> </span><span class="mi">1234567890</span><span class="n">abcdef</span><span class="p">,</span><span class="w"> </span><span class="n">ECB</span><span class="p">,</span><span class="w"> </span><span class="n">PKCS</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                        </span><span class="p">[</span><span class="mi">53</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="mi">72</span><span class="w"> </span><span class="mi">6</span><span class="n">B</span><span class="w"> </span><span class="mi">2</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------------------------------------+</span>

<span class="c1">-- aes_encrypt</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="s1">&#39;Spark&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0000111122223333&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="mi">0000111122223333</span><span class="p">,</span><span class="w"> </span><span class="n">GCM</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                   </span><span class="mi">89</span><span class="n">C9013876D99EA19</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">hex</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0000111122223333&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GCM&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">hex</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">0000111122223333</span><span class="p">,</span><span class="w"> </span><span class="n">GCM</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="mi">696</span><span class="n">FAAA46679AA847</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">base64</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1234567890abcdef&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ECB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PKCS&#39;</span><span class="p">));</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">base64</span><span class="p">(</span><span class="n">aes_encrypt</span><span class="p">(</span><span class="n">Spark</span><span class="w"> </span><span class="k">SQL</span><span class="p">,</span><span class="w"> </span><span class="mi">1234567890</span><span class="n">abcdef</span><span class="p">,</span><span class="w"> </span><span class="n">ECB</span><span class="p">,</span><span class="w"> </span><span class="n">PKCS</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="mi">3</span><span class="n">lmwu</span><span class="o">+</span><span class="n">Mw0H3fi5NDv</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>

<span class="c1">-- assert_true</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">assert_true</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">assert_true</span><span class="p">((</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;(0 &lt; 1)&#39;</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">true</span><span class="o">!</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                                        </span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>

<span class="c1">-- current_catalog</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">current_catalog</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">current_catalog</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">    </span><span class="n">spark_catalog</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- current_database</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">current_database</span><span class="p">();</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="n">current_database</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">default</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------+</span>

<span class="c1">-- current_user</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">current_user</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="k">current_user</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>
<span class="o">|</span><span class="w">      </span><span class="n">spark</span><span class="o">-</span><span class="n">rm</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------+</span>

<span class="c1">-- input_file_block_length</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">input_file_block_length</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="n">input_file_block_length</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">                       </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>

<span class="c1">-- input_file_block_start</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">input_file_block_start</span><span class="p">();</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">input_file_block_start</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>

<span class="c1">-- input_file_name</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">input_file_name</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">input_file_name</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- java_method</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">java_method</span><span class="p">(</span><span class="s1">&#39;java.util.UUID&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;randomUUID&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">java_method</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="n">randomUUID</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">144</span><span class="n">baaff</span><span class="o">-</span><span class="mi">2982</span><span class="o">-</span><span class="mi">463</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">java_method</span><span class="p">(</span><span class="s1">&#39;java.util.UUID&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;fromString&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a5cf6c42-0c85-418f-af6c-3e4e5b1328f2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">java_method</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="n">fromString</span><span class="p">,</span><span class="w"> </span><span class="n">a5cf6c42</span><span class="o">-</span><span class="mi">0</span><span class="n">c85</span><span class="o">-</span><span class="mi">418</span><span class="n">f</span><span class="o">-</span><span class="n">af6c</span><span class="o">-</span><span class="mi">3</span><span class="n">e4e5b1328f2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                         </span><span class="n">a5cf6c42</span><span class="o">-</span><span class="mi">0</span><span class="n">c85</span><span class="o">-</span><span class="mi">418</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------------------------+</span>

<span class="c1">-- monotonically_increasing_id</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">monotonically_increasing_id</span><span class="p">();</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="n">monotonically_increasing_id</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>
<span class="o">|</span><span class="w">                            </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------+</span>

<span class="c1">-- reflect</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">reflect</span><span class="p">(</span><span class="s1">&#39;java.util.UUID&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;randomUUID&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="n">reflect</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="n">randomUUID</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="w">               </span><span class="mi">74</span><span class="n">e3b558</span><span class="o">-</span><span class="n">ffe6</span><span class="o">-</span><span class="mi">4</span><span class="n">c0</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">reflect</span><span class="p">(</span><span class="s1">&#39;java.util.UUID&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;fromString&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a5cf6c42-0c85-418f-af6c-3e4e5b1328f2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">reflect</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="n">fromString</span><span class="p">,</span><span class="w"> </span><span class="n">a5cf6c42</span><span class="o">-</span><span class="mi">0</span><span class="n">c85</span><span class="o">-</span><span class="mi">418</span><span class="n">f</span><span class="o">-</span><span class="n">af6c</span><span class="o">-</span><span class="mi">3</span><span class="n">e4e5b1328f2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                     </span><span class="n">a5cf6c42</span><span class="o">-</span><span class="mi">0</span><span class="n">c85</span><span class="o">-</span><span class="mi">418</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>

<span class="c1">-- spark_partition_id</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">spark_partition_id</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">SPARK_PARTITION_ID</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- typeof</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="n">typeof</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>
<span class="o">|</span><span class="w">      </span><span class="nb">int</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="n">typeof</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------+</span>
<span class="o">|</span><span class="w">      </span><span class="nb">array</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;|</span>
<span class="o">+</span><span class="c1">----------------+</span>

<span class="c1">-- uuid</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">uuid</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">              </span><span class="n">uuid</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">52</span><span class="n">b80907</span><span class="o">-</span><span class="n">c540</span><span class="o">-</span><span class="mi">4</span><span class="n">ff</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">-- version</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">();</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">version</span><span class="p">()</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="mi">5103</span><span class="n">e00c4ce</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</code></pre></div>

<h3 id="generator-functions">Generator Functions</h3>
<table class="table">
  <thead>
    <tr>
      <th style="width:25%">Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>explode(expr)</td>
      <td>Separates the elements of array `expr` into multiple rows, or the elements of map `expr` into multiple rows and columns. Unless specified otherwise, uses the default column name `col` for elements of the array or `key` and `value` for the elements of the map.</td>
    </tr>
    <tr>
      <td>explode_outer(expr)</td>
      <td>Separates the elements of array `expr` into multiple rows, or the elements of map `expr` into multiple rows and columns. Unless specified otherwise, uses the default column name `col` for elements of the array or `key` and `value` for the elements of the map.</td>
    </tr>
    <tr>
      <td>inline(expr)</td>
      <td>Explodes an array of structs into a table. Uses column names col1, col2, etc. by default unless specified otherwise.</td>
    </tr>
    <tr>
      <td>inline_outer(expr)</td>
      <td>Explodes an array of structs into a table. Uses column names col1, col2, etc. by default unless specified otherwise.</td>
    </tr>
    <tr>
      <td>posexplode(expr)</td>
      <td>Separates the elements of array `expr` into multiple rows with positions, or the elements of map `expr` into multiple rows and columns with positions. Unless specified otherwise, uses the column name `pos` for position, `col` for elements of the array or `key` and `value` for elements of the map.</td>
    </tr>
    <tr>
      <td>posexplode_outer(expr)</td>
      <td>Separates the elements of array `expr` into multiple rows with positions, or the elements of map `expr` into multiple rows and columns with positions. Unless specified otherwise, uses the column name `pos` for position, `col` for elements of the array or `key` and `value` for elements of the map.</td>
    </tr>
    <tr>
      <td>stack(n, expr1, ..., exprk)</td>
      <td>Separates `expr1`, ..., `exprk` into `n` rows. Uses column names col0, col1, etc. by default unless specified otherwise.</td>
    </tr>
  </tbody>
</table>

<h4 id="examples-14">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">-- explode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">explode</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="c1">-- explode_outer</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">explode_outer</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="c1">-- inline</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">inline</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">struct</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="n">col1</span><span class="o">|</span><span class="n">col2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="o">|</span><span class="w">   </span><span class="n">a</span><span class="o">|</span>
<span class="o">|</span><span class="w">   </span><span class="mi">2</span><span class="o">|</span><span class="w">   </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>

<span class="c1">-- inline_outer</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">inline_outer</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">struct</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="n">col1</span><span class="o">|</span><span class="n">col2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="o">|</span><span class="w">   </span><span class="n">a</span><span class="o">|</span>
<span class="o">|</span><span class="w">   </span><span class="mi">2</span><span class="o">|</span><span class="w">   </span><span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>

<span class="c1">-- posexplode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">posexplode</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="n">pos</span><span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w"> </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>

<span class="c1">-- posexplode_outer</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">posexplode_outer</span><span class="p">(</span><span class="nb">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="n">pos</span><span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">|</span><span class="w"> </span><span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>

<span class="c1">-- stack</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">stack</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="n">col0</span><span class="o">|</span><span class="n">col1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1</span><span class="o">|</span><span class="w">   </span><span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
</code></pre></div>



                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.5.1.min.js"></script>
        <script src="js/vendor/bootstrap.bundle.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
        <script type="text/javascript">
            // DocSearch is entirely free and automated. DocSearch is built in two parts:
            // 1. a crawler which we run on our own infrastructure every 24 hours. It follows every link
            //    in your website and extract content from every page it traverses. It then pushes this
            //    content to an Algolia index.
            // 2. a JavaScript snippet to be inserted in your website that will bind this Algolia index
            //    to your search input and display its results in a dropdown UI. If you want to find more
            //    details on how works DocSearch, check the docs of DocSearch.
            docsearch({
    apiKey: 'd62f962a82bc9abb53471cb7b89da35e',
    appId: 'RAI69RXRSK',
    indexName: 'apache_spark',
    inputSelector: '#docsearch-input',
    enhancedSearchInput: true,
    algoliaOptions: {
      'facetFilters': ["version:3.3.2"]
    },
    debug: false // Set debug to true if you want to inspect the dropdown
});

        </script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
