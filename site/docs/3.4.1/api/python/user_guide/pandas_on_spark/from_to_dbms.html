
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>From/to other DBMSes &#8212; PySpark 3.4.1 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/pyspark.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="canonical" href="https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/from_to_dbms.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Best Practices" href="best_practices.html" />
    <link rel="prev" title="Type Hints in Pandas API on Spark" href="typehints.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/spark-logo-reverse.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../index.html">Overview</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">User Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../reference/index.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../development/index.html">Development</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../migration_guide/index.html">Migration Guides</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../python_packaging.html">Python Package Management</a>
                </li>
            
          
            
                <li class="">
                    <a href="../sql/index.html">Spark SQL</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="index.html">Pandas API on Spark</a>
                    <ul>
                    
                        <li class="">
                            <a href="options.html">Options and settings</a>
                        </li>
                    
                        <li class="">
                            <a href="pandas_pyspark.html">From/to pandas and PySpark DataFrames</a>
                        </li>
                    
                        <li class="">
                            <a href="transform_apply.html">Transform and apply a function</a>
                        </li>
                    
                        <li class="">
                            <a href="types.html">Type Support in Pandas API on Spark</a>
                        </li>
                    
                        <li class="">
                            <a href="typehints.html">Type Hints in Pandas API on Spark</a>
                        </li>
                    
                        <li class="active">
                            <a href="">From/to other DBMSes</a>
                        </li>
                    
                        <li class="">
                            <a href="best_practices.html">Best Practices</a>
                        </li>
                    
                        <li class="">
                            <a href="supported_pandas_api.html">Supported pandas API</a>
                        </li>
                    
                        <li class="">
                            <a href="faq.html">FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#reading-and-writing-dataframes" class="nav-link">Reading and writing DataFrames</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="from-to-other-dbmses">
<h1>From/to other DBMSes<a class="headerlink" href="#from-to-other-dbmses" title="Permalink to this headline">¶</a></h1>
<p>The APIs interacting with other DBMSes in pandas API on Spark are slightly different from the ones in pandas
because pandas API on Spark leverages JDBC APIs in PySpark to read and write from/to other DBMSes.</p>
<p>The APIs to read/write from/to external DBMSes are as follows:</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../reference/pyspark.pandas/api/pyspark.pandas.read_sql_table.html#pyspark.pandas.read_sql_table" title="pyspark.pandas.read_sql_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql_table</span></code></a>(table_name, con[, schema, …])</p></td>
<td><p>Read SQL database table into a DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../reference/pyspark.pandas/api/pyspark.pandas.read_sql_query.html#pyspark.pandas.read_sql_query" title="pyspark.pandas.read_sql_query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql_query</span></code></a>(sql, con[, index_col])</p></td>
<td><p>Read SQL query into a DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../reference/pyspark.pandas/api/pyspark.pandas.read_sql.html#pyspark.pandas.read_sql" title="pyspark.pandas.read_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql</span></code></a>(sql, con[, index_col, columns])</p></td>
<td><p>Read SQL query or database table into a DataFrame.</p></td>
</tr>
</tbody>
</table>
<p>pandas-on-Spark needs a canonical JDBC URL for <code class="docutils literal notranslate"><span class="pre">con</span></code>, and is able to take extra keyword arguments for <a class="reference external" href="https://spark.apache.org/docs/latest/sql-data-sources-jdbc.html">the options in PySpark JDBC APIs</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">dbtable</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">keytab</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="reading-and-writing-dataframes">
<h2>Reading and writing DataFrames<a class="headerlink" href="#reading-and-writing-dataframes" title="Permalink to this headline">¶</a></h2>
<p>In the example below, you will read and write a table in SQLite.</p>
<p>Firstly, create the <code class="docutils literal notranslate"><span class="pre">example</span></code> database as below via Python’s SQLite library. This will be read to pandas-on-Spark later:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="c1"># Create table</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;CREATE TABLE stocks</span>
<span class="sd">       (date text, trans text, symbol text, qty real, price real)&#39;&#39;&#39;</span><span class="p">)</span>
<span class="c1"># Insert a row of data</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO stocks VALUES (&#39;2006-01-05&#39;,&#39;BUY&#39;,&#39;RHAT&#39;,100,35.14)&quot;</span><span class="p">)</span>
<span class="c1"># Save (commit) the changes</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Pandas API on Spark requires a JDBC driver to read so it requires the driver for your particular database to be on the Spark’s classpath. For SQLite JDBC driver, you can download it, for example, as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-O<span class="w"> </span>https://repo1.maven.org/maven2/org/xerial/sqlite-jdbc/3.34.0/sqlite-jdbc-3.34.0.jar
</pre></div>
</div>
<p>After that, you should add it into your Spark session first. Once you add it, pandas API on Spark will automatically detect the Spark session and leverage it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>

<span class="p">(</span><span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span>
    <span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="s2">&quot;local&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;SQLite JDBC&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">config</span><span class="p">(</span>
        <span class="s2">&quot;spark.jars&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/sqlite-jdbc-3.34.0.jar&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
    <span class="o">.</span><span class="n">config</span><span class="p">(</span>
        <span class="s2">&quot;spark.driver.extraClassPath&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/sqlite-jdbc-3.34.0.jar&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">())</span>
</pre></div>
</div>
<p>Now, you’re ready to read the table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyspark.pandas</span> <span class="k">as</span> <span class="nn">ps</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;stocks&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="s2">&quot;jdbc:sqlite:</span><span class="si">{}</span><span class="s2">/example.db&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
<span class="n">df</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>         date trans symbol    qty  price
0  2006-01-05   BUY   RHAT  100.0  35.14
</pre></div>
</div>
<p>You can also write it back to the <code class="docutils literal notranslate"><span class="pre">stocks</span></code> table as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">price</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">df</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">to_spark_io</span><span class="p">(</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jdbc&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span>
    <span class="n">dbtable</span><span class="o">=</span><span class="s2">&quot;stocks&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s2">&quot;jdbc:sqlite:</span><span class="si">{}</span><span class="s2">/example.db&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
<span class="n">ps</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;stocks&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="s2">&quot;jdbc:sqlite:</span><span class="si">{}</span><span class="s2">/example.db&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>         date trans symbol    qty  price
0  2006-01-05   BUY   RHAT  100.0  35.14
1  2006-01-05   BUY   RHAT  100.0  36.14
</pre></div>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="typehints.html" title="previous page">Type Hints in Pandas API on Spark</a>
    <a class='right-next' id="next-link" href="best_practices.html" title="next page">Best Practices</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright .<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>