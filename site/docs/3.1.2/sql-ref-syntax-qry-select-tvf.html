
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Table-valued Functions (TVF) - Spark 3.1.2 Documentation</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <link rel="stylesheet" href="css/docsearch.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <nav class="navbar fixed-top navbar-expand-md navbar-light bg-light" id="topbar">
            <div class="container">
                <div class="navbar-header">
                    <div class="navbar-brand"><a href="index.html">
                        <img src="img/spark-logo-hd.png" style="height:50px;"/></a><span class="version">3.1.2</span>
                    </div>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarCollapse" aria-controls="navbarCollapse"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li class="nav-item"><a href="index.html" class="nav-link">Overview</a></li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarQuickStart" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming Guides</a>
                            <div class="dropdown-menu" aria-labelledby="navbarQuickStart">
                                <a class="dropdown-item" href="quick-start.html">Quick Start</a>
                                <a class="dropdown-item" href="rdd-programming-guide.html">RDDs, Accumulators, Broadcasts Vars</a>
                                <a class="dropdown-item" href="sql-programming-guide.html">SQL, DataFrames, and Datasets</a>
                                <a class="dropdown-item" href="structured-streaming-programming-guide.html">Structured Streaming</a>
                                <a class="dropdown-item" href="streaming-programming-guide.html">Spark Streaming (DStreams)</a>
                                <a class="dropdown-item" href="ml-guide.html">MLlib (Machine Learning)</a>
                                <a class="dropdown-item" href="graphx-programming-guide.html">GraphX (Graph Processing)</a>
                                <a class="dropdown-item" href="sparkr.html">SparkR (R on Spark)</a>
                                <a class="dropdown-item" href="api/python/getting_started/index.html">PySpark (Python on Spark)</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarAPIDocs" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">API Docs</a>
                            <div class="dropdown-menu" aria-labelledby="navbarAPIDocs">
                                <a class="dropdown-item" href="api/scala/org/apache/spark/index.html">Scala</a>
                                <a class="dropdown-item" href="api/java/index.html">Java</a>
                                <a class="dropdown-item" href="api/python/index.html">Python</a>
                                <a class="dropdown-item" href="api/R/index.html">R</a>
                                <a class="dropdown-item" href="api/sql/index.html">SQL, Built-in Functions</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDeploying" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Deploying</a>
                            <div class="dropdown-menu" aria-labelledby="navbarDeploying">
                                <a class="dropdown-item" href="cluster-overview.html">Overview</a>
                                <a class="dropdown-item" href="submitting-applications.html">Submitting Applications</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="spark-standalone.html">Spark Standalone</a>
                                <a class="dropdown-item" href="running-on-mesos.html">Mesos</a>
                                <a class="dropdown-item" href="running-on-yarn.html">YARN</a>
                                <a class="dropdown-item" href="running-on-kubernetes.html">Kubernetes</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarMore" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
                            <div class="dropdown-menu" aria-labelledby="navbarMore">
                                <a class="dropdown-item" href="configuration.html">Configuration</a>
                                <a class="dropdown-item" href="monitoring.html">Monitoring</a>
                                <a class="dropdown-item" href="tuning.html">Tuning Guide</a>
                                <a class="dropdown-item" href="job-scheduling.html">Job Scheduling</a>
                                <a class="dropdown-item" href="security.html">Security</a>
                                <a class="dropdown-item" href="hardware-provisioning.html">Hardware Provisioning</a>
                                <a class="dropdown-item" href="migration-guide.html">Migration Guide</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="building-spark.html">Building Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/contributing.html">Contributing to Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/third-party-projects.html">Third Party Projects</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <input type="text" id="docsearch-input" placeholder="Search the docsâ€¦">
                        </li>
                    </ul>
                    <!--<span class="navbar-text navbar-right"><span class="version-text">v3.1.2</span></span>-->
                </div>
            </div>
        </nav>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="sql-programming-guide.html">Spark SQL Guide</a></h3>
        
<ul>

    <li>
        <a href="sql-getting-started.html">
            
                Getting Started
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-data-sources.html">
            
                Data Sources
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-performance-tuning.html">
            
                Performance Tuning
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-distributed-sql-engine.html">
            
                Distributed SQL Engine
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-pyspark-pandas-with-arrow.html">
            
                PySpark Usage Guide for Pandas with Apache Arrow
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-migration-old.html">
            
                Migration Guide
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref.html">
            
                SQL Reference
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-ansi-compliance.html">
            
                ANSI Compliance
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datatypes.html">
            
                Data Types
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datetime-pattern.html">
            
                Datetime Pattern
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-functions.html">
            
                Functions
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-identifier.html">
            
                Identifiers
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-literals.html">
            
                Literals
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-null-semantics.html">
            
                Null Semantics
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax.html">
            
                SQL Syntax
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-ddl.html">
            
                Data Definition Statements
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-dml.html">
            
                Data Manipulation Statements
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry.html">
            
                Data Retrieval(Queries)
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-qry-select.html">
            
                SELECT
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-qry-select-where.html">
            
                WHERE Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-groupby.html">
            
                GROUP BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-having.html">
            
                HAVING Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-orderby.html">
            
                ORDER BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-sortby.html">
            
                SORT BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-clusterby.html">
            
                CLUSTER BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-distribute-by.html">
            
                DISTRIBUTE BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-limit.html">
            
                LIMIT Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-cte.html">
            
                Common Table Expression
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-hints.html">
            
                Hints
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-inline-table.html">
            
                Inline Table
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-file.html">
            
                File
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-join.html">
            
                JOIN
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-like.html">
            
                LIKE Predicate
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-setops.html">
            
                Set Operators
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-sampling.html">
            
                TABLESAMPLE
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-tvf.html">
            
                <b>Table-valued Function</b>
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-window.html">
            
                Window Function
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-case.html">
            
                CASE Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-lateral-view.html">
            
                LATERAL VIEW Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-pivot.html">
            
                PIVOT Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-transform.html">
            
                TRANSFORM Clause
            
        </a>
    </li>
    
    

</ul>

    

    <li>
        <a href="sql-ref-syntax-qry-explain.html">
            
                EXPLAIN
            
        </a>
    </li>
    
    

</ul>

    

    <li>
        <a href="sql-ref-syntax-aux.html">
            
                Auxiliary Statements
            
        </a>
    </li>
    
    

</ul>

    

</ul>

    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" checked type="checkbox">
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar mr-3" id="content">
                    
                        <h1 class="title">Table-valued Functions (TVF)</h1>
                    

                    <h3 id="description">Description</h3>

<p>A table-valued function (TVF) is a function that returns a relation or a set of rows. There are two types of TVFs in Spark SQL:</p>
<ol>
  <li>a TVF that can be specified in a FROM clause, e.g. range;</li>
  <li>a TVF that can be specified in SELECT/LATERAL VIEW clauses, e.g. explode.</li>
</ol>

<h3 id="supported-table-valued-functions">Supported Table-valued Functions</h3>

<h4 id="tvfs-that-can-be-specified-in-a-from-clause">TVFs that can be specified in a FROM clause:</h4>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Argument Type(s)</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>range</strong> ( <em>end</em> )</td>
      <td>Long</td>
      <td>Creates a table with a single <em>LongType</em> column named <em>id</em>, <br /> containing rows in a range from 0 to <em>end</em> (exclusive) with step value 1.</td>
    </tr>
    <tr>
      <td><strong>range</strong> ( <em>start, end</em> )</td>
      <td>Long, Long</td>
      <td>Creates a table with a single <em>LongType</em> column named <em>id</em>, <br /> containing rows in a range from <em>start</em> to <em>end</em> (exclusive) with step value 1.</td>
    </tr>
    <tr>
      <td><strong>range</strong> ( <em>start, end, step</em> )</td>
      <td>Long, Long, Long</td>
      <td>Creates a table with a single <em>LongType</em> column named <em>id</em>, <br /> containing rows in a range from <em>start</em> to <em>end</em> (exclusive) with <em>step</em> value.</td>
    </tr>
    <tr>
      <td><strong>range</strong> ( <em>start, end, step, numPartitions</em> )</td>
      <td>Long, Long, Long, Int</td>
      <td>Creates a table with a single <em>LongType</em> column named <em>id</em>, <br /> containing rows in a range from <em>start</em> to <em>end</em> (exclusive) with <em>step</em> value, with partition number <em>numPartitions</em> specified.</td>
    </tr>
  </tbody>
</table>

<h4 id="tvfs-that-can-be-specified-in-selectlateral-view-clauses">TVFs that can be specified in SELECT/LATERAL VIEW clauses:</h4>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Argument Type(s)</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>explode</strong> ( <em>expr</em> )</td>
      <td>Array/Map</td>
      <td>Separates the elements of array <em>expr</em> into multiple rows, or the elements of map <em>expr</em> into multiple rows and columns. Unless specified otherwise, uses the default column name col for elements of the array or key and value for the elements of the map.</td>
    </tr>
    <tr>
      <td><strong>explode_outer</strong> <br /> ( <em>expr</em> )</td>
      <td>Array/Map</td>
      <td>Separates the elements of array <em>expr</em> into multiple rows, or the elements of map <em>expr</em> into multiple rows and columns. Unless specified otherwise, uses the default column name col for elements of the array or key and value for the elements of the map.</td>
    </tr>
    <tr>
      <td><strong>inline</strong> ( <em>expr</em> )</td>
      <td>Expression</td>
      <td>Explodes an array of structs into a table. Uses column names col1, col2, etc. by default unless specified otherwise.</td>
    </tr>
    <tr>
      <td><strong>inline_outer</strong> <br /> ( <em>expr</em> )</td>
      <td>Expression</td>
      <td>Explodes an array of structs into a table. Uses column names col1, col2, etc. by default unless specified otherwise.</td>
    </tr>
    <tr>
      <td><strong>posexplode</strong> <br /> ( <em>expr</em> )</td>
      <td>Array/Map</td>
      <td>Separates the elements of array <em>expr</em> into multiple rows with positions, or the elements of map <em>expr</em> into multiple rows and columns with positions. Unless specified otherwise, uses the column name pos for position, col for elements of the array or key and value for elements of the map.</td>
    </tr>
    <tr>
      <td><strong>posexplode_outer</strong> ( <em>expr</em> )</td>
      <td>Array/Map</td>
      <td>Separates the elements of array <em>expr</em> into multiple rows with positions, or the elements of map <em>expr</em> into multiple rows and columns with positions. Unless specified otherwise, uses the column name pos for position, col for elements of the array or key and value for elements of the map.</td>
    </tr>
    <tr>
      <td><strong>stack</strong> ( <em>n, expr1, &#8230;, exprk</em> )</td>
      <td>Seq[Expression]</td>
      <td>Separates <em>expr1, &#8230;, exprk</em> into n rows. Uses column names col0, col1, etc. by default unless specified otherwise.</td>
    </tr>
    <tr>
      <td><strong>json_tuple</strong> <br /> ( <em>jsonStr, p1, p2, &#8230;, pn</em> )</td>
      <td>Seq[Expression]</td>
      <td>Returns a tuple like the function <em>get_json_object</em>, but it takes multiple names. All the input parameters and output column types are string.</td>
    </tr>
    <tr>
      <td><strong>parse_url</strong> <br /> ( <em>url, partToExtract[, key]</em> )</td>
      <td>Seq[Expression]</td>
      <td>Extracts a part from a URL.</td>
    </tr>
  </tbody>
</table>

<h3 id="examples">Examples</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- range call with end</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">range</span><span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="c1">-- range call with start and end</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">9</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="c1">-- range call with numPartitions</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="c1">-- range call with a table alias</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="k">AS</span> <span class="n">test</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="k">SELECT</span> <span class="n">explode</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>
<span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+</span>

<span class="k">SELECT</span> <span class="n">inline</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">),</span> <span class="n">struct</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">)));</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="n">col1</span><span class="o">|</span><span class="n">col2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span>   <span class="mi">1</span><span class="o">|</span>   <span class="n">a</span><span class="o">|</span>
<span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>   <span class="n">b</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>

<span class="k">SELECT</span> <span class="n">posexplode</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">));</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span><span class="n">pos</span><span class="o">|</span><span class="n">col</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span>  <span class="mi">0</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>

<span class="k">SELECT</span> <span class="n">stack</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span><span class="n">col0</span><span class="o">|</span><span class="n">col1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>
<span class="o">|</span>   <span class="mi">1</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>
<span class="o">|</span>   <span class="mi">3</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----+----+</span>

<span class="k">SELECT</span> <span class="n">json_tuple</span><span class="p">(</span><span class="s1">'{"a":1, "b":2}'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">);</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span> <span class="n">c0</span><span class="o">|</span> <span class="n">c1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>
<span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+</span>

<span class="k">SELECT</span> <span class="n">parse_url</span><span class="p">(</span><span class="s1">'http://spark.apache.org/path?query=1'</span><span class="p">,</span> <span class="s1">'HOST'</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="k">HOST</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span>                                     <span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="c1">-- Use explode in a LATERAL VIEW clause</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">test</span> <span class="p">(</span><span class="n">c1</span> <span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">test</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">test</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">test</span> <span class="k">LATERAL</span> <span class="k">VIEW</span> <span class="n">explode</span> <span class="p">(</span><span class="n">ARRAY</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="k">AS</span> <span class="n">c2</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--+--+</span>
<span class="o">|</span><span class="n">c1</span><span class="o">|</span><span class="n">c2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--+--+</span>
<span class="o">|</span> <span class="mi">1</span><span class="o">|</span> <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span><span class="o">|</span> <span class="mi">4</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span><span class="o">|</span> <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span><span class="o">|</span> <span class="mi">4</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--+--+</span>
</code></pre></div></div>

<h3 id="related-statements">Related Statements</h3>

<ul>
  <li><a href="sql-ref-syntax-qry-select.html">SELECT</a></li>
  <li><a href="sql-ref-syntax-qry-select-lateral-view.html">LATERAL VIEW Clause</a></li>
</ul>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.5.1.min.js"></script>
        <script src="js/vendor/bootstrap.bundle.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
        <script type="text/javascript">
            // DocSearch is entirely free and automated. DocSearch is built in two parts:
            // 1. a crawler which we run on our own infrastructure every 24 hours. It follows every link
            //    in your website and extract content from every page it traverses. It then pushes this
            //    content to an Algolia index.
            // 2. a JavaScript snippet to be inserted in your website that will bind this Algolia index
            //    to your search input and display its results in a dropdown UI. If you want to find more
            //    details on how works DocSearch, check the docs of DocSearch.
            docsearch({
    apiKey: 'b18ca3732c502995563043aa17bc6ecb',
    indexName: 'apache_spark',
    inputSelector: '#docsearch-input',
    enhancedSearchInput: true,
    algoliaOptions: {
      'facetFilters': ["version:3.1.2"]
    },
    debug: false // Set debug to true if you want to inspect the dropdown
});

        </script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
