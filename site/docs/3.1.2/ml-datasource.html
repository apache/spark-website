
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Data sources - Spark 3.1.2 Documentation</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <link rel="stylesheet" href="css/docsearch.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <nav class="navbar fixed-top navbar-expand-md navbar-light bg-light" id="topbar">
            <div class="container">
                <div class="navbar-header">
                    <div class="navbar-brand"><a href="index.html">
                        <img src="img/spark-logo-hd.png" style="height:50px;"/></a><span class="version">3.1.2</span>
                    </div>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarCollapse" aria-controls="navbarCollapse"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li class="nav-item"><a href="index.html" class="nav-link">Overview</a></li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarQuickStart" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming Guides</a>
                            <div class="dropdown-menu" aria-labelledby="navbarQuickStart">
                                <a class="dropdown-item" href="quick-start.html">Quick Start</a>
                                <a class="dropdown-item" href="rdd-programming-guide.html">RDDs, Accumulators, Broadcasts Vars</a>
                                <a class="dropdown-item" href="sql-programming-guide.html">SQL, DataFrames, and Datasets</a>
                                <a class="dropdown-item" href="structured-streaming-programming-guide.html">Structured Streaming</a>
                                <a class="dropdown-item" href="streaming-programming-guide.html">Spark Streaming (DStreams)</a>
                                <a class="dropdown-item" href="ml-guide.html">MLlib (Machine Learning)</a>
                                <a class="dropdown-item" href="graphx-programming-guide.html">GraphX (Graph Processing)</a>
                                <a class="dropdown-item" href="sparkr.html">SparkR (R on Spark)</a>
                                <a class="dropdown-item" href="api/python/getting_started/index.html">PySpark (Python on Spark)</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarAPIDocs" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">API Docs</a>
                            <div class="dropdown-menu" aria-labelledby="navbarAPIDocs">
                                <a class="dropdown-item" href="api/scala/org/apache/spark/index.html">Scala</a>
                                <a class="dropdown-item" href="api/java/index.html">Java</a>
                                <a class="dropdown-item" href="api/python/index.html">Python</a>
                                <a class="dropdown-item" href="api/R/index.html">R</a>
                                <a class="dropdown-item" href="api/sql/index.html">SQL, Built-in Functions</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDeploying" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Deploying</a>
                            <div class="dropdown-menu" aria-labelledby="navbarDeploying">
                                <a class="dropdown-item" href="cluster-overview.html">Overview</a>
                                <a class="dropdown-item" href="submitting-applications.html">Submitting Applications</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="spark-standalone.html">Spark Standalone</a>
                                <a class="dropdown-item" href="running-on-mesos.html">Mesos</a>
                                <a class="dropdown-item" href="running-on-yarn.html">YARN</a>
                                <a class="dropdown-item" href="running-on-kubernetes.html">Kubernetes</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarMore" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
                            <div class="dropdown-menu" aria-labelledby="navbarMore">
                                <a class="dropdown-item" href="configuration.html">Configuration</a>
                                <a class="dropdown-item" href="monitoring.html">Monitoring</a>
                                <a class="dropdown-item" href="tuning.html">Tuning Guide</a>
                                <a class="dropdown-item" href="job-scheduling.html">Job Scheduling</a>
                                <a class="dropdown-item" href="security.html">Security</a>
                                <a class="dropdown-item" href="hardware-provisioning.html">Hardware Provisioning</a>
                                <a class="dropdown-item" href="migration-guide.html">Migration Guide</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="building-spark.html">Building Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/contributing.html">Contributing to Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/third-party-projects.html">Third Party Projects</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <input type="text" id="docsearch-input" placeholder="Search the docsâ€¦">
                        </li>
                    </ul>
                    <!--<span class="navbar-text navbar-right"><span class="version-text">v3.1.2</span></span>-->
                </div>
            </div>
        </nav>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="ml-guide.html">MLlib: Main Guide</a></h3>
        
<ul>

    <li>
        <a href="ml-statistics.html">
            
                Basic statistics
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-datasource.html">
            
                <b>Data sources</b>
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-pipeline.html">
            
                Pipelines
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-features.html">
            
                Extracting, transforming and selecting features
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-classification-regression.html">
            
                Classification and Regression
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-clustering.html">
            
                Clustering
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-collaborative-filtering.html">
            
                Collaborative filtering
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-frequent-pattern-mining.html">
            
                Frequent Pattern Mining
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-tuning.html">
            
                Model selection and tuning
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-advanced.html">
            
                Advanced topics
            
        </a>
    </li>
    
    

</ul>

        <h3><a href="mllib-guide.html">MLlib: RDD-based API Guide</a></h3>
        
<ul>

    <li>
        <a href="mllib-data-types.html">
            
                Data types
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-statistics.html">
            
                Basic statistics
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-classification-regression.html">
            
                Classification and regression
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-collaborative-filtering.html">
            
                Collaborative filtering
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-clustering.html">
            
                Clustering
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-dimensionality-reduction.html">
            
                Dimensionality reduction
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-feature-extraction.html">
            
                Feature extraction and transformation
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-frequent-pattern-mining.html">
            
                Frequent pattern mining
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-evaluation-metrics.html">
            
                Evaluation metrics
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-pmml-model-export.html">
            
                PMML model export
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-optimization.html">
            
                Optimization (developer)
            
        </a>
    </li>
    
    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" checked type="checkbox">
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar mr-3" id="content">
                    
                        <h1 class="title">Data sources</h1>
                    

                    <p>In this section, we introduce how to use data source in ML to load data.
Besides some general data sources such as Parquet, CSV, JSON and JDBC, we also provide some specific data sources for ML.</p>

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#image-data-source" id="markdown-toc-image-data-source">Image data source</a></li>
  <li><a href="#libsvm-data-source" id="markdown-toc-libsvm-data-source">LIBSVM data source</a></li>
</ul>

<h2 id="image-data-source">Image data source</h2>

<p>This image data source is used to load image files from a directory, it can load compressed image (jpeg, png, etc.) into raw image representation via <code class="language-plaintext highlighter-rouge">ImageIO</code> in Java library.
The loaded DataFrame has one <code class="language-plaintext highlighter-rouge">StructType</code> column: &#8220;image&#8221;, containing image data stored as image schema.
The schema of the <code class="language-plaintext highlighter-rouge">image</code> column is:</p>
<ul>
  <li>origin: <code class="language-plaintext highlighter-rouge">StringType</code> (represents the file path of the image)</li>
  <li>height: <code class="language-plaintext highlighter-rouge">IntegerType</code> (height of the image)</li>
  <li>width: <code class="language-plaintext highlighter-rouge">IntegerType</code> (width of the image)</li>
  <li>nChannels: <code class="language-plaintext highlighter-rouge">IntegerType</code> (number of image channels)</li>
  <li>mode: <code class="language-plaintext highlighter-rouge">IntegerType</code> (OpenCV-compatible type)</li>
  <li>data: <code class="language-plaintext highlighter-rouge">BinaryType</code> (Image bytes in OpenCV-compatible order: row-wise BGR in most cases)</li>
</ul>

<div class="codetabs">
<div data-lang="scala">
    <p><a href="api/scala/org/apache/spark/ml/source/image/ImageDataSource.html"><code class="language-plaintext highlighter-rouge">ImageDataSource</code></a>
implements a Spark SQL data source API for loading image data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">df</span> <span class="k">=</span> <span class="nv">spark</span><span class="o">.</span><span class="py">read</span><span class="o">.</span><span class="py">format</span><span class="o">(</span><span class="s">"image"</span><span class="o">).</span><span class="py">option</span><span class="o">(</span><span class="s">"dropInvalid"</span><span class="o">,</span> <span class="kc">true</span><span class="o">).</span><span class="py">load</span><span class="o">(</span><span class="s">"data/mllib/images/origin/kittens"</span><span class="o">)</span>
<span class="n">df</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.DataFrame</span> <span class="o">=</span> <span class="o">[</span><span class="kt">image:</span> <span class="kt">struct&lt;origin:</span> <span class="kt">string</span>, <span class="kt">height:</span> <span class="kt">int</span> <span class="kt">...</span> <span class="err">4</span> <span class="kt">more</span> <span class="kt">fields&gt;</span><span class="o">]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">df</span><span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="s">"image.origin"</span><span class="o">,</span> <span class="s">"image.width"</span><span class="o">,</span> <span class="s">"image.height"</span><span class="o">).</span><span class="py">show</span><span class="o">(</span><span class="n">truncate</span><span class="k">=</span><span class="kc">false</span><span class="o">)</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span>
<span class="o">|</span><span class="n">origin</span>                                                                 <span class="o">|</span><span class="n">width</span><span class="o">|</span><span class="n">height</span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span>
<span class="o">|</span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="mf">54893.</span><span class="n">jpg</span>               <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">311</span>   <span class="o">|</span>
<span class="o">|</span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="nv">DP802813</span><span class="o">.</span><span class="py">jpg</span>            <span class="o">|</span><span class="mi">199</span>  <span class="o">|</span><span class="mi">313</span>   <span class="o">|</span>
<span class="o">|</span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="mf">29.5</span><span class="o">.</span><span class="py">a_b_EGDP022204</span><span class="o">.</span><span class="py">jpg</span> <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">200</span>   <span class="o">|</span>
<span class="o">|</span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="nv">DP153539</span><span class="o">.</span><span class="py">jpg</span>            <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">296</span>   <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span></code></pre></figure>

  </div>

<div data-lang="java">
    <p><a href="api/java/org/apache/spark/ml/source/image/ImageDataSource.html"><code class="language-plaintext highlighter-rouge">ImageDataSource</code></a>
implements Spark SQL data source API for loading image data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Dataset</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="n">imagesDF</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="na">read</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="s">"image"</span><span class="o">).</span><span class="na">option</span><span class="o">(</span><span class="s">"dropInvalid"</span><span class="o">,</span> <span class="kc">true</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="s">"data/mllib/images/origin/kittens"</span><span class="o">);</span>
<span class="n">imageDF</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">"image.origin"</span><span class="o">,</span> <span class="s">"image.width"</span><span class="o">,</span> <span class="s">"image.height"</span><span class="o">).</span><span class="na">show</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="cm">/*
Will output:
+-----------------------------------------------------------------------+-----+------+
|origin                                                                 |width|height|
+-----------------------------------------------------------------------+-----+------+
|file:///spark/data/mllib/images/origin/kittens/54893.jpg               |300  |311   |
|file:///spark/data/mllib/images/origin/kittens/DP802813.jpg            |199  |313   |
|file:///spark/data/mllib/images/origin/kittens/29.5.a_b_EGDP022204.jpg |300  |200   |
|file:///spark/data/mllib/images/origin/kittens/DP153539.jpg            |300  |296   |
+-----------------------------------------------------------------------+-----+------+
*/</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p>In PySpark we provide Spark SQL data source API for loading image data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="s">"image"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"dropInvalid"</span><span class="p">,</span> <span class="bp">True</span><span class="p">).</span><span class="n">load</span><span class="p">(</span><span class="s">"data/mllib/images/origin/kittens"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">"image.origin"</span><span class="p">,</span> <span class="s">"image.width"</span><span class="p">,</span> <span class="s">"image.height"</span><span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span>
<span class="o">|</span><span class="n">origin</span>                                                                 <span class="o">|</span><span class="n">width</span><span class="o">|</span><span class="n">height</span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span>
<span class="o">|</span><span class="nb">file</span><span class="p">:</span><span class="o">///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="mf">54893.j</span><span class="n">pg</span>               <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">311</span>   <span class="o">|</span>
<span class="o">|</span><span class="nb">file</span><span class="p">:</span><span class="o">///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="n">DP802813</span><span class="p">.</span><span class="n">jpg</span>            <span class="o">|</span><span class="mi">199</span>  <span class="o">|</span><span class="mi">313</span>   <span class="o">|</span>
<span class="o">|</span><span class="nb">file</span><span class="p">:</span><span class="o">///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="mf">29.5</span><span class="p">.</span><span class="n">a_b_EGDP022204</span><span class="p">.</span><span class="n">jpg</span> <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">200</span>   <span class="o">|</span>
<span class="o">|</span><span class="nb">file</span><span class="p">:</span><span class="o">///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="n">DP153539</span><span class="p">.</span><span class="n">jpg</span>            <span class="o">|</span><span class="mi">300</span>  <span class="o">|</span><span class="mi">296</span>   <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+-----+------+</span></code></pre></figure>

  </div>

<div data-lang="r">
    <p>In SparkR we provide Spark SQL data source API for loading image data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.df</span><span class="p">(</span><span class="s2">"data/mllib/images/origin/kittens"</span><span class="p">,</span><span class="w"> </span><span class="s2">"image"</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">image.origin</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">image.width</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">image.height</span><span class="p">))</span><span class="w">

</span><span class="m">1</span><span class="w">               </span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="m">54893</span><span class="n">.jpg</span><span class="w">
</span><span class="m">2</span><span class="w">            </span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="n">DP802813.jpg</span><span class="w">
</span><span class="m">3</span><span class="w"> </span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="m">29.5</span><span class="n">.a_b_EGDP022204.jpg</span><span class="w">
</span><span class="m">4</span><span class="w">            </span><span class="n">file</span><span class="o">:///</span><span class="n">spark</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">mllib</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">origin</span><span class="o">/</span><span class="n">kittens</span><span class="o">/</span><span class="n">DP153539.jpg</span><span class="w">
  </span><span class="n">width</span><span class="w"> </span><span class="n">height</span><span class="w">
</span><span class="m">1</span><span class="w">   </span><span class="m">300</span><span class="w">    </span><span class="m">311</span><span class="w">
</span><span class="m">2</span><span class="w">   </span><span class="m">199</span><span class="w">    </span><span class="m">313</span><span class="w">
</span><span class="m">3</span><span class="w">   </span><span class="m">300</span><span class="w">    </span><span class="m">200</span><span class="w">
</span><span class="m">4</span><span class="w">   </span><span class="m">300</span><span class="w">    </span><span class="m">296</span></code></pre></figure>

  </div>


</div>

<h2 id="libsvm-data-source">LIBSVM data source</h2>

<p>This <code class="language-plaintext highlighter-rouge">LIBSVM</code> data source is used to load &#8216;libsvm&#8217; type files from a directory.
The loaded DataFrame has two columns: label containing labels stored as doubles and features containing feature vectors stored as Vectors.
The schemas of the columns are:</p>
<ul>
  <li>label: <code class="language-plaintext highlighter-rouge">DoubleType</code> (represents the instance label)</li>
  <li>features: <code class="language-plaintext highlighter-rouge">VectorUDT</code> (represents the feature vector)</li>
</ul>

<div class="codetabs">
<div data-lang="scala">
    <p><a href="api/scala/org/apache/spark/ml/source/libsvm/LibSVMDataSource.html"><code class="language-plaintext highlighter-rouge">LibSVMDataSource</code></a>
implements a Spark SQL data source API for loading <code class="language-plaintext highlighter-rouge">LIBSVM</code> data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nv">df</span> <span class="k">=</span> <span class="nv">spark</span><span class="o">.</span><span class="py">read</span><span class="o">.</span><span class="py">format</span><span class="o">(</span><span class="s">"libsvm"</span><span class="o">).</span><span class="py">option</span><span class="o">(</span><span class="s">"numFeatures"</span><span class="o">,</span> <span class="s">"780"</span><span class="o">).</span><span class="py">load</span><span class="o">(</span><span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="o">)</span>
<span class="n">df</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.DataFrame</span> <span class="o">=</span> <span class="o">[</span><span class="kt">label:</span> <span class="kt">double</span>, <span class="kt">features:</span> <span class="kt">vector</span><span class="o">]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nv">df</span><span class="o">.</span><span class="py">show</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="o">+-----+--------------------+</span>
<span class="o">|</span><span class="n">label</span><span class="o">|</span>            <span class="n">features</span><span class="o">|</span>
<span class="o">+-----+--------------------+</span>
<span class="o">|</span>  <span class="mf">0.0</span><span class="o">|(</span><span class="mi">780</span><span class="o">,[</span><span class="err">127</span>,<span class="err">128</span>,<span class="err">129</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">158</span>,<span class="err">159</span>,<span class="err">160</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">124</span>,<span class="err">125</span>,<span class="err">126</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">152</span>,<span class="err">153</span>,<span class="err">154</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">151</span>,<span class="err">152</span>,<span class="err">153</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">0</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">129</span>,<span class="err">130</span>,<span class="err">131</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">158</span>,<span class="err">159</span>,<span class="err">160</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">99</span>,<span class="err">100</span>,<span class="err">101</span>,<span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">0</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">154</span>,<span class="err">155</span>,<span class="err">156</span><span class="kt">...|</span>
<span class="kt">|</span>  <span class="err">0</span><span class="kt">.</span><span class="err">0</span><span class="kt">|</span><span class="o">(</span><span class="err">780</span>,<span class="o">[</span><span class="err">127</span>,<span class="err">128</span>,<span class="err">129</span><span class="kt">...|</span>
<span class="kt">+-----+--------------------+</span>
<span class="kt">only</span> <span class="kt">showing</span> <span class="kt">top</span> <span class="err">10</span> <span class="kt">rows</span></code></pre></figure>

  </div>

<div data-lang="java">
    <p><a href="api/java/org/apache/spark/ml/source/libsvm/LibSVMDataSource.html"><code class="language-plaintext highlighter-rouge">LibSVMDataSource</code></a>
implements Spark SQL data source API for loading <code class="language-plaintext highlighter-rouge">LIBSVM</code> data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Dataset</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="na">read</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"libsvm"</span><span class="o">).</span><span class="na">option</span><span class="o">(</span><span class="s">"numFeatures"</span><span class="o">,</span> <span class="s">"780"</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="o">);</span>
<span class="n">df</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
<span class="cm">/*
Will output:
+-----+--------------------+
|label|            features|
+-----+--------------------+
|  0.0|(780,[127,128,129...|
|  1.0|(780,[158,159,160...|
|  1.0|(780,[124,125,126...|
|  1.0|(780,[152,153,154...|
|  1.0|(780,[151,152,153...|
|  0.0|(780,[129,130,131...|
|  1.0|(780,[158,159,160...|
|  1.0|(780,[99,100,101,...|
|  0.0|(780,[154,155,156...|
|  0.0|(780,[127,128,129...|
+-----+--------------------+
only showing top 10 rows
*/</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p>In PySpark we provide Spark SQL data source API for loading <code class="language-plaintext highlighter-rouge">LIBSVM</code> data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="s">"libsvm"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"numFeatures"</span><span class="p">,</span> <span class="s">"780"</span><span class="p">).</span><span class="n">load</span><span class="p">(</span><span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">+-----+--------------------+</span>
<span class="o">|</span><span class="n">label</span><span class="o">|</span>            <span class="n">features</span><span class="o">|</span>
<span class="o">+-----+--------------------+</span>
<span class="o">|</span>  <span class="mf">0.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">127</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mf">129.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">158</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mf">160.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">124</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mf">126.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">152</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mf">154.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">151</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mf">153.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">0.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">129</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mf">131.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">158</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mf">160.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">1.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">101</span><span class="p">,...</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">0.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">154</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mf">156.</span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span>  <span class="mf">0.0</span><span class="o">|</span><span class="p">(</span><span class="mi">780</span><span class="p">,[</span><span class="mi">127</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mf">129.</span><span class="p">..</span><span class="o">|</span>
<span class="o">+-----+--------------------+</span>
<span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">10</span> <span class="n">rows</span></code></pre></figure>

  </div>

<div data-lang="r">
    <p>In SparkR we provide Spark SQL data source API for loading <code class="language-plaintext highlighter-rouge">LIBSVM</code> data as a DataFrame.</p>

    <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.df</span><span class="p">(</span><span class="s2">"data/mllib/sample_libsvm_data.txt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"libsvm"</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">features</span><span class="p">),</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">

   </span><span class="n">label</span><span class="w">                      </span><span class="n">features</span><span class="w">
</span><span class="m">1</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d35366e8</span><span class="o">&gt;</span><span class="w">
</span><span class="m">2</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d353bf78</span><span class="o">&gt;</span><span class="w">
</span><span class="m">3</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d3541840</span><span class="o">&gt;</span><span class="w">
</span><span class="m">4</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d3545108</span><span class="o">&gt;</span><span class="w">
</span><span class="m">5</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d354c8e0</span><span class="o">&gt;</span><span class="w">
</span><span class="m">6</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d35501a8</span><span class="o">&gt;</span><span class="w">
</span><span class="m">7</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d3555a70</span><span class="o">&gt;</span><span class="w">
</span><span class="m">8</span><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d3559338</span><span class="o">&gt;</span><span class="w">
</span><span class="m">9</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d355cc00</span><span class="o">&gt;</span><span class="w">
</span><span class="m">10</span><span class="w">     </span><span class="m">0</span><span class="w"> </span><span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="mh">0x7fe6d35643d8</span><span class="o">&gt;</span></code></pre></figure>

  </div>


</div>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.5.1.min.js"></script>
        <script src="js/vendor/bootstrap.bundle.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
        <script type="text/javascript">
            // DocSearch is entirely free and automated. DocSearch is built in two parts:
            // 1. a crawler which we run on our own infrastructure every 24 hours. It follows every link
            //    in your website and extract content from every page it traverses. It then pushes this
            //    content to an Algolia index.
            // 2. a JavaScript snippet to be inserted in your website that will bind this Algolia index
            //    to your search input and display its results in a dropdown UI. If you want to find more
            //    details on how works DocSearch, check the docs of DocSearch.
            docsearch({
    apiKey: 'b18ca3732c502995563043aa17bc6ecb',
    indexName: 'apache_spark',
    inputSelector: '#docsearch-input',
    enhancedSearchInput: true,
    algoliaOptions: {
      'facetFilters': ["version:3.1.2"]
    },
    debug: false // Set debug to true if you want to inspect the dropdown
});

        </script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
