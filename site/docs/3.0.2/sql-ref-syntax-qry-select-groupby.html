
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>GROUP BY Clause - Spark 3.0.2 Documentation</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top" id="topbar">
            <div class="navbar-inner">
                <div class="container">
                    <div class="brand"><a href="index.html">
                      <img src="img/spark-logo-hd.png" style="height:50px;"/></a><span class="version">3.0.2</span>
                    </div>
                    <ul class="nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li><a href="index.html">Overview</a></li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Programming Guides<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="quick-start.html">Quick Start</a></li>
                                <li><a href="rdd-programming-guide.html">RDDs, Accumulators, Broadcasts Vars</a></li>
                                <li><a href="sql-programming-guide.html">SQL, DataFrames, and Datasets</a></li>
                                <li><a href="structured-streaming-programming-guide.html">Structured Streaming</a></li>
                                <li><a href="streaming-programming-guide.html">Spark Streaming (DStreams)</a></li>
                                <li><a href="ml-guide.html">MLlib (Machine Learning)</a></li>
                                <li><a href="graphx-programming-guide.html">GraphX (Graph Processing)</a></li>
                                <li><a href="sparkr.html">SparkR (R on Spark)</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="api/scala/org/apache/spark/index.html">Scala</a></li>
                                <li><a href="api/java/index.html">Java</a></li>
                                <li><a href="api/python/index.html">Python</a></li>
                                <li><a href="api/R/index.html">R</a></li>
                                <li><a href="api/sql/index.html">SQL, Built-in Functions</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Deploying<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="cluster-overview.html">Overview</a></li>
                                <li><a href="submitting-applications.html">Submitting Applications</a></li>
                                <li class="divider"></li>
                                <li><a href="spark-standalone.html">Spark Standalone</a></li>
                                <li><a href="running-on-mesos.html">Mesos</a></li>
                                <li><a href="running-on-yarn.html">YARN</a></li>
                                <li><a href="running-on-kubernetes.html">Kubernetes</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="api.html" class="dropdown-toggle" data-toggle="dropdown">More<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="configuration.html">Configuration</a></li>
                                <li><a href="monitoring.html">Monitoring</a></li>
                                <li><a href="tuning.html">Tuning Guide</a></li>
                                <li><a href="job-scheduling.html">Job Scheduling</a></li>
                                <li><a href="security.html">Security</a></li>
                                <li><a href="hardware-provisioning.html">Hardware Provisioning</a></li>
                                <li><a href="migration-guide.html">Migration Guide</a></li>
                                <li class="divider"></li>
                                <li><a href="building-spark.html">Building Spark</a></li>
                                <li><a href="https://spark.apache.org/contributing.html">Contributing to Spark</a></li>
                                <li><a href="https://spark.apache.org/third-party-projects.html">Third Party Projects</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--<p class="navbar-text pull-right"><span class="version-text">v3.0.2</span></p>-->
                </div>
            </div>
        </div>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="sql-programming-guide.html">Spark SQL Guide</a></h3>
        
<ul>

    <li>
        <a href="sql-getting-started.html">
            
                Getting Started
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-data-sources.html">
            
                Data Sources
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-performance-tuning.html">
            
                Performance Tuning
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-distributed-sql-engine.html">
            
                Distributed SQL Engine
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-pyspark-pandas-with-arrow.html">
            
                PySpark Usage Guide for Pandas with Apache Arrow
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-migration-old.html">
            
                Migration Guide
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref.html">
            
                SQL Reference
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-ansi-compliance.html">
            
                ANSI Compliance
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datatypes.html">
            
                Data Types
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-datetime-pattern.html">
            
                Datetime Pattern
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-functions.html">
            
                Functions
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-identifier.html">
            
                Identifiers
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-literals.html">
            
                Literals
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-null-semantics.html">
            
                Null Semantics
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax.html">
            
                SQL Syntax
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-ddl.html">
            
                Data Definition Statements
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-dml.html">
            
                Data Manipulation Statements
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry.html">
            
                Data Retrieval(Queries)
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-qry-select.html">
            
                SELECT
            
        </a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-syntax-qry-select-where.html">
            
                WHERE Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-groupby.html">
            
                <b>GROUP BY Clause</b>
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-having.html">
            
                HAVING Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-orderby.html">
            
                ORDER BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-sortby.html">
            
                SORT BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-clusterby.html">
            
                CLUSTER BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-distribute-by.html">
            
                DISTRIBUTE BY Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-limit.html">
            
                LIMIT Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-cte.html">
            
                Common Table Expression
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-hints.html">
            
                Hints
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-inline-table.html">
            
                Inline Table
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-file.html">
            
                File
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-join.html">
            
                JOIN
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-like.html">
            
                LIKE Predicate
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-setops.html">
            
                Set Operators
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-sampling.html">
            
                TABLESAMPLE
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-tvf.html">
            
                Table-valued Function
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-window.html">
            
                Window Function
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-case.html">
            
                CASE Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-lateral-view.html">
            
                LATERAL VIEW Clause
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax-qry-select-pivot.html">
            
                PIVOT Clause
            
        </a>
    </li>
    
    

</ul>

    

    <li>
        <a href="sql-ref-syntax-qry-explain.html">
            
                EXPLAIN
            
        </a>
    </li>
    
    

</ul>

    

    <li>
        <a href="sql-ref-syntax-aux.html">
            
                Auxiliary Statements
            
        </a>
    </li>
    
    

</ul>

    

</ul>

    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" checked type="checkbox">
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar" id="content">
                    
                        <h1 class="title">GROUP BY Clause</h1>
                    

                    <h3 id="description">Description</h3>

<p>The <code class="highlighter-rouge">GROUP BY</code> clause is used to group the rows based on a set of specified grouping expressions and compute aggregations on
the group of rows based on one or more specified aggregate functions. Spark also supports advanced aggregations to do multiple
aggregations for the same input record set via <code class="highlighter-rouge">GROUPING SETS</code>, <code class="highlighter-rouge">CUBE</code>, <code class="highlighter-rouge">ROLLUP</code> clauses.
When a FILTER clause is attached to an aggregate function, only the matching rows are passed to that function.</p>

<h3 id="syntax">Syntax</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">group_expression</span> <span class="p">[</span> <span class="p">,</span> <span class="n">group_expression</span> <span class="p">[</span> <span class="p">,</span> <span class="p">...</span> <span class="p">]</span> <span class="p">]</span>
    <span class="p">[</span> <span class="err">{</span> <span class="k">WITH</span> <span class="k">ROLLUP</span> <span class="o">|</span> <span class="k">WITH</span> <span class="k">CUBE</span> <span class="o">|</span> <span class="k">GROUPING</span> <span class="k">SETS</span> <span class="p">(</span><span class="n">grouping_set</span> <span class="p">[</span> <span class="p">,</span> <span class="p">...])</span> <span class="err">}</span> <span class="p">]</span>

<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">GROUPING</span> <span class="k">SETS</span> <span class="p">(</span><span class="n">grouping_set</span> <span class="p">[</span> <span class="p">,</span> <span class="p">...])</span>
</code></pre></div></div>

<p>While aggregate functions are defined as</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">aggregate_name</span> <span class="p">(</span> <span class="p">[</span> <span class="k">DISTINCT</span> <span class="p">]</span> <span class="n">expression</span> <span class="p">[</span> <span class="p">,</span> <span class="p">...</span> <span class="p">]</span> <span class="p">)</span> <span class="p">[</span> <span class="n">FILTER</span> <span class="p">(</span> <span class="k">WHERE</span> <span class="n">boolean_expression</span> <span class="p">)</span> <span class="p">]</span>
</code></pre></div></div>

<h3 id="parameters">Parameters</h3>

<ul>
  <li>
    <p><strong>GROUPING SETS</strong></p>

    <p>Groups the rows for each subset of the expressions specified in the grouping sets. For example,
  <code class="highlighter-rouge">GROUP BY GROUPING SETS (warehouse, product)</code> is semantically equivalent
  to union of results of <code class="highlighter-rouge">GROUP BY warehouse</code> and <code class="highlighter-rouge">GROUP BY product</code>. This clause
  is a shorthand for a <code class="highlighter-rouge">UNION ALL</code> where each leg of the <code class="highlighter-rouge">UNION ALL</code>
  operator performs aggregation of subset of the columns specified in the <code class="highlighter-rouge">GROUPING SETS</code> clause.</p>
  </li>
  <li>
    <p><strong>grouping_set</strong></p>

    <p>A grouping set is specified by zero or more comma-separated expressions in parentheses.</p>

    <p><strong>Syntax:</strong> <code class="highlighter-rouge">( [ expression [ , ... ] ] )</code></p>
  </li>
  <li>
    <p><strong>grouping_expression</strong></p>

    <p>Specifies the criteria based on which the rows are grouped together. The grouping of rows is performed based on
  result values of the grouping expressions. A grouping expression may be a column alias, a column position
  or an expression.</p>
  </li>
  <li>
    <p><strong>ROLLUP</strong></p>

    <p>Specifies multiple levels of aggregations in a single statement. This clause is used to compute aggregations
  based on multiple grouping sets. <code class="highlighter-rouge">ROLLUP</code> is a shorthand for <code class="highlighter-rouge">GROUPING SETS</code>. For example,
  <code class="highlighter-rouge">GROUP BY warehouse, product WITH ROLLUP</code> is equivalent to <code class="highlighter-rouge">GROUP BY GROUPING SETS
  ((warehouse, product), (warehouse), ())</code>.
  The N elements of a <code class="highlighter-rouge">ROLLUP</code> specification results in N+1 <code class="highlighter-rouge">GROUPING SETS</code>.</p>
  </li>
  <li>
    <p><strong>CUBE</strong></p>

    <p><code class="highlighter-rouge">CUBE</code> clause is used to perform aggregations based on combination of grouping columns specified in the
  <code class="highlighter-rouge">GROUP BY</code> clause. <code class="highlighter-rouge">CUBE</code> is a shorthand for <code class="highlighter-rouge">GROUPING SETS</code>. For example,
  <code class="highlighter-rouge">GROUP BY warehouse, product WITH CUBE</code> is equivalent to <code class="highlighter-rouge">GROUP BY GROUPING SETS
  ((warehouse, product), (warehouse), (product), ())</code>.
  The N elements of a <code class="highlighter-rouge">CUBE</code> specification results in 2^N <code class="highlighter-rouge">GROUPING SETS</code>.</p>
  </li>
  <li>
    <p><strong>aggregate_name</strong></p>

    <p>Specifies an aggregate function name (MIN, MAX, COUNT, SUM, AVG, etc.).</p>
  </li>
  <li>
    <p><strong>DISTINCT</strong></p>

    <p>Removes duplicates in input rows before they are passed to aggregate functions.</p>
  </li>
  <li>
    <p><strong>FILTER</strong></p>

    <p>Filters the input rows for which the <code class="highlighter-rouge">boolean_expression</code> in the <code class="highlighter-rouge">WHERE</code> clause evaluates
  to true are passed to the aggregate function; other rows are discarded.</p>
  </li>
</ul>

<h3 id="examples">Examples</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">dealer</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">city</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">car_model</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">quantity</span> <span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">dealer</span> <span class="k">VALUES</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'Fremont'</span><span class="p">,</span> <span class="s1">'Honda Civic'</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'Fremont'</span><span class="p">,</span> <span class="s1">'Honda Accord'</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'Fremont'</span><span class="p">,</span> <span class="s1">'Honda CRV'</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">'Dublin'</span><span class="p">,</span> <span class="s1">'Honda Civic'</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">'Dublin'</span><span class="p">,</span> <span class="s1">'Honda Accord'</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">'Dublin'</span><span class="p">,</span> <span class="s1">'Honda CRV'</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="s1">'San Jose'</span><span class="p">,</span> <span class="s1">'Honda Civic'</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="s1">'San Jose'</span><span class="p">,</span> <span class="s1">'Honda Accord'</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>

<span class="c1">-- Sum of quantity per dealership. Group by `id`.</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">dealer</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span><span class="mi">100</span><span class="o">|</span>           <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span><span class="mi">200</span><span class="o">|</span>           <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span><span class="mi">300</span><span class="o">|</span>           <span class="mi">13</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>

<span class="c1">-- Use column position in GROUP by clause.</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">dealer</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span><span class="mi">100</span><span class="o">|</span>           <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span><span class="mi">200</span><span class="o">|</span>           <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span><span class="mi">300</span><span class="o">|</span>           <span class="mi">13</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>

<span class="c1">-- Multiple aggregations.</span>
<span class="c1">-- 1. Sum of quantity per dealership.</span>
<span class="c1">-- 2. Max quantity per dealership.</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">sum</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">max</span> <span class="k">FROM</span> <span class="n">dealer</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+---+---+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span><span class="k">sum</span><span class="o">|</span><span class="k">max</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+---+</span>
<span class="o">|</span><span class="mi">100</span><span class="o">|</span> <span class="mi">32</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span>
<span class="o">|</span><span class="mi">200</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">|</span><span class="mi">300</span><span class="o">|</span> <span class="mi">13</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+---+---+</span>

<span class="c1">-- Count the number of distinct dealer cities per car_model.</span>
<span class="k">SELECT</span> <span class="n">car_model</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">city</span><span class="p">)</span> <span class="k">AS</span> <span class="k">count</span> <span class="k">FROM</span> <span class="n">dealer</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">car_model</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------+-----+</span>
<span class="o">|</span>   <span class="n">car_model</span><span class="o">|</span><span class="k">count</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+-----+</span>
<span class="o">|</span> <span class="n">Honda</span> <span class="n">Civic</span><span class="o">|</span>    <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Honda</span> <span class="n">CRV</span><span class="o">|</span>    <span class="mi">2</span><span class="o">|</span>
<span class="o">|</span><span class="n">Honda</span> <span class="n">Accord</span><span class="o">|</span>    <span class="mi">3</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+-----+</span>

<span class="c1">-- Sum of only 'Honda Civic' and 'Honda CRV' quantities per dealership.</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="n">FILTER</span> <span class="p">(</span>
            <span class="k">WHERE</span> <span class="n">car_model</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Honda Civic'</span><span class="p">,</span> <span class="s1">'Honda CRV'</span><span class="p">)</span>
        <span class="p">)</span> <span class="k">AS</span> <span class="nv">`sum(quantity)`</span> <span class="k">FROM</span> <span class="n">dealer</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span> <span class="n">id</span><span class="o">|</span><span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>
<span class="o">|</span><span class="mi">100</span><span class="o">|</span>           <span class="mi">17</span><span class="o">|</span>
<span class="o">|</span><span class="mi">200</span><span class="o">|</span>           <span class="mi">23</span><span class="o">|</span>
<span class="o">|</span><span class="mi">300</span><span class="o">|</span>            <span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---+-------------+</span>

<span class="c1">-- Aggregations using multiple sets of grouping columns in a single statement.</span>
<span class="c1">-- Following performs aggregations based on four sets of grouping columns.</span>
<span class="c1">-- 1. city, car_model</span>
<span class="c1">-- 2. city</span>
<span class="c1">-- 3. car_model</span>
<span class="c1">-- 4. Empty grouping set. Returns quantities for all city and car models.</span>
<span class="k">SELECT</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">sum</span> <span class="k">FROM</span> <span class="n">dealer</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">GROUPING</span> <span class="k">SETS</span> <span class="p">((</span><span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">),</span> <span class="p">(</span><span class="n">city</span><span class="p">),</span> <span class="p">(</span><span class="n">car_model</span><span class="p">),</span> <span class="p">())</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">city</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="n">city</span><span class="o">|</span>   <span class="n">car_model</span><span class="o">|</span><span class="k">sum</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">78</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">35</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">13</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>

<span class="c1">-- Alternate syntax for `GROUPING SETS` in which both `GROUP BY` and `GROUPING SETS`</span>
<span class="c1">-- specifications are present.</span>
<span class="k">SELECT</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">sum</span> <span class="k">FROM</span> <span class="n">dealer</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span> <span class="k">GROUPING</span> <span class="k">SETS</span> <span class="p">((</span><span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">),</span> <span class="p">(</span><span class="n">city</span><span class="p">),</span> <span class="p">(</span><span class="n">car_model</span><span class="p">),</span> <span class="p">())</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="n">city</span><span class="o">|</span>   <span class="n">car_model</span><span class="o">|</span><span class="k">sum</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">78</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">35</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">13</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>

<span class="c1">-- Group by processing with `ROLLUP` clause.</span>
<span class="c1">-- Equivalent GROUP BY GROUPING SETS ((city, car_model), (city), ())</span>
<span class="k">SELECT</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">sum</span> <span class="k">FROM</span> <span class="n">dealer</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span> <span class="k">WITH</span> <span class="k">ROLLUP</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="n">city</span><span class="o">|</span>   <span class="n">car_model</span><span class="o">|</span><span class="k">sum</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">78</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">13</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>

<span class="c1">-- Group by processing with `CUBE` clause.</span>
<span class="c1">-- Equivalent GROUP BY GROUPING SETS ((city, car_model), (city), (car_model), ())</span>
<span class="k">SELECT</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">AS</span> <span class="k">sum</span> <span class="k">FROM</span> <span class="n">dealer</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span> <span class="k">WITH</span> <span class="k">CUBE</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">city</span><span class="p">,</span> <span class="n">car_model</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="n">city</span><span class="o">|</span>   <span class="n">car_model</span><span class="o">|</span><span class="k">sum</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">78</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>     <span class="k">null</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">35</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">33</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Dublin</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">32</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>    <span class="n">HondaCRV</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span>
<span class="o">|</span>  <span class="n">Fremont</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>        <span class="k">null</span><span class="o">|</span> <span class="mi">13</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span> <span class="n">HondaAccord</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span>
<span class="o">|</span> <span class="n">San</span> <span class="n">Jose</span><span class="o">|</span>  <span class="n">HondaCivic</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------------+---+</span>

<span class="c1">--Prepare data for ignore nulls example</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">person</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">name</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">age</span> <span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">person</span> <span class="k">VALUES</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'Mary'</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">'John'</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="s1">'Mike'</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="s1">'Dan'</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

<span class="c1">--Select the first row in cloumn age</span>
<span class="k">SELECT</span> <span class="k">FIRST</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="k">first</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="k">NULL</span>               <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>

<span class="c1">--Get the first row in cloumn `age` ignore nulls,last row in column `id` and sum of cloumn `id`.</span>
<span class="k">SELECT</span> <span class="k">FIRST</span><span class="p">(</span><span class="n">age</span> <span class="k">IGNORE</span> <span class="n">NULLS</span><span class="p">),</span> <span class="k">LAST</span><span class="p">(</span><span class="n">id</span><span class="p">),</span> <span class="k">SUM</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------------------+------------------+----------+</span>
<span class="o">|</span> <span class="k">first</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>  <span class="o">|</span> <span class="k">last</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span>  <span class="o">|</span> <span class="k">sum</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+------------------+----------+</span>
<span class="o">|</span> <span class="mi">30</span>                <span class="o">|</span> <span class="mi">400</span>              <span class="o">|</span> <span class="mi">1000</span>     <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------+------------------+----------+</span>
</code></pre></div></div>

<h3 id="related-statements">Related Statements</h3>

<ul>
  <li><a href="sql-ref-syntax-qry-select.html">SELECT Main</a></li>
  <li><a href="sql-ref-syntax-qry-select-where.html">WHERE Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-having.html">HAVING Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-orderby.html">ORDER BY Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-sortby.html">SORT BY Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-clusterby.html">CLUSTER BY Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-distribute-by.html">DISTRIBUTE BY Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-limit.html">LIMIT Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-case.html">CASE Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-pivot.html">PIVOT Clause</a></li>
  <li><a href="sql-ref-syntax-qry-select-lateral-view.html">LATERAL VIEW Clause</a></li>
</ul>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.4.1.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
