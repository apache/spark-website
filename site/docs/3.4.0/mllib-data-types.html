
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Data Types - RDD-based API - Spark 3.4.0 Documentation</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <link rel="stylesheet" href="css/docsearch.css">

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <nav class="navbar fixed-top navbar-expand-md navbar-light bg-light" id="topbar">
            <div class="container">
                <div class="navbar-header">
                    <div class="navbar-brand"><a href="index.html">
                        <img src="img/spark-logo-hd.png" style="height:50px;"/></a><span class="version">3.4.0</span>
                    </div>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarCollapse" aria-controls="navbarCollapse"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li class="nav-item"><a href="index.html" class="nav-link">Overview</a></li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarQuickStart" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Programming Guides</a>
                            <div class="dropdown-menu" aria-labelledby="navbarQuickStart">
                                <a class="dropdown-item" href="quick-start.html">Quick Start</a>
                                <a class="dropdown-item" href="rdd-programming-guide.html">RDDs, Accumulators, Broadcasts Vars</a>
                                <a class="dropdown-item" href="sql-programming-guide.html">SQL, DataFrames, and Datasets</a>
                                <a class="dropdown-item" href="structured-streaming-programming-guide.html">Structured Streaming</a>
                                <a class="dropdown-item" href="streaming-programming-guide.html">Spark Streaming (DStreams)</a>
                                <a class="dropdown-item" href="ml-guide.html">MLlib (Machine Learning)</a>
                                <a class="dropdown-item" href="graphx-programming-guide.html">GraphX (Graph Processing)</a>
                                <a class="dropdown-item" href="sparkr.html">SparkR (R on Spark)</a>
                                <a class="dropdown-item" href="api/python/getting_started/index.html">PySpark (Python on Spark)</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarAPIDocs" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">API Docs</a>
                            <div class="dropdown-menu" aria-labelledby="navbarAPIDocs">
                                <a class="dropdown-item" href="api/scala/org/apache/spark/index.html">Scala</a>
                                <a class="dropdown-item" href="api/java/index.html">Java</a>
                                <a class="dropdown-item" href="api/python/index.html">Python</a>
                                <a class="dropdown-item" href="api/R/index.html">R</a>
                                <a class="dropdown-item" href="api/sql/index.html">SQL, Built-in Functions</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDeploying" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Deploying</a>
                            <div class="dropdown-menu" aria-labelledby="navbarDeploying">
                                <a class="dropdown-item" href="cluster-overview.html">Overview</a>
                                <a class="dropdown-item" href="submitting-applications.html">Submitting Applications</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="spark-standalone.html">Spark Standalone</a>
                                <a class="dropdown-item" href="running-on-mesos.html">Mesos</a>
                                <a class="dropdown-item" href="running-on-yarn.html">YARN</a>
                                <a class="dropdown-item" href="running-on-kubernetes.html">Kubernetes</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarMore" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
                            <div class="dropdown-menu" aria-labelledby="navbarMore">
                                <a class="dropdown-item" href="configuration.html">Configuration</a>
                                <a class="dropdown-item" href="monitoring.html">Monitoring</a>
                                <a class="dropdown-item" href="tuning.html">Tuning Guide</a>
                                <a class="dropdown-item" href="job-scheduling.html">Job Scheduling</a>
                                <a class="dropdown-item" href="security.html">Security</a>
                                <a class="dropdown-item" href="hardware-provisioning.html">Hardware Provisioning</a>
                                <a class="dropdown-item" href="migration-guide.html">Migration Guide</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="building-spark.html">Building Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/contributing.html">Contributing to Spark</a>
                                <a class="dropdown-item" href="https://spark.apache.org/third-party-projects.html">Third Party Projects</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <input type="text" id="docsearch-input" placeholder="Search the docsâ€¦">
                        </li>
                    </ul>
                    <!--<span class="navbar-text navbar-right"><span class="version-text">v3.4.0</span></span>-->
                </div>
            </div>
        </nav>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="ml-guide.html">MLlib: Main Guide</a></h3>
        
<ul>

    <li>
        <a href="ml-statistics.html">
            
                Basic statistics
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-datasource.html">
            
                Data sources
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-pipeline.html">
            
                Pipelines
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-features.html">
            
                Extracting, transforming and selecting features
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-classification-regression.html">
            
                Classification and Regression
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-clustering.html">
            
                Clustering
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-collaborative-filtering.html">
            
                Collaborative filtering
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-frequent-pattern-mining.html">
            
                Frequent Pattern Mining
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-tuning.html">
            
                Model selection and tuning
            
        </a>
    </li>
    
    

    <li>
        <a href="ml-advanced.html">
            
                Advanced topics
            
        </a>
    </li>
    
    

</ul>

        <h3><a href="mllib-guide.html">MLlib: RDD-based API Guide</a></h3>
        
<ul>

    <li>
        <a href="mllib-data-types.html">
            
                Data types
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-statistics.html">
            
                Basic statistics
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-classification-regression.html">
            
                Classification and regression
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-collaborative-filtering.html">
            
                Collaborative filtering
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-clustering.html">
            
                Clustering
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-dimensionality-reduction.html">
            
                Dimensionality reduction
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-feature-extraction.html">
            
                Feature extraction and transformation
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-frequent-pattern-mining.html">
            
                Frequent pattern mining
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-evaluation-metrics.html">
            
                Evaluation metrics
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-pmml-model-export.html">
            
                PMML model export
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-optimization.html">
            
                Optimization (developer)
            
        </a>
    </li>
    
    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" checked type="checkbox">
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar mr-3" id="content">
                    
                        <h1 class="title">Data Types - RDD-based API</h1>
                    

                    <ul id="markdown-toc">
  <li><a href="#local-vector" id="markdown-toc-local-vector">Local vector</a></li>
  <li><a href="#labeled-point" id="markdown-toc-labeled-point">Labeled point</a></li>
  <li><a href="#local-matrix" id="markdown-toc-local-matrix">Local matrix</a></li>
  <li><a href="#distributed-matrix" id="markdown-toc-distributed-matrix">Distributed matrix</a>    <ul>
      <li><a href="#rowmatrix" id="markdown-toc-rowmatrix">RowMatrix</a></li>
      <li><a href="#indexedrowmatrix" id="markdown-toc-indexedrowmatrix">IndexedRowMatrix</a></li>
      <li><a href="#coordinatematrix" id="markdown-toc-coordinatematrix">CoordinateMatrix</a></li>
      <li><a href="#blockmatrix" id="markdown-toc-blockmatrix">BlockMatrix</a></li>
    </ul>
  </li>
</ul>

<p>MLlib supports local vectors and matrices stored on a single machine, 
as well as distributed matrices backed by one or more RDDs.
Local vectors and local matrices are simple data models 
that serve as public interfaces. The underlying linear algebra operations are provided by
<a href="http://www.scalanlp.org/">Breeze</a>.
A training example used in supervised learning is called a &#8220;labeled point&#8221; in MLlib.</p>

<h2 id="local-vector">Local vector</h2>

<p>A local vector has integer-typed and 0-based indices and double-typed values, stored on a single
machine.  MLlib supports two types of local vectors: dense and sparse.  A dense vector is backed by
a double array representing its entry values, while a sparse vector is backed by two parallel
arrays: indices and values.  For example, a vector <code class="language-plaintext highlighter-rouge">(1.0, 0.0, 3.0)</code> can be represented in dense
format as <code class="language-plaintext highlighter-rouge">[1.0, 0.0, 3.0]</code> or in sparse format as <code class="language-plaintext highlighter-rouge">(3, [0, 2], [1.0, 3.0])</code>, where <code class="language-plaintext highlighter-rouge">3</code> is the size
of the vector.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>The base class of local vectors is
<a href="api/scala/org/apache/spark/mllib/linalg/Vector.html"><code class="language-plaintext highlighter-rouge">Vector</code></a>, and we provide two
implementations: <a href="api/scala/org/apache/spark/mllib/linalg/DenseVector.html"><code class="language-plaintext highlighter-rouge">DenseVector</code></a> and
<a href="api/scala/org/apache/spark/mllib/linalg/SparseVector.html"><code class="language-plaintext highlighter-rouge">SparseVector</code></a>.  We recommend
using the factory methods implemented in
<a href="api/scala/org/apache/spark/mllib/linalg/Vectors$.html"><code class="language-plaintext highlighter-rouge">Vectors</code></a> to create local vectors.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/Vector.html"><code class="language-plaintext highlighter-rouge">Vector</code> Scala docs</a> and <a href="api/scala/org/apache/spark/mllib/linalg/Vectors$.html"><code class="language-plaintext highlighter-rouge">Vectors</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.</span><span class="o">{</span><span class="nc">Vector</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">}</span>

<span class="c1">// Create a dense vector (1.0, 0.0, 3.0).</span>
<span class="k">val</span> <span class="nv">dv</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nv">Vectors</span><span class="o">.</span><span class="py">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its indices and values corresponding to nonzero entries.</span>
<span class="k">val</span> <span class="nv">sv1</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nv">Vectors</span><span class="o">.</span><span class="py">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">))</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its nonzero entries.</span>
<span class="k">val</span> <span class="nv">sv2</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nv">Vectors</span><span class="o">.</span><span class="py">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Seq</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)))</span></code></pre></figure>

    <p><strong><em>Note:</em></strong>
Scala imports <code class="language-plaintext highlighter-rouge">scala.collection.immutable.Vector</code> by default, so you have to import
<code class="language-plaintext highlighter-rouge">org.apache.spark.mllib.linalg.Vector</code> explicitly to use MLlib&#8217;s <code class="language-plaintext highlighter-rouge">Vector</code>.</p>

  </div>

<div data-lang="java">

    <p>The base class of local vectors is
<a href="api/java/org/apache/spark/mllib/linalg/Vector.html"><code class="language-plaintext highlighter-rouge">Vector</code></a>, and we provide two
implementations: <a href="api/java/org/apache/spark/mllib/linalg/DenseVector.html"><code class="language-plaintext highlighter-rouge">DenseVector</code></a> and
<a href="api/java/org/apache/spark/mllib/linalg/SparseVector.html"><code class="language-plaintext highlighter-rouge">SparseVector</code></a>.  We recommend
using the factory methods implemented in
<a href="api/java/org/apache/spark/mllib/linalg/Vectors.html"><code class="language-plaintext highlighter-rouge">Vectors</code></a> to create local vectors.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/Vector.html"><code class="language-plaintext highlighter-rouge">Vector</code> Java docs</a> and <a href="api/java/org/apache/spark/mllib/linalg/Vectors.html"><code class="language-plaintext highlighter-rouge">Vectors</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span><span class="o">;</span>

<span class="c1">// Create a dense vector (1.0, 0.0, 3.0).</span>
<span class="nc">Vector</span> <span class="n">dv</span> <span class="o">=</span> <span class="nc">Vectors</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">);</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its indices and values corresponding to nonzero entries.</span>
<span class="nc">Vector</span> <span class="n">sv</span> <span class="o">=</span> <span class="nc">Vectors</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">});</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p>MLlib recognizes the following types as dense vectors:</p>

    <ul>
      <li>NumPy&#8217;s <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html"><code class="language-plaintext highlighter-rouge">array</code></a></li>
      <li>Python&#8217;s list, e.g., <code class="language-plaintext highlighter-rouge">[1, 2, 3]</code></li>
    </ul>

    <p>and the following as sparse vectors:</p>

    <ul>
      <li>MLlib&#8217;s <a href="api/python/reference/api/pyspark.mllib.linalg.SparseVector.html"><code class="language-plaintext highlighter-rouge">SparseVector</code></a>.</li>
      <li>SciPy&#8217;s
<a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csc_matrix.html#scipy.sparse.csc_matrix"><code class="language-plaintext highlighter-rouge">csc_matrix</code></a>
with a single column</li>
    </ul>

    <p>We recommend using NumPy arrays over lists for efficiency, and using the factory methods implemented
in <a href="api/python/reference/api/pyspark.mllib.linalg.Vectors.html"><code class="language-plaintext highlighter-rouge">Vectors</code></a> to create sparse vectors.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.Vectors.html"><code class="language-plaintext highlighter-rouge">Vectors</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="n">sps</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Vectors</span>

<span class="c1"># Use a NumPy array as a dense vector.
</span><span class="n">dv1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="c1"># Use a Python list as a dense vector.
</span><span class="n">dv2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="c1"># Create a SparseVector.
</span><span class="n">sv1</span> <span class="o">=</span> <span class="n">Vectors</span><span class="p">.</span><span class="n">sparse</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="c1"># Use a single-column SciPy csc_matrix as a sparse vector.
</span><span class="n">sv2</span> <span class="o">=</span> <span class="n">sps</span><span class="p">.</span><span class="n">csc_matrix</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<h2 id="labeled-point">Labeled point</h2>

<p>A labeled point is a local vector, either dense or sparse, associated with a label/response.
In MLlib, labeled points are used in supervised learning algorithms.
We use a double to store a label, so we can use labeled points in both regression and classification.
For binary classification, a label should be either <code class="language-plaintext highlighter-rouge">0</code> (negative) or <code class="language-plaintext highlighter-rouge">1</code> (positive).
For multiclass classification, labels should be class indices starting from zero: <code class="language-plaintext highlighter-rouge">0, 1, 2, ...</code>.</p>

<div class="codetabs">

<div data-lang="scala">

    <p>A labeled point is represented by the case class
<a href="api/scala/org/apache/spark/mllib/regression/LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code></a>.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/regression/LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span>

<span class="c1">// Create a labeled point with a positive label and a dense feature vector.</span>
<span class="k">val</span> <span class="nv">pos</span> <span class="k">=</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="nv">Vectors</span><span class="o">.</span><span class="py">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">))</span>

<span class="c1">// Create a labeled point with a negative label and a sparse feature vector.</span>
<span class="k">val</span> <span class="nv">neg</span> <span class="k">=</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="nv">Vectors</span><span class="o">.</span><span class="py">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)))</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>A labeled point is represented by
<a href="api/java/org/apache/spark/mllib/regression/LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code></a>.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/regression/LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span><span class="o">;</span>

<span class="c1">// Create a labeled point with a positive label and a dense feature vector.</span>
<span class="nc">LabeledPoint</span> <span class="n">pos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">));</span>

<span class="c1">// Create a labeled point with a negative label and a sparse feature vector.</span>
<span class="nc">LabeledPoint</span> <span class="n">neg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">}));</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>A labeled point is represented by
<a href="api/python/reference/api/pyspark.mllib.regression.LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code></a>.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.regression.LabeledPoint.html"><code class="language-plaintext highlighter-rouge">LabeledPoint</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">SparseVector</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.regression</span> <span class="kn">import</span> <span class="n">LabeledPoint</span>

<span class="c1"># Create a labeled point with a positive label and a dense feature vector.
</span><span class="n">pos</span> <span class="o">=</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>

<span class="c1"># Create a labeled point with a negative label and a sparse feature vector.
</span><span class="n">neg</span> <span class="o">=</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">SparseVector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span></code></pre></figure>

  </div>
</div>

<p><strong><em>Sparse data</em></strong></p>

<p>It is very common in practice to have sparse training data.  MLlib supports reading training
examples stored in <code class="language-plaintext highlighter-rouge">LIBSVM</code> format, which is the default format used by
<a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/"><code class="language-plaintext highlighter-rouge">LIBSVM</code></a> and
<a href="http://www.csie.ntu.edu.tw/~cjlin/liblinear/"><code class="language-plaintext highlighter-rouge">LIBLINEAR</code></a>.  It is a text format in which each line
represents a labeled sparse feature vector using the following format:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>label index1:value1 index2:value2 ...
</code></pre></div></div>

<p>where the indices are one-based and in ascending order. 
After loading, the feature indices are converted to zero-based.</p>

<div class="codetabs">
<div data-lang="scala">

    <p><a href="api/scala/org/apache/spark/mllib/util/MLUtils$.html"><code class="language-plaintext highlighter-rouge">MLUtils.loadLibSVMFile</code></a> reads training
examples stored in LIBSVM format.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/util/MLUtils$.html"><code class="language-plaintext highlighter-rouge">MLUtils</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.util.MLUtils</span>
<span class="k">import</span> <span class="nn">org.apache.spark.rdd.RDD</span>

<span class="k">val</span> <span class="nv">examples</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">LabeledPoint</span><span class="o">]</span> <span class="k">=</span> <span class="nv">MLUtils</span><span class="o">.</span><span class="py">loadLibSVMFile</span><span class="o">(</span><span class="n">sc</span><span class="o">,</span> <span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">
    <p><a href="api/java/org/apache/spark/mllib/util/MLUtils.html"><code class="language-plaintext highlighter-rouge">MLUtils.loadLibSVMFile</code></a> reads training
examples stored in LIBSVM format.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/util/MLUtils.html"><code class="language-plaintext highlighter-rouge">MLUtils</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.util.MLUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>

<span class="nc">JavaRDD</span><span class="o">&lt;</span><span class="nc">LabeledPoint</span><span class="o">&gt;</span> <span class="n">examples</span> <span class="o">=</span> 
  <span class="nc">MLUtils</span><span class="o">.</span><span class="na">loadLibSVMFile</span><span class="o">(</span><span class="n">jsc</span><span class="o">.</span><span class="na">sc</span><span class="o">(),</span> <span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="o">).</span><span class="na">toJavaRDD</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p><a href="api/python/reference/api/pyspark.mllib.util.MLUtils.html"><code class="language-plaintext highlighter-rouge">MLUtils.loadLibSVMFile</code></a> reads training
examples stored in LIBSVM format.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.util.MLUtils.html"><code class="language-plaintext highlighter-rouge">MLUtils</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.util</span> <span class="kn">import</span> <span class="n">MLUtils</span>

<span class="n">examples</span> <span class="o">=</span> <span class="n">MLUtils</span><span class="p">.</span><span class="n">loadLibSVMFile</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="s">"data/mllib/sample_libsvm_data.txt"</span><span class="p">)</span></code></pre></figure>

  </div>
</div>

<h2 id="local-matrix">Local matrix</h2>

<p>A local matrix has integer-typed row and column indices and double-typed values, stored on a single
machine.  MLlib supports dense matrices, whose entry values are stored in a single double array in
column-major order, and sparse matrices, whose non-zero entry values are stored in the Compressed Sparse
Column (CSC) format in column-major order.  For example, the following dense matrix <code class="language-plaintext highlighter-rouge">\[ \begin{pmatrix}
1.0 &amp; 2.0 \\
3.0 &amp; 4.0 \\
5.0 &amp; 6.0
\end{pmatrix}
\]</code>
is stored in a one-dimensional array <code class="language-plaintext highlighter-rouge">[1.0, 3.0, 5.0, 2.0, 4.0, 6.0]</code> with the matrix size <code class="language-plaintext highlighter-rouge">(3, 2)</code>.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>The base class of local matrices is
<a href="api/scala/org/apache/spark/mllib/linalg/Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code></a>, and we provide two
implementations: <a href="api/scala/org/apache/spark/mllib/linalg/DenseMatrix.html"><code class="language-plaintext highlighter-rouge">DenseMatrix</code></a>,
and <a href="api/scala/org/apache/spark/mllib/linalg/SparseMatrix.html"><code class="language-plaintext highlighter-rouge">SparseMatrix</code></a>.
We recommend using the factory methods implemented
in <a href="api/scala/org/apache/spark/mllib/linalg/Matrices$.html"><code class="language-plaintext highlighter-rouge">Matrices</code></a> to create local
matrices. Remember, local matrices in MLlib are stored in column-major order.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code> Scala docs</a> and <a href="api/scala/org/apache/spark/mllib/linalg/Matrices$.html"><code class="language-plaintext highlighter-rouge">Matrices</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.</span><span class="o">{</span><span class="nc">Matrix</span><span class="o">,</span> <span class="nc">Matrices</span><span class="o">}</span>

<span class="c1">// Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
<span class="k">val</span> <span class="nv">dm</span><span class="k">:</span> <span class="kt">Matrix</span> <span class="o">=</span> <span class="nv">Matrices</span><span class="o">.</span><span class="py">dense</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">,</span> <span class="mf">4.0</span><span class="o">,</span> <span class="mf">6.0</span><span class="o">))</span>

<span class="c1">// Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
<span class="k">val</span> <span class="nv">sm</span><span class="k">:</span> <span class="kt">Matrix</span> <span class="o">=</span> <span class="nv">Matrices</span><span class="o">.</span><span class="py">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">))</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>The base class of local matrices is
<a href="api/java/org/apache/spark/mllib/linalg/Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code></a>, and we provide two
implementations: <a href="api/java/org/apache/spark/mllib/linalg/DenseMatrix.html"><code class="language-plaintext highlighter-rouge">DenseMatrix</code></a>,
and <a href="api/java/org/apache/spark/mllib/linalg/SparseMatrix.html"><code class="language-plaintext highlighter-rouge">SparseMatrix</code></a>.
We recommend using the factory methods implemented
in <a href="api/java/org/apache/spark/mllib/linalg/Matrices.html"><code class="language-plaintext highlighter-rouge">Matrices</code></a> to create local
matrices. Remember, local matrices in MLlib are stored in column-major order.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code> Java docs</a> and <a href="api/java/org/apache/spark/mllib/linalg/Matrices.html"><code class="language-plaintext highlighter-rouge">Matrices</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Matrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Matrices</span><span class="o">;</span>

<span class="c1">// Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
<span class="nc">Matrix</span> <span class="n">dm</span> <span class="o">=</span> <span class="nc">Matrices</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">,</span> <span class="mf">4.0</span><span class="o">,</span> <span class="mf">6.0</span><span class="o">});</span>

<span class="c1">// Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
<span class="nc">Matrix</span> <span class="n">sm</span> <span class="o">=</span> <span class="nc">Matrices</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">},</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mi">9</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">});</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>The base class of local matrices is
<a href="api/python/reference/api/pyspark.mllib.linalg.Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code></a>, and we provide two
implementations: <a href="api/python/reference/api/pyspark.mllib.linalg.DenseMatrix.html"><code class="language-plaintext highlighter-rouge">DenseMatrix</code></a>,
and <a href="api/python/reference/api/pyspark.mllib.linalg.SparseMatrix.html"><code class="language-plaintext highlighter-rouge">SparseMatrix</code></a>.
We recommend using the factory methods implemented
in <a href="api/python/reference/api/pyspark.mllib.linalg.Matrices.html"><code class="language-plaintext highlighter-rouge">Matrices</code></a> to create local
matrices. Remember, local matrices in MLlib are stored in column-major order.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.Matrix.html"><code class="language-plaintext highlighter-rouge">Matrix</code> Python docs</a> and <a href="api/python/reference/api/pyspark.mllib.linalg.Matrices.html"><code class="language-plaintext highlighter-rouge">Matrices</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">Matrices</span>

<span class="c1"># Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))
</span><span class="n">dm2</span> <span class="o">=</span> <span class="n">Matrices</span><span class="p">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))
</span><span class="n">sm</span> <span class="o">=</span> <span class="n">Matrices</span><span class="p">.</span><span class="n">sparse</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span></code></pre></figure>

  </div>

</div>

<h2 id="distributed-matrix">Distributed matrix</h2>

<p>A distributed matrix has long-typed row and column indices and double-typed values, stored
distributively in one or more RDDs.  It is very important to choose the right format to store large
and distributed matrices.  Converting a distributed matrix to a different format may require a
global shuffle, which is quite expensive. Four types of distributed matrices have been implemented
so far.</p>

<p>The basic type is called <code class="language-plaintext highlighter-rouge">RowMatrix</code>. A <code class="language-plaintext highlighter-rouge">RowMatrix</code> is a row-oriented distributed
matrix without meaningful row indices, e.g., a collection of feature vectors.
It is backed by an RDD of its rows, where each row is a local vector.
We assume that the number of columns is not huge for a <code class="language-plaintext highlighter-rouge">RowMatrix</code> so that a single
local vector can be reasonably communicated to the driver and can also be stored /
operated on using a single node. 
An <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> is similar to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> but with row indices,
which can be used for identifying rows and executing joins.
A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> is a distributed matrix stored in <a href="https://en.wikipedia.org/wiki/Sparse_matrix#Coordinate_list_.28COO.29">coordinate list (COO)</a> format,
backed by an RDD of its entries.
A <code class="language-plaintext highlighter-rouge">BlockMatrix</code> is a distributed matrix backed by an RDD of <code class="language-plaintext highlighter-rouge">MatrixBlock</code>
which is a tuple of <code class="language-plaintext highlighter-rouge">(Int, Int, Matrix)</code>.</p>

<p><strong><em>Note</em></strong></p>

<p>The underlying RDDs of a distributed matrix must be deterministic, because we cache the matrix size.
In general, the use of non-deterministic RDDs can lead to errors.</p>

<h3 id="rowmatrix">RowMatrix</h3>

<p>A <code class="language-plaintext highlighter-rouge">RowMatrix</code> is a row-oriented distributed matrix without meaningful row indices, backed by an RDD
of its rows, where each row is a local vector.
Since each row is represented by a local vector, the number of columns is
limited by the integer range but it should be much smaller in practice.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>A <a href="api/scala/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code></a> can be
created from an <code class="language-plaintext highlighter-rouge">RDD[Vector]</code> instance.  Then we can compute its column summary statistics and decompositions.
<a href="https://en.wikipedia.org/wiki/QR_decomposition">QR decomposition</a> is of the form A = QR where Q is an orthogonal matrix and R is an upper triangular matrix.
For <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">singular value decomposition (SVD)</a> and <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">principal component analysis (PCA)</a>, please refer to <a href="mllib-dimensionality-reduction.html">Dimensionality reduction</a>.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span>

<span class="k">val</span> <span class="nv">rows</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">Vector</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of local vectors</span>
<span class="c1">// Create a RowMatrix from an RDD[Vector].</span>
<span class="k">val</span> <span class="nv">mat</span><span class="k">:</span> <span class="kt">RowMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="nv">m</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">n</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numCols</span><span class="o">()</span>

<span class="c1">// QR decomposition </span>
<span class="k">val</span> <span class="nv">qrResult</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">tallSkinnyQR</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>A <a href="api/java/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code></a> can be
created from a <code class="language-plaintext highlighter-rouge">JavaRDD&lt;Vector&gt;</code> instance.  Then we can compute its column summary statistics.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span><span class="o">;</span>

<span class="nc">JavaRDD</span><span class="o">&lt;</span><span class="nc">Vector</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of local vectors</span>
<span class="c1">// Create a RowMatrix from a JavaRDD&lt;Vector&gt;.</span>
<span class="nc">RowMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// QR decomposition </span>
<span class="nc">QRDecomposition</span><span class="o">&lt;</span><span class="nc">RowMatrix</span><span class="o">,</span> <span class="nc">Matrix</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">tallSkinnyQR</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>A <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code></a> can be 
created from an <code class="language-plaintext highlighter-rouge">RDD</code> of vectors.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.RowMatrix.html"><code class="language-plaintext highlighter-rouge">RowMatrix</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">RowMatrix</span>

<span class="c1"># Create an RDD of vectors.
</span><span class="n">rows</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>

<span class="c1"># Create a RowMatrix from an RDD of vectors.
</span><span class="n">mat</span> <span class="o">=</span> <span class="n">RowMatrix</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<span class="c1"># Get its size.
</span><span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 4
</span><span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 3
</span>
<span class="c1"># Get the rows as an RDD of vectors again.
</span><span class="n">rowsRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">rows</span></code></pre></figure>

  </div>

</div>

<h3 id="indexedrowmatrix">IndexedRowMatrix</h3>

<p>An <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> is similar to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> but with meaningful row indices.  It is backed by
an RDD of indexed rows, so that each row is represented by its index (long-typed) and a local 
vector.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>An
<a href="api/scala/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code></a>
can be created from an <code class="language-plaintext highlighter-rouge">RDD[IndexedRow]</code> instance, where
<a href="api/scala/org/apache/spark/mllib/linalg/distributed/IndexedRow.html"><code class="language-plaintext highlighter-rouge">IndexedRow</code></a> is a
wrapper over <code class="language-plaintext highlighter-rouge">(Long, Vector)</code>.  An <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> can be converted to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> by dropping
its row indices.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">IndexedRow</span><span class="o">,</span> <span class="nc">IndexedRowMatrix</span><span class="o">,</span> <span class="nc">RowMatrix</span><span class="o">}</span>

<span class="k">val</span> <span class="nv">rows</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">IndexedRow</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of indexed rows</span>
<span class="c1">// Create an IndexedRowMatrix from an RDD[IndexedRow].</span>
<span class="k">val</span> <span class="nv">mat</span><span class="k">:</span> <span class="kt">IndexedRowMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexedRowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="nv">m</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">n</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numCols</span><span class="o">()</span>

<span class="c1">// Drop its row indices.</span>
<span class="k">val</span> <span class="nv">rowMat</span><span class="k">:</span> <span class="kt">RowMatrix</span> <span class="o">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">toRowMatrix</span><span class="o">()</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>An
<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code></a>
can be created from a <code class="language-plaintext highlighter-rouge">JavaRDD&lt;IndexedRow&gt;</code> instance, where
<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRow.html"><code class="language-plaintext highlighter-rouge">IndexedRow</code></a> is a
wrapper over <code class="language-plaintext highlighter-rouge">(long, Vector)</code>.  An <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> can be converted to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> by dropping
its row indices.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span><span class="o">;</span>

<span class="nc">JavaRDD</span><span class="o">&lt;</span><span class="nc">IndexedRow</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of indexed rows</span>
<span class="c1">// Create an IndexedRowMatrix from a JavaRDD&lt;IndexedRow&gt;.</span>
<span class="nc">IndexedRowMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexedRowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// Drop its row indices.</span>
<span class="nc">RowMatrix</span> <span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">toRowMatrix</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>An <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code></a>
can be created from an <code class="language-plaintext highlighter-rouge">RDD</code> of <code class="language-plaintext highlighter-rouge">IndexedRow</code>s, where 
<a href="api/python/reference/api/pyspark.mllib.linalg.distributed.IndexedRow.html"><code class="language-plaintext highlighter-rouge">IndexedRow</code></a> is a 
wrapper over <code class="language-plaintext highlighter-rouge">(long, vector)</code>.  An <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> can be converted to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> by dropping
its row indices.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.IndexedRowMatrix.html"><code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">IndexedRow</span><span class="p">,</span> <span class="n">IndexedRowMatrix</span>

<span class="c1"># Create an RDD of indexed rows.
#   - This can be done explicitly with the IndexedRow class:
</span><span class="n">indexedRows</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([</span><span class="n">IndexedRow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])])</span>
<span class="c1">#   - or by using (long, vector) tuples:
</span><span class="n">indexedRows</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
                              <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])])</span>

<span class="c1"># Create an IndexedRowMatrix from an RDD of IndexedRows.
</span><span class="n">mat</span> <span class="o">=</span> <span class="n">IndexedRowMatrix</span><span class="p">(</span><span class="n">indexedRows</span><span class="p">)</span>

<span class="c1"># Get its size.
</span><span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 4
</span><span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 3
</span>
<span class="c1"># Get the rows as an RDD of IndexedRows.
</span><span class="n">rowsRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">rows</span>

<span class="c1"># Convert to a RowMatrix by dropping the row indices.
</span><span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toRowMatrix</span><span class="p">()</span></code></pre></figure>

  </div>

</div>

<h3 id="coordinatematrix">CoordinateMatrix</h3>

<p>A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> is a distributed matrix backed by an RDD of its entries.  Each entry is a tuple
of <code class="language-plaintext highlighter-rouge">(i: Long, j: Long, value: Double)</code>, where <code class="language-plaintext highlighter-rouge">i</code> is the row index, <code class="language-plaintext highlighter-rouge">j</code> is the column index, and
<code class="language-plaintext highlighter-rouge">value</code> is the entry value.  A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> should be used only when both
dimensions of the matrix are huge and the matrix is very sparse.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>A
<a href="api/scala/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code></a>
can be created from an <code class="language-plaintext highlighter-rouge">RDD[MatrixEntry]</code> instance, where
<a href="api/scala/org/apache/spark/mllib/linalg/distributed/MatrixEntry.html"><code class="language-plaintext highlighter-rouge">MatrixEntry</code></a> is a
wrapper over <code class="language-plaintext highlighter-rouge">(Long, Long, Double)</code>.  A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> can be converted to an <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code>
with sparse rows by calling <code class="language-plaintext highlighter-rouge">toIndexedRowMatrix</code>.  Other computations for 
<code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> are not currently supported.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">CoordinateMatrix</span><span class="o">,</span> <span class="nc">MatrixEntry</span><span class="o">}</span>

<span class="k">val</span> <span class="nv">entries</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">MatrixEntry</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from an RDD[MatrixEntry].</span>
<span class="k">val</span> <span class="nv">mat</span><span class="k">:</span> <span class="kt">CoordinateMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="nv">m</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">n</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">numCols</span><span class="o">()</span>

<span class="c1">// Convert it to an IndexRowMatrix whose rows are sparse vectors.</span>
<span class="k">val</span> <span class="nv">indexedRowMatrix</span> <span class="k">=</span> <span class="nv">mat</span><span class="o">.</span><span class="py">toIndexedRowMatrix</span><span class="o">()</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>A
<a href="api/java/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code></a>
can be created from a <code class="language-plaintext highlighter-rouge">JavaRDD&lt;MatrixEntry&gt;</code> instance, where
<a href="api/java/org/apache/spark/mllib/linalg/distributed/MatrixEntry.html"><code class="language-plaintext highlighter-rouge">MatrixEntry</code></a> is a
wrapper over <code class="language-plaintext highlighter-rouge">(long, long, double)</code>.  A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> can be converted to an <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code>
with sparse rows by calling <code class="language-plaintext highlighter-rouge">toIndexedRowMatrix</code>. Other computations for 
<code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> are not currently supported.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.CoordinateMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.MatrixEntry</span><span class="o">;</span>

<span class="nc">JavaRDD</span><span class="o">&lt;</span><span class="nc">MatrixEntry</span><span class="o">&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from a JavaRDD&lt;MatrixEntry&gt;.</span>
<span class="nc">CoordinateMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// Convert it to an IndexRowMatrix whose rows are sparse vectors.</span>
<span class="nc">IndexedRowMatrix</span> <span class="n">indexedRowMatrix</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">toIndexedRowMatrix</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>A <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code></a>
can be created from an <code class="language-plaintext highlighter-rouge">RDD</code> of <code class="language-plaintext highlighter-rouge">MatrixEntry</code> entries, where 
<a href="api/python/reference/api/pyspark.mllib.linalg.distributed.MatrixEntry.html"><code class="language-plaintext highlighter-rouge">MatrixEntry</code></a> is a 
wrapper over <code class="language-plaintext highlighter-rouge">(long, long, float)</code>.  A <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> can be converted to a <code class="language-plaintext highlighter-rouge">RowMatrix</code> by 
calling <code class="language-plaintext highlighter-rouge">toRowMatrix</code>, or to an <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> with sparse rows by calling <code class="language-plaintext highlighter-rouge">toIndexedRowMatrix</code>.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.CoordinateMatrix.html"><code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">CoordinateMatrix</span><span class="p">,</span> <span class="n">MatrixEntry</span>

<span class="c1"># Create an RDD of coordinate entries.
#   - This can be done explicitly with the MatrixEntry class:
</span><span class="n">entries</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([</span><span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span> <span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">)])</span>
<span class="c1">#   - or using (long, long, float) tuples:
</span><span class="n">entries</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">)])</span>

<span class="c1"># Create a CoordinateMatrix from an RDD of MatrixEntries.
</span><span class="n">mat</span> <span class="o">=</span> <span class="n">CoordinateMatrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

<span class="c1"># Get its size.
</span><span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 3
</span><span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 2
</span>
<span class="c1"># Get the entries as an RDD of MatrixEntries.
</span><span class="n">entriesRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">entries</span>

<span class="c1"># Convert to a RowMatrix.
</span><span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to an IndexedRowMatrix.
</span><span class="n">indexedRowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toIndexedRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to a BlockMatrix.
</span><span class="n">blockMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toBlockMatrix</span><span class="p">()</span></code></pre></figure>

  </div>

</div>

<h3 id="blockmatrix">BlockMatrix</h3>

<p>A <code class="language-plaintext highlighter-rouge">BlockMatrix</code> is a distributed matrix backed by an RDD of <code class="language-plaintext highlighter-rouge">MatrixBlock</code>s, where a <code class="language-plaintext highlighter-rouge">MatrixBlock</code> is
a tuple of <code class="language-plaintext highlighter-rouge">((Int, Int), Matrix)</code>, where the <code class="language-plaintext highlighter-rouge">(Int, Int)</code> is the index of the block, and <code class="language-plaintext highlighter-rouge">Matrix</code> is
the sub-matrix at the given index with size <code class="language-plaintext highlighter-rouge">rowsPerBlock</code> x <code class="language-plaintext highlighter-rouge">colsPerBlock</code>.
<code class="language-plaintext highlighter-rouge">BlockMatrix</code> supports methods such as <code class="language-plaintext highlighter-rouge">add</code> and <code class="language-plaintext highlighter-rouge">multiply</code> with another <code class="language-plaintext highlighter-rouge">BlockMatrix</code>.
<code class="language-plaintext highlighter-rouge">BlockMatrix</code> also has a helper function <code class="language-plaintext highlighter-rouge">validate</code> which can be used to check whether the
<code class="language-plaintext highlighter-rouge">BlockMatrix</code> is set up properly.</p>

<div class="codetabs">
<div data-lang="scala">

    <p>A <a href="api/scala/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code></a> can be
most easily created from an <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> or <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> by calling <code class="language-plaintext highlighter-rouge">toBlockMatrix</code>.
<code class="language-plaintext highlighter-rouge">toBlockMatrix</code> creates blocks of size 1024 x 1024 by default.
Users may change the block size by supplying the values through <code class="language-plaintext highlighter-rouge">toBlockMatrix(rowsPerBlock, colsPerBlock)</code>.</p>

    <p>Refer to the <a href="api/scala/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code> Scala docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">BlockMatrix</span><span class="o">,</span> <span class="nc">CoordinateMatrix</span><span class="o">,</span> <span class="nc">MatrixEntry</span><span class="o">}</span>

<span class="k">val</span> <span class="nv">entries</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">MatrixEntry</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of (i, j, v) matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from an RDD[MatrixEntry].</span>
<span class="k">val</span> <span class="nv">coordMat</span><span class="k">:</span> <span class="kt">CoordinateMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">)</span>
<span class="c1">// Transform the CoordinateMatrix to a BlockMatrix</span>
<span class="k">val</span> <span class="nv">matA</span><span class="k">:</span> <span class="kt">BlockMatrix</span> <span class="o">=</span> <span class="nv">coordMat</span><span class="o">.</span><span class="py">toBlockMatrix</span><span class="o">().</span><span class="py">cache</span><span class="o">()</span>

<span class="c1">// Validate whether the BlockMatrix is set up properly. Throws an Exception when it is not valid.</span>
<span class="c1">// Nothing happens if it is valid.</span>
<span class="nv">matA</span><span class="o">.</span><span class="py">validate</span><span class="o">()</span>

<span class="c1">// Calculate A^T A.</span>
<span class="k">val</span> <span class="nv">ata</span> <span class="k">=</span> <span class="nv">matA</span><span class="o">.</span><span class="py">transpose</span><span class="o">.</span><span class="py">multiply</span><span class="o">(</span><span class="n">matA</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>A <a href="api/java/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code></a> can be
most easily created from an <code class="language-plaintext highlighter-rouge">IndexedRowMatrix</code> or <code class="language-plaintext highlighter-rouge">CoordinateMatrix</code> by calling <code class="language-plaintext highlighter-rouge">toBlockMatrix</code>.
<code class="language-plaintext highlighter-rouge">toBlockMatrix</code> creates blocks of size 1024 x 1024 by default.
Users may change the block size by supplying the values through <code class="language-plaintext highlighter-rouge">toBlockMatrix(rowsPerBlock, colsPerBlock)</code>.</p>

    <p>Refer to the <a href="api/java/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code> Java docs</a> for details on the API.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.BlockMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.CoordinateMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>

<span class="nc">JavaRDD</span><span class="o">&lt;</span><span class="nc">MatrixEntry</span><span class="o">&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of (i, j, v) Matrix Entries</span>
<span class="c1">// Create a CoordinateMatrix from a JavaRDD&lt;MatrixEntry&gt;.</span>
<span class="nc">CoordinateMatrix</span> <span class="n">coordMat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>
<span class="c1">// Transform the CoordinateMatrix to a BlockMatrix</span>
<span class="nc">BlockMatrix</span> <span class="n">matA</span> <span class="o">=</span> <span class="n">coordMat</span><span class="o">.</span><span class="na">toBlockMatrix</span><span class="o">().</span><span class="na">cache</span><span class="o">();</span>

<span class="c1">// Validate whether the BlockMatrix is set up properly. Throws an Exception when it is not valid.</span>
<span class="c1">// Nothing happens if it is valid.</span>
<span class="n">matA</span><span class="o">.</span><span class="na">validate</span><span class="o">();</span>

<span class="c1">// Calculate A^T A.</span>
<span class="nc">BlockMatrix</span> <span class="n">ata</span> <span class="o">=</span> <span class="n">matA</span><span class="o">.</span><span class="na">transpose</span><span class="o">().</span><span class="na">multiply</span><span class="o">(</span><span class="n">matA</span><span class="o">);</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>A <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code></a> 
can be created from an <code class="language-plaintext highlighter-rouge">RDD</code> of sub-matrix blocks, where a sub-matrix block is a 
<code class="language-plaintext highlighter-rouge">((blockRowIndex, blockColIndex), sub-matrix)</code> tuple.</p>

    <p>Refer to the <a href="api/python/reference/api/pyspark.mllib.linalg.distributed.BlockMatrix.html"><code class="language-plaintext highlighter-rouge">BlockMatrix</code> Python docs</a> for more details on the API.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Matrices</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">BlockMatrix</span>

<span class="c1"># Create an RDD of sub-matrix blocks.
</span><span class="n">blocks</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">([((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Matrices</span><span class="p">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])),</span>
                         <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Matrices</span><span class="p">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]))])</span>

<span class="c1"># Create a BlockMatrix from an RDD of sub-matrix blocks.
</span><span class="n">mat</span> <span class="o">=</span> <span class="n">BlockMatrix</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Get its size.
</span><span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 6
</span><span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 2
</span>
<span class="c1"># Get the blocks as an RDD of sub-matrix blocks.
</span><span class="n">blocksRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">blocks</span>

<span class="c1"># Convert to a LocalMatrix.
</span><span class="n">localMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toLocalMatrix</span><span class="p">()</span>

<span class="c1"># Convert to an IndexedRowMatrix.
</span><span class="n">indexedRowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toIndexedRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to a CoordinateMatrix.
</span><span class="n">coordinateMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">toCoordinateMatrix</span><span class="p">()</span></code></pre></figure>

  </div>
</div>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.5.1.min.js"></script>
        <script src="js/vendor/bootstrap.bundle.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
        <script type="text/javascript">
            // DocSearch is entirely free and automated. DocSearch is built in two parts:
            // 1. a crawler which we run on our own infrastructure every 24 hours. It follows every link
            //    in your website and extract content from every page it traverses. It then pushes this
            //    content to an Algolia index.
            // 2. a JavaScript snippet to be inserted in your website that will bind this Algolia index
            //    to your search input and display its results in a dropdown UI. If you want to find more
            //    details on how works DocSearch, check the docs of DocSearch.
            docsearch({
    apiKey: 'd62f962a82bc9abb53471cb7b89da35e',
    appId: 'RAI69RXRSK',
    indexName: 'apache_spark',
    inputSelector: '#docsearch-input',
    enhancedSearchInput: true,
    algoliaOptions: {
      'facetFilters': ["version:3.4.0"]
    },
    debug: false // Set debug to true if you want to inspect the dropdown
});

        </script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
