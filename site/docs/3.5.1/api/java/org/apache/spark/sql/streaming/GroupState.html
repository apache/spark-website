<!DOCTYPE HTML>
<html lang="ko">
<head>
<!-- Generated by javadoc (17) on Sat Feb 24 16:16:59 KST 2024 -->
<title>GroupState (Spark 3.5.1 JavaDoc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-02-24">
<meta name="description" content="declaration: package: org.apache.spark.sql.streaming, interface: GroupState">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.spark.sql.streaming</a></div>
<h1 title="Interface GroupState" class="title">Interface GroupState&lt;S&gt;</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>S</code> - User-defined type of the state to be stored for each group. Must be encodable into
           Spark SQL types (see <code>Encoder</code> for more details).</dd>
</dl>
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code>org.apache.spark.sql.catalyst.plans.logical.LogicalGroupState&lt;S&gt;</code></dd>
</dl>
<dl class="notes">
<dt>All Known Subinterfaces:</dt>
<dd><code><a href="TestGroupState.html" title="interface in org.apache.spark.sql.streaming">TestGroupState</a>&lt;S&gt;</code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">GroupState&lt;S&gt;</span><span class="extends-implements">
extends org.apache.spark.sql.catalyst.plans.logical.LogicalGroupState&lt;S&gt;</span></div>
<div class="block">:: Experimental ::
 <p>
 Wrapper class for interacting with per-group state data in <code>mapGroupsWithState</code> and
 <code>flatMapGroupsWithState</code> operations on <code>KeyValueGroupedDataset</code>.
 <p>
 Detail description on <code>[map/flatMap]GroupsWithState</code> operation
 --------------------------------------------------------------
 Both, <code>mapGroupsWithState</code> and <code>flatMapGroupsWithState</code> in <code>KeyValueGroupedDataset</code>
 will invoke the user-given function on each group (defined by the grouping function in
 <code>Dataset.groupByKey()</code>) while maintaining a user-defined per-group state between invocations.
 For a static batch Dataset, the function will be invoked once per group. For a streaming
 Dataset, the function will be invoked for each group repeatedly in every trigger.
 That is, in every batch of the <code>StreamingQuery</code>,
 the function will be invoked once for each group that has data in the trigger. Furthermore,
 if timeout is set, then the function will be invoked on timed-out groups (more detail below).
 <p>
 The function is invoked with the following parameters.
  - The key of the group.
  - An iterator containing all the values for this group.
  - A user-defined state object set by previous invocations of the given function.
 <p>
 In case of a batch Dataset, there is only one invocation and the state object will be empty as
 there is no prior state. Essentially, for batch Datasets, <code>[map/flatMap]GroupsWithState</code>
 is equivalent to <code>[map/flatMap]Groups</code> and any updates to the state and/or timeouts have
 no effect.
 <p>
 The major difference between <code>mapGroupsWithState</code> and <code>flatMapGroupsWithState</code> is that the
 former allows the function to return one and only one record, whereas the latter
 allows the function to return any number of records (including no records). Furthermore, the
 <code>flatMapGroupsWithState</code> is associated with an operation output mode, which can be either
 <code>Append</code> or <code>Update</code>. Semantically, this defines whether the output records of one trigger
 is effectively replacing the previously output records (from previous triggers) or is appending
 to the list of previously output records. Essentially, this defines how the Result Table (refer
 to the semantics in the programming guide) is updated, and allows us to reason about the
 semantics of later operations.
 <p>
 Important points to note about the function (both mapGroupsWithState and flatMapGroupsWithState).
  - In a trigger, the function will be called only the groups present in the batch. So do not
    assume that the function will be called in every trigger for every group that has state.
  - There is no guaranteed ordering of values in the iterator in the function, neither with
    batch, nor with streaming Datasets.
  - All the data will be shuffled before applying the function.
  - If timeout is set, then the function will also be called with no values.
    See more details on <code>GroupStateTimeout</code> below.
 <p>
 Important points to note about using <code>GroupState</code>.
  - The value of the state cannot be null. So updating state with null will throw
    <code>IllegalArgumentException</code>.
  - Operations on <code>GroupState</code> are not thread-safe. This is to avoid memory barriers.
  - If <code>remove()</code> is called, then <code>exists()</code> will return <code>false</code>,
    <code>get()</code> will throw <code>NoSuchElementException</code> and <code>getOption()</code> will return <code>None</code>
  - After that, if <code>update(newState)</code> is called, then <code>exists()</code> will again return <code>true</code>,
    <code>get()</code> and <code>getOption()</code>will return the updated value.
 <p>
 Important points to note about using <code>GroupStateTimeout</code>.
  - The timeout type is a global param across all the groups (set as <code>timeout</code> param in
    <code>[map|flatMap]GroupsWithState</code>, but the exact timeout duration/timestamp is configurable per
    group by calling <code>setTimeout...()</code> in <code>GroupState</code>.
  - Timeouts can be either based on processing time (i.e.
    <code>GroupStateTimeout.ProcessingTimeTimeout</code>) or event time (i.e.
    <code>GroupStateTimeout.EventTimeTimeout</code>).
  - With <code>ProcessingTimeTimeout</code>, the timeout duration can be set by calling
    <code>GroupState.setTimeoutDuration</code>. The timeout will occur when the clock has advanced by the set
    duration. Guarantees provided by this timeout with a duration of D ms are as follows:
    - Timeout will never occur before the clock time has advanced by D ms
    - Timeout will occur eventually when there is a trigger in the query
      (i.e. after D ms). So there is no strict upper bound on when the timeout would occur.
      For example, the trigger interval of the query will affect when the timeout actually occurs.
      If there is no data in the stream (for any group) for a while, then there will not be
      any trigger and timeout function call will not occur until there is data.
    - Since the processing time timeout is based on the clock time, it is affected by the
      variations in the system clock (i.e. time zone changes, clock skew, etc.).
  - With <code>EventTimeTimeout</code>, the user also has to specify the event time watermark in
    the query using <code>Dataset.withWatermark()</code>. With this setting, data that is older than the
    watermark is filtered out. The timeout can be set for a group by setting a timeout timestamp
    using<code>GroupState.setTimeoutTimestamp()</code>, and the timeout would occur when the watermark
    advances beyond the set timestamp. You can control the timeout delay by two parameters -
    (i) watermark delay and an additional duration beyond the timestamp in the event (which
    is guaranteed to be newer than watermark due to the filtering). Guarantees provided by this
    timeout are as follows:
    - Timeout will never occur before the watermark has exceeded the set timeout.
    - Similar to processing time timeouts, there is no strict upper bound on the delay when
      the timeout actually occurs. The watermark can advance only when there is data in the
      stream and the event time of the data has actually advanced.
  - When the timeout occurs for a group, the function is called for that group with no values, and
    <code>GroupState.hasTimedOut()</code> set to true.
  - The timeout is reset every time the function is called on a group, that is,
    when the group has new data, or the group has timed out. So the user has to set the timeout
    duration every time the function is called, otherwise, there will not be any timeout set.
 <p>
 <code>[map/flatMap]GroupsWithState</code> can take a user defined initial state as an additional argument.
 This state will be applied when the first batch of the streaming query is processed. If there
 are no matching rows in the data for the keys present in the initial state, the state is still
 applied and the function will be invoked with the values being an empty iterator.
 <p>
 Scala example of using GroupState in <code>mapGroupsWithState</code>:
 <pre><code>
 // A mapping function that maintains an integer state for string keys and returns a string.
 // Additionally, it sets a timeout to remove the state if it has not received data for an hour.
 def mappingFunction(key: String, value: Iterator[Int], state: GroupState[Int]): String = {

   if (state.hasTimedOut) {                // If called when timing out, remove the state
     state.remove()

   } else if (state.exists) {              // If state exists, use it for processing
     val existingState = state.get         // Get the existing state
     val shouldRemove = ...                // Decide whether to remove the state
     if (shouldRemove) {
       state.remove()                      // Remove the state

     } else {
       val newState = ...
       state.update(newState)              // Set the new state
       state.setTimeoutDuration("1 hour")  // Set the timeout
     }

   } else {
     val initialState = ...
     state.update(initialState)            // Set the initial state
     state.setTimeoutDuration("1 hour")    // Set the timeout
   }
   ...
   // return something
 }

 dataset
   .groupByKey(...)
   .mapGroupsWithState(GroupStateTimeout.ProcessingTimeTimeout)(mappingFunction)
 </code></pre>
 <p>
 Java example of using <code>GroupState</code>:
 <pre><code>
 // A mapping function that maintains an integer state for string keys and returns a string.
 // Additionally, it sets a timeout to remove the state if it has not received data for an hour.
 MapGroupsWithStateFunction&lt;String, Integer, Integer, String&gt; mappingFunction =
    new MapGroupsWithStateFunction&lt;String, Integer, Integer, String&gt;() {

      &#64;Override
      public String call(String key, Iterator&lt;Integer&gt; value, GroupState&lt;Integer&gt; state) {
        if (state.hasTimedOut()) {            // If called when timing out, remove the state
          state.remove();

        } else if (state.exists()) {            // If state exists, use it for processing
          int existingState = state.get();      // Get the existing state
          boolean shouldRemove = ...;           // Decide whether to remove the state
          if (shouldRemove) {
            state.remove();                     // Remove the state

          } else {
            int newState = ...;
            state.update(newState);             // Set the new state
            state.setTimeoutDuration("1 hour"); // Set the timeout
          }

        } else {
          int initialState = ...;               // Set the initial state
          state.update(initialState);
          state.setTimeoutDuration("1 hour");   // Set the timeout
        }
        ...
         // return something
      }
    };

 dataset
     .groupByKey(...)
     .mapGroupsWithState(
         mappingFunction, Encoders.INT, Encoders.STRING, GroupStateTimeout.ProcessingTimeTimeout);
 </code></pre>
 <p></div>
<dl class="notes">
<dt>Since:</dt>
<dd>2.2.0</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#exists()" class="member-name-link">exists</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Whether state exists or not.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="GroupState.html" title="type parameter in GroupState">S</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#get()" class="member-name-link">get</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the state value if it exists, or throw NoSuchElementException.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getCurrentProcessingTimeMs()" class="member-name-link">getCurrentProcessingTimeMs</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the current processing time as milliseconds in epoch time.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getCurrentWatermarkMs()" class="member-name-link">getCurrentWatermarkMs</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the current event time watermark as milliseconds in epoch time.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>scala.Option&lt;<a href="GroupState.html" title="type parameter in GroupState">S</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getOption()" class="member-name-link">getOption</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the state value as a scala Option.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#hasTimedOut()" class="member-name-link">hasTimedOut</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Whether the function has been called because the key has timed out.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#remove()" class="member-name-link">remove</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Remove this state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutDuration(long)" class="member-name-link">setTimeoutDuration</a><wbr>(long&nbsp;durationMs)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout duration in ms for this key.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutDuration(java.lang.String)" class="member-name-link">setTimeoutDuration</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;duration)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout duration for this key as a string.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutTimestamp(long)" class="member-name-link">setTimeoutTimestamp</a><wbr>(long&nbsp;timestampMs)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout timestamp for this key as milliseconds in epoch time.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutTimestamp(long,java.lang.String)" class="member-name-link">setTimeoutTimestamp</a><wbr>(long&nbsp;timestampMs,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;additionalDuration)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout timestamp for this key as milliseconds in epoch time and an additional
 duration as a string (e.g. "1 hour", "2 days", etc.).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutTimestamp(java.sql.Date)" class="member-name-link">setTimeoutTimestamp</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.sql/java/sql/Date.html" title="class or interface in java.sql" class="external-link">Date</a>&nbsp;timestamp)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout timestamp for this key as a java.sql.Date.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setTimeoutTimestamp(java.sql.Date,java.lang.String)" class="member-name-link">setTimeoutTimestamp</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.sql/java/sql/Date.html" title="class or interface in java.sql" class="external-link">Date</a>&nbsp;timestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;additionalDuration)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the timeout timestamp for this key as a java.sql.Date and an additional
 duration as a string (e.g. "1 hour", "2 days", etc.).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#update(S)" class="member-name-link">update</a><wbr>(<a href="GroupState.html" title="type parameter in GroupState">S</a>&nbsp;newState)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Update the value of the state.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="exists()">
<h3>exists</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">exists</span>()</div>
<div class="block">Whether state exists or not.</div>
</section>
</li>
<li>
<section class="detail" id="get()">
<h3>get</h3>
<div class="member-signature"><span class="return-type"><a href="GroupState.html" title="type parameter in GroupState">S</a></span>&nbsp;<span class="element-name">get</span>()
throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/NoSuchElementException.html" title="class or interface in java.util" class="external-link">NoSuchElementException</a></span></div>
<div class="block">Get the state value if it exists, or throw NoSuchElementException.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/NoSuchElementException.html" title="class or interface in java.util" class="external-link">NoSuchElementException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCurrentProcessingTimeMs()">
<h3>getCurrentProcessingTimeMs</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name">getCurrentProcessingTimeMs</span>()</div>
<div class="block">Get the current processing time as milliseconds in epoch time.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>(undocumented)</dd>
<dt>Note:</dt>
<dd>In a streaming query, this will return a constant value throughout the duration of a
       trigger, even if the trigger is re-executed.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCurrentWatermarkMs()">
<h3>getCurrentWatermarkMs</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name">getCurrentWatermarkMs</span>()
                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Get the current event time watermark as milliseconds in epoch time.
 <p></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>(undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd>In a streaming query, this can be called only when watermark is set before calling
       <code>[map/flatMap]GroupsWithState</code>. In a batch query, this method always returns -1., The watermark gets propagated in the end of each query. As a result, this method will
       return 0 (1970-01-01T00:00:00) for the first micro-batch. If you use this value
       as a part of the timestamp set in the <code>setTimeoutTimestamp</code>, it may lead to the
       state expiring immediately in the next micro-batch, once the watermark gets the
       real value from your data.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getOption()">
<h3>getOption</h3>
<div class="member-signature"><span class="return-type">scala.Option&lt;<a href="GroupState.html" title="type parameter in GroupState">S</a>&gt;</span>&nbsp;<span class="element-name">getOption</span>()</div>
<div class="block">Get the state value as a scala Option.</div>
</section>
</li>
<li>
<section class="detail" id="hasTimedOut()">
<h3>hasTimedOut</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">hasTimedOut</span>()</div>
<div class="block">Whether the function has been called because the key has timed out.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>(undocumented)</dd>
<dt>Note:</dt>
<dd>This can return true only when timeouts are enabled in <code>[map/flatMap]GroupsWithState</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="remove()">
<h3>remove</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">remove</span>()</div>
<div class="block">Remove this state.</div>
</section>
</li>
<li>
<section class="detail" id="setTimeoutDuration(long)">
<h3>setTimeoutDuration</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutDuration</span><wbr><span class="parameters">(long&nbsp;durationMs)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout duration in ms for this key.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>durationMs</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Processing time timeout</code></a> must be enabled in
       <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setTimeoutDuration(java.lang.String)">
<h3>setTimeoutDuration</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutDuration</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;duration)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout duration for this key as a string. For example, "1 hour", "2 days", etc.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>duration</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Processing time timeout</code></a> must be enabled in
       <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setTimeoutTimestamp(long)">
<h3>setTimeoutTimestamp</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutTimestamp</span><wbr><span class="parameters">(long&nbsp;timestampMs)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout timestamp for this key as milliseconds in epoch time.
 This timestamp cannot be older than the current watermark.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>timestampMs</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Event time timeout</code></a> must be enabled in
       <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setTimeoutTimestamp(long,java.lang.String)">
<h3>setTimeoutTimestamp</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutTimestamp</span><wbr><span class="parameters">(long&nbsp;timestampMs,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;additionalDuration)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout timestamp for this key as milliseconds in epoch time and an additional
 duration as a string (e.g. "1 hour", "2 days", etc.).
 The final timestamp (including the additional duration) cannot be older than the
 current watermark.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>timestampMs</code> - (undocumented)</dd>
<dd><code>additionalDuration</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Event time timeout</code></a> must be enabled in
       <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no side effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setTimeoutTimestamp(java.sql.Date)">
<h3>setTimeoutTimestamp</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutTimestamp</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.sql/java/sql/Date.html" title="class or interface in java.sql" class="external-link">Date</a>&nbsp;timestamp)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout timestamp for this key as a java.sql.Date.
 This timestamp cannot be older than the current watermark.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>timestamp</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Event time timeout</code></a> must be enabled in
       <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no side effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setTimeoutTimestamp(java.sql.Date,java.lang.String)">
<h3>setTimeoutTimestamp</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setTimeoutTimestamp</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.sql/java/sql/Date.html" title="class or interface in java.sql" class="external-link">Date</a>&nbsp;timestamp,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;additionalDuration)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Set the timeout timestamp for this key as a java.sql.Date and an additional
 duration as a string (e.g. "1 hour", "2 days", etc.).
 The final timestamp (including the additional duration) cannot be older than the
 current watermark.
 <p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>timestamp</code> - (undocumented)</dd>
<dd><code>additionalDuration</code> - (undocumented)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
<dt>Note:</dt>
<dd><a href="GroupStateTimeout.html" title="class in org.apache.spark.sql.streaming"><code>Event time timeout</code></a> must be enabled in
      <code>[map/flatMap]GroupsWithState</code> for calling this method., This method has no side effect when used in a batch query.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="update(S)">
<h3 id="update(java.lang.Object)">update</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="GroupState.html" title="type parameter in GroupState">S</a>&nbsp;newState)</span></div>
<div class="block">Update the value of the state.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
<script defer="defer" type="text/javascript" src="../../../../../lib/jquery.js"></script><script defer="defer" type="text/javascript" src="../../../../../lib/api-javadocs.js"></script></body>
</html>
