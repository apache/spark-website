
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>pyspark.pandas.indexes.category &#8212; PySpark 3.5.2-SNAPSHOT documentation</title>
    
    <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" href="../../../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/pyspark.css" />
    
    <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="canonical" href="https://spark.apache.org/docs/latest/api/python/_modules/pyspark/pandas/indexes/category.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/spark-logo-reverse.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../index.html">
  Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../user_guide/index.html">
  User Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../reference/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../development/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../migration_guide/index.html">
  Migration Guides
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<div id="version-button" class="dropdown">
    <button type="button" class="btn btn-secondary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        3.5.2-SNAPSHOT
        <span class="caret"></span>
    </button>
    <div id="version_switcher" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<script type="text/javascript">
// Function to construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://spark.apache.org/docs/{version}/api/python/index.html";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Function to check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "_modules/pyspark/pandas/indexes/category.html",
          otherDocsHomepage = event.target.getAttribute("href");
    let tryUrl = `${otherDocsHomepage}${currentFilePath}`;
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    return false;
}

// Function to populate the version switcher
(function () {
    // get JSON config
    $.getJSON("_static/versions.json", function(data, textStatus, jqXHR) {
        // create the nodes first (before AJAX calls) to ensure the order is
        // correct (for now, links will go to doc version homepage)
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // construct the appropriate URL, and add it to the dropdown
            entry.url = buildURL(entry);
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.setAttribute("href", `${entry.url}`);
            node.textContent = `${entry.name}`;
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher").append(node);
        });
    });
})();
</script>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyspark.pandas.indexes.category</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span class="c1"># contributor license agreements.  See the NOTICE file distributed with</span>
<span class="c1"># this work for additional information regarding copyright ownership.</span>
<span class="c1"># The ASF licenses this file to You under the Apache License, Version 2.0</span>
<span class="c1"># (the &quot;License&quot;); you may not use this file except in compliance with</span>
<span class="c1"># the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">no_type_check</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas.api.types</span> <span class="kn">import</span> <span class="n">is_hashable</span><span class="p">,</span> <span class="n">CategoricalDtype</span>  <span class="c1"># type: ignore[attr-defined]</span>

<span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">ps</span>
<span class="kn">from</span> <span class="nn">pyspark.pandas.indexes.base</span> <span class="kn">import</span> <span class="n">Index</span>
<span class="kn">from</span> <span class="nn">pyspark.pandas.internal</span> <span class="kn">import</span> <span class="n">InternalField</span>
<span class="kn">from</span> <span class="nn">pyspark.pandas.series</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">StructField</span>


<div class="viewcode-block" id="CategoricalIndex"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.html#pyspark.pandas.CategoricalIndex">[docs]</a><span class="k">class</span> <span class="nc">CategoricalIndex</span><span class="p">(</span><span class="n">Index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Index based on an underlying `Categorical`.</span>

<span class="sd">    CategoricalIndex can only take on a limited,</span>
<span class="sd">    and usually fixed, number of possible values (`categories`). Also,</span>
<span class="sd">    it might have an order, but numerical operations</span>
<span class="sd">    (additions, divisions, ...) are not possible.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array-like (1-dimensional)</span>
<span class="sd">        The values of the categorical. If `categories` are given, values not in</span>
<span class="sd">        `categories` will be replaced with NaN.</span>
<span class="sd">    categories : index-like, optional</span>
<span class="sd">        The categories for the categorical. Items need to be unique.</span>
<span class="sd">        If the categories are not given here (and also not in `dtype`), they</span>
<span class="sd">        will be inferred from the `data`.</span>
<span class="sd">    ordered : bool, optional</span>
<span class="sd">        Whether or not this categorical is treated as an ordered</span>
<span class="sd">        categorical. If not given here or in `dtype`, the resulting</span>
<span class="sd">        categorical will be unordered.</span>
<span class="sd">    dtype : CategoricalDtype or &quot;category&quot;, optional</span>
<span class="sd">        If :class:`CategoricalDtype`, cannot be used together with</span>
<span class="sd">        `categories` or `ordered`.</span>
<span class="sd">    copy : bool, default False</span>
<span class="sd">        Make a copy of input ndarray.</span>
<span class="sd">    name : object, optional</span>
<span class="sd">        Name to be stored in the index.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Index : The base pandas-on-Spark Index type.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; ps.CategoricalIndex([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;])  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                     categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">    ``CategoricalIndex`` can also be instantiated from a ``Categorical``:</span>

<span class="sd">    &gt;&gt;&gt; c = pd.Categorical([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;])</span>
<span class="sd">    &gt;&gt;&gt; ps.CategoricalIndex(c)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                     categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">    Ordered ``CategoricalIndex`` can have a min and max value.</span>

<span class="sd">    &gt;&gt;&gt; ci = ps.CategoricalIndex(</span>
<span class="sd">    ...     [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;], ordered=True, categories=[&quot;c&quot;, &quot;b&quot;, &quot;a&quot;]</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; ci  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                     categories=[&#39;c&#39;, &#39;b&#39;, &#39;a&#39;], ordered=True, dtype=&#39;category&#39;)</span>

<span class="sd">    From a Series:</span>

<span class="sd">    &gt;&gt;&gt; s = ps.Series([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;], index=[10, 20, 30, 40, 50, 60])</span>
<span class="sd">    &gt;&gt;&gt; ps.CategoricalIndex(s)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                     categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">    From an Index:</span>

<span class="sd">    &gt;&gt;&gt; idx = ps.Index([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;])</span>
<span class="sd">    &gt;&gt;&gt; ps.CategoricalIndex(idx)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                     categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@no_type_check</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_hashable</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index.name must be a hashable type&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;category&quot;</span>
            <span class="k">return</span> <span class="n">Index</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ps</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">CategoricalIndex</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CategoricalDtype</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">CategoricalDtype</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">codes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Index</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The category codes of this categorical.</span>

<span class="sd">        Codes are an Index of integers which are the positions of the actual</span>
<span class="sd">        values in the categories Index.</span>

<span class="sd">        There is no setter, use the other categorical methods and the normal item</span>
<span class="sd">        setter to change values in the categorical.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Index</span>
<span class="sd">            A non-writable view of the `codes` Index.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.codes  # doctest: +SKIP</span>
<span class="sd">        Int64Index([0, 1, 1, 2, 2, 2], dtype=&#39;int64&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_with_new_scol</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span>
            <span class="n">field</span><span class="o">=</span><span class="n">InternalField</span><span class="o">.</span><span class="n">from_struct_field</span><span class="p">(</span>
                <span class="n">StructField</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">index_spark_column_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">dataType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span>
                    <span class="n">nullable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">categories</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The categories of this categorical.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.categories</span>
<span class="sd">        Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;object&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">categories</span>

    <span class="nd">@categories</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">categories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">List</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">CategoricalDtype</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dtype</span><span class="o">.</span><span class="n">categories</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;new categories need to have the same number of items as the old categories!&quot;</span>
            <span class="p">)</span>

        <span class="n">internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psdf</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
            <span class="n">index_fields</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">index_fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psdf</span><span class="o">.</span><span class="n">_update_internal_frame</span><span class="p">(</span><span class="n">internal</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ordered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the categories have an ordered relationship.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.ordered</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">ordered</span>

<div class="viewcode-block" id="CategoricalIndex.add_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.add_categories.html#pyspark.pandas.CategoricalIndex.add_categories">[docs]</a>    <span class="k">def</span> <span class="nf">add_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add new categories.</span>

<span class="sd">        `new_categories` will be included at the last/highest place in the</span>
<span class="sd">        categories and will be unused directly after this call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_categories : category or list-like of category</span>
<span class="sd">           The new categories to be included.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to add the categories inplace or return a copy of</span>
<span class="sd">           this categorical with added categories.</span>

<span class="sd">           .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex or None</span>
<span class="sd">            Categorical with new categories added or None if ``inplace=True``.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the new categories include old categories or do not validate as</span>
<span class="sd">            categories</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        rename_categories : Rename categories.</span>
<span class="sd">        reorder_categories : Reorder categories.</span>
<span class="sd">        remove_categories : Remove the specified categories.</span>
<span class="sd">        remove_unused_categories : Remove categories which are not used.</span>
<span class="sd">        set_categories : Set the categories to the specified ones.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.add_categories(&#39;x&#39;)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;x&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="o">=</span><span class="n">new_categories</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.as_ordered"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.as_ordered.html#pyspark.pandas.CategoricalIndex.as_ordered">[docs]</a>    <span class="k">def</span> <span class="nf">as_ordered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the Categorical to be ordered.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to set the ordered attribute in-place or return</span>
<span class="sd">           a copy of this categorical with ordered set to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex or None</span>
<span class="sd">            Ordered Categorical or None if ``inplace=True``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.as_ordered()  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=True, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">as_ordered</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.as_unordered"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.as_unordered.html#pyspark.pandas.CategoricalIndex.as_unordered">[docs]</a>    <span class="k">def</span> <span class="nf">as_unordered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the Categorical to be unordered.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to set the ordered attribute in-place or return</span>
<span class="sd">           a copy of this categorical with ordered set to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex or None</span>
<span class="sd">            Unordered Categorical or None if ``inplace=True``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;)).as_ordered()</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=True, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.as_unordered()  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">as_unordered</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.remove_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.remove_categories.html#pyspark.pandas.CategoricalIndex.remove_categories">[docs]</a>    <span class="k">def</span> <span class="nf">remove_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">removals</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the specified categories.</span>

<span class="sd">        `removals` must be included in the old categories. Values which were in</span>
<span class="sd">        the removed categories will be set to NaN</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        removals : category or list of categories</span>
<span class="sd">           The categories which should be removed.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to remove the categories inplace or return a copy of</span>
<span class="sd">           this categorical with removed categories.</span>

<span class="sd">           .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex or None</span>
<span class="sd">            Categorical with removed categories or None if ``inplace=True``.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the removals are not contained in the categories</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        rename_categories : Rename categories.</span>
<span class="sd">        reorder_categories : Reorder categories.</span>
<span class="sd">        add_categories : Add new categories.</span>
<span class="sd">        remove_unused_categories : Remove categories which are not used.</span>
<span class="sd">        set_categories : Set the categories to the specified ones.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.remove_categories(&#39;b&#39;)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, nan, nan, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">(</span><span class="n">removals</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.remove_unused_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.remove_unused_categories.html#pyspark.pandas.CategoricalIndex.remove_unused_categories">[docs]</a>    <span class="k">def</span> <span class="nf">remove_unused_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove categories which are not used.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to drop unused categories inplace or return a copy of</span>
<span class="sd">           this categorical with unused categories dropped.</span>

<span class="sd">           .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cat : CategoricalIndex or None</span>
<span class="sd">            Categorical with unused categories dropped or None if ``inplace=True``.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        rename_categories : Rename categories.</span>
<span class="sd">        reorder_categories : Reorder categories.</span>
<span class="sd">        add_categories : Add new categories.</span>
<span class="sd">        remove_categories : Remove the specified categories.</span>
<span class="sd">        set_categories : Set the categories to the specified ones.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;), categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.remove_unused_categories()  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_unused_categories</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.rename_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.rename_categories.html#pyspark.pandas.CategoricalIndex.rename_categories">[docs]</a>    <span class="k">def</span> <span class="nf">rename_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rename categories.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_categories : list-like, dict-like or callable</span>

<span class="sd">            New categories which will replace old categories.</span>

<span class="sd">            * list-like: all items must be unique and the number of items in</span>
<span class="sd">              the new categories must match the existing number of categories.</span>

<span class="sd">            * dict-like: specifies a mapping from</span>
<span class="sd">              old categories to new. Categories not contained in the mapping</span>
<span class="sd">              are passed through and extra categories in the mapping are</span>
<span class="sd">              ignored.</span>

<span class="sd">            * callable : a callable that is called on all items in the old</span>
<span class="sd">              categories and whose return values comprise the new categories.</span>

<span class="sd">        inplace : bool, default False</span>
<span class="sd">            Whether or not to rename the categories inplace or return a copy of</span>
<span class="sd">            this categorical with renamed categories.</span>

<span class="sd">            .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cat : CategoricalIndex or None</span>
<span class="sd">            Categorical with removed categories or None if ``inplace=True``.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If new categories are list-like and do not have the same number of</span>
<span class="sd">            items than the current categories or do not validate as categories</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        reorder_categories : Reorder categories.</span>
<span class="sd">        add_categories : Add new categories.</span>
<span class="sd">        remove_categories : Remove the specified categories.</span>
<span class="sd">        remove_unused_categories : Remove categories which are not used.</span>
<span class="sd">        set_categories : Set the categories to the specified ones.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex([&quot;a&quot;, &quot;a&quot;, &quot;b&quot;])</span>
<span class="sd">        &gt;&gt;&gt; idx.rename_categories([0, 1])</span>
<span class="sd">        CategoricalIndex([0, 0, 1], categories=[0, 1], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        For dict-like ``new_categories``, extra keys are ignored and</span>
<span class="sd">        categories not in the dictionary are passed through</span>

<span class="sd">        &gt;&gt;&gt; idx.rename_categories({&#39;a&#39;: &#39;A&#39;, &#39;c&#39;: &#39;C&#39;})</span>
<span class="sd">        CategoricalIndex([&#39;A&#39;, &#39;A&#39;, &#39;b&#39;], categories=[&#39;A&#39;, &#39;b&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        You may also provide a callable to create the new categories</span>

<span class="sd">        &gt;&gt;&gt; idx.rename_categories(lambda x: x.upper())</span>
<span class="sd">        CategoricalIndex([&#39;A&#39;, &#39;A&#39;, &#39;B&#39;], categories=[&#39;A&#39;, &#39;B&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.reorder_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.reorder_categories.html#pyspark.pandas.CategoricalIndex.reorder_categories">[docs]</a>    <span class="k">def</span> <span class="nf">reorder_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span>
        <span class="n">ordered</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reorder categories as specified in new_categories.</span>

<span class="sd">        `new_categories` needs to include all old categories and no new category</span>
<span class="sd">        items.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_categories : Index-like</span>
<span class="sd">           The categories in new order.</span>
<span class="sd">        ordered : bool, optional</span>
<span class="sd">           Whether or not the categorical is treated as an ordered categorical.</span>
<span class="sd">           If not given, do not change the ordered information.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to reorder the categories inplace or return a copy of</span>
<span class="sd">           this categorical with reordered categories.</span>

<span class="sd">           .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cat : CategoricalIndex or None</span>
<span class="sd">            Categorical with removed categories or None if ``inplace=True``.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the new categories do not contain all old category items or any</span>
<span class="sd">            new ones</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        rename_categories : Rename categories.</span>
<span class="sd">        add_categories : Add new categories.</span>
<span class="sd">        remove_categories : Remove the specified categories.</span>
<span class="sd">        remove_unused_categories : Remove categories which are not used.</span>
<span class="sd">        set_categories : Set the categories to the specified ones.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.reorder_categories([&#39;c&#39;, &#39;b&#39;, &#39;a&#39;])  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;c&#39;, &#39;b&#39;, &#39;a&#39;], ordered=False, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="o">=</span><span class="n">new_categories</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.set_categories"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.set_categories.html#pyspark.pandas.CategoricalIndex.set_categories">[docs]</a>    <span class="k">def</span> <span class="nf">set_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">new_categories</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span>
        <span class="n">ordered</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">rename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;CategoricalIndex&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the categories to the specified new_categories.</span>

<span class="sd">        `new_categories` can include new categories (which will result in</span>
<span class="sd">        unused categories) or remove old categories (which results in values</span>
<span class="sd">        set to NaN). If `rename==True`, the categories will simply be renamed</span>
<span class="sd">        (less or more items than in old categories will result in values set to</span>
<span class="sd">        NaN or in unused categories respectively).</span>

<span class="sd">        This method can be used to perform more than one action of adding,</span>
<span class="sd">        removing, and reordering simultaneously and is therefore faster than</span>
<span class="sd">        performing the individual steps via the more specialised methods.</span>

<span class="sd">        On the other hand this methods does not do checks (e.g., whether the</span>
<span class="sd">        old categories are included in the new categories on a reorder), which</span>
<span class="sd">        can result in surprising changes, for example when using special string</span>
<span class="sd">        dtypes, which does not consider a S1 string equal to a single char</span>
<span class="sd">        python string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_categories : Index-like</span>
<span class="sd">           The categories in new order.</span>
<span class="sd">        ordered : bool, default False</span>
<span class="sd">           Whether or not the categorical is treated as an ordered categorical.</span>
<span class="sd">           If not given, do not change the ordered information.</span>
<span class="sd">        rename : bool, default False</span>
<span class="sd">           Whether or not the new_categories should be considered as a rename</span>
<span class="sd">           of the old categories or as reordered categories.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">           Whether or not to reorder the categories in-place or return a copy</span>
<span class="sd">           of this categorical with reordered categories.</span>

<span class="sd">           .. deprecated:: 3.2.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex with reordered categories or None if inplace.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If new_categories does not validate as categories</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        rename_categories : Rename categories.</span>
<span class="sd">        reorder_categories : Reorder categories.</span>
<span class="sd">        add_categories : Add new categories.</span>
<span class="sd">        remove_categories : Remove the specified categories.</span>
<span class="sd">        remove_unused_categories : Remove categories which are not used.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex(list(&quot;abbccc&quot;))</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.set_categories([&#39;b&#39;, &#39;c&#39;])  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([nan, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.set_categories([1, 2, 3], rename=True)</span>
<span class="sd">        CategoricalIndex([1, 2, 2, 3, 3, 3], categories=[1, 2, 3], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.set_categories([1, 2, 3], rename=True, ordered=True)</span>
<span class="sd">        CategoricalIndex([1, 2, 2, 3, 3, 3], categories=[1, 2, 3], ordered=True, dtype=&#39;category&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Argument `inplace` will be removed in 4.0.0.&quot;</span><span class="p">,</span>
                <span class="ne">FutureWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot use inplace with CategoricalIndex&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">CategoricalIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">new_categories</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="n">rename</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalIndex.map"><a class="viewcode-back" href="../../../../reference/pyspark.pandas/api/pyspark.pandas.CategoricalIndex.map.html#pyspark.pandas.CategoricalIndex.map">[docs]</a>    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mapper</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Index&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Map values using input correspondence (a dict, Series, or function).</span>

<span class="sd">        Maps the values (their categories, not the codes) of the index to new</span>
<span class="sd">        categories. If the mapping correspondence is one-to-one the result is a</span>
<span class="sd">        `CategoricalIndex` which has the same order property as the original,</span>
<span class="sd">        otherwise an `Index` is returned.</span>

<span class="sd">        If a `dict` or `Series` is used any unmapped category is mapped to missing values.</span>
<span class="sd">        Note that if this happens an `Index` will be returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mapper : function, dict, or Series</span>
<span class="sd">            Mapping correspondence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CategoricalIndex or Index</span>
<span class="sd">            Mapped index.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Index.map : Apply a mapping correspondence on an `Index`.</span>
<span class="sd">        Series.map : Apply a mapping correspondence on a `Series`</span>
<span class="sd">        Series.apply : Apply more complex functions on a `Series`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;])</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.map(lambda x: x.upper())  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;],</span>
<span class="sd">                         categories=[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; pser = pd.Series([1, 2, 3], index=pd.CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=True))</span>
<span class="sd">        &gt;&gt;&gt; idx.map(pser)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([1, 2, 3],</span>
<span class="sd">                         categories=[1, 2, 3], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.map({&#39;a&#39;: &#39;first&#39;, &#39;b&#39;: &#39;second&#39;, &#39;c&#39;: &#39;third&#39;})  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;first&#39;, &#39;second&#39;, &#39;third&#39;],</span>
<span class="sd">                         categories=[&#39;first&#39;, &#39;second&#39;, &#39;third&#39;], ordered=False, dtype=&#39;category&#39;)</span>

<span class="sd">        If the mapping is one-to-one the ordering of the categories is preserved:</span>

<span class="sd">        &gt;&gt;&gt; idx = ps.CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=True)</span>
<span class="sd">        &gt;&gt;&gt; idx  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">                         categories=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], ordered=True, dtype=&#39;category&#39;)</span>

<span class="sd">        &gt;&gt;&gt; idx.map({&#39;a&#39;: 3, &#39;b&#39;: 2, &#39;c&#39;: 1})  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        CategoricalIndex([3, 2, 1],</span>
<span class="sd">                         categories=[3, 2, 1], ordered=True, dtype=&#39;category&#39;)</span>

<span class="sd">        If the mapping is not one-to-one an `Index` is returned:</span>

<span class="sd">        &gt;&gt;&gt; idx.map({&#39;a&#39;: &#39;first&#39;, &#39;b&#39;: &#39;second&#39;, &#39;c&#39;: &#39;first&#39;})</span>
<span class="sd">        Index([&#39;first&#39;, &#39;second&#39;, &#39;first&#39;], dtype=&#39;object&#39;)</span>

<span class="sd">        If a `dict` is used, all unmapped categories are mapped to None and</span>
<span class="sd">        the result is an `Index`:</span>

<span class="sd">        &gt;&gt;&gt; idx.map({&#39;a&#39;: &#39;first&#39;, &#39;b&#39;: &#39;second&#39;})</span>
<span class="sd">        Index([&#39;first&#39;, &#39;second&#39;, None], dtype=&#39;object&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span></div>

    <span class="nd">@no_type_check</span>
    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot perform &#39;all&#39; with this index type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_test</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
    <span class="kn">import</span> <span class="nn">pyspark.pandas.indexes.category</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SPARK_HOME&quot;</span><span class="p">])</span>

    <span class="n">globs</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">globs</span><span class="p">[</span><span class="s2">&quot;ps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">pandas</span>
    <span class="n">spark</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="s2">&quot;local[4]&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;pyspark.pandas.indexes.category tests&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">failure_count</span><span class="p">,</span> <span class="n">test_count</span><span class="p">)</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span>
        <span class="n">pyspark</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
        <span class="n">globs</span><span class="o">=</span><span class="n">globs</span><span class="p">,</span>
        <span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">ELLIPSIS</span> <span class="o">|</span> <span class="n">doctest</span><span class="o">.</span><span class="n">NORMALIZE_WHITESPACE</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">failure_count</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">_test</span><span class="p">()</span>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright .<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>