
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>pyspark.resource.requests &#8212; PySpark master documentation</title>
    
    <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" href="../../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/pyspark.css" />
    
    <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="canonical" href="https://spark.apache.org/docs/latest/api/python/_modules/pyspark/resource/requests.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../index.html">
  <img src="../../../_static/spark-logo-reverse.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../index.html">
  Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../user_guide/index.html">
  User Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../reference/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../development/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../migration_guide/index.html">
  Migration Guides
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<div id="version-button" class="dropdown">
    <button type="button" class="btn btn-secondary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        3.5.1
        <span class="caret"></span>
    </button>
    <div id="version_switcher" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<script type="text/javascript">
// Function to construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://spark.apache.org/docs/{version}/api/python/index.html";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Function to check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "_modules/pyspark/resource/requests.html",
          otherDocsHomepage = event.target.getAttribute("href");
    let tryUrl = `${otherDocsHomepage}${currentFilePath}`;
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    return false;
}

// Function to populate the version switcher
(function () {
    // get JSON config
    $.getJSON("https://spark.apache.org/static/versions.json", function(data, textStatus, jqXHR) {
        // create the nodes first (before AJAX calls) to ensure the order is
        // correct (for now, links will go to doc version homepage)
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // construct the appropriate URL, and add it to the dropdown
            entry.url = buildURL(entry);
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.setAttribute("href", `${entry.url}`);
            node.textContent = `${entry.name}`;
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher").append(node);
        });
    });
})();
</script>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyspark.resource.requests</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span class="c1"># contributor license agreements.  See the NOTICE file distributed with</span>
<span class="c1"># this work for additional information regarding copyright ownership.</span>
<span class="c1"># The ASF licenses this file to You under the Apache License, Version 2.0</span>
<span class="c1"># (the &quot;License&quot;); you may not use this file except in compliance with</span>
<span class="c1"># the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">overload</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">py4j.java_gateway</span> <span class="kn">import</span> <span class="n">JavaObject</span><span class="p">,</span> <span class="n">JVMView</span>

<span class="kn">from</span> <span class="nn">pyspark.util</span> <span class="kn">import</span> <span class="n">_parse_memory</span>


<div class="viewcode-block" id="ExecutorResourceRequest"><a class="viewcode-back" href="../../../reference/api/pyspark.resource.ExecutorResourceRequest.html#pyspark.resource.ExecutorResourceRequest">[docs]</a><span class="k">class</span> <span class="nc">ExecutorResourceRequest</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An Executor resource request. This is used in conjunction with the ResourceProfile to</span>
<span class="sd">    programmatically specify the resources needed for an RDD that will be applied at the</span>
<span class="sd">    stage level.</span>

<span class="sd">    This is used to specify what the resource requirements are for an Executor and how</span>
<span class="sd">    Spark can find out specific details about those resources. Not all the parameters are</span>
<span class="sd">    required for every resource type. Resources like GPUs are supported and have same limitations</span>
<span class="sd">    as using the global spark configs spark.executor.resource.gpu.*. The amount, discoveryScript,</span>
<span class="sd">    and vendor parameters for resources are all the same parameters a user would specify through the</span>
<span class="sd">    configs: spark.executor.resource.{resourceName}.{amount, discoveryScript, vendor}.</span>

<span class="sd">    For instance, a user wants to allocate an Executor with GPU resources on YARN. The user has</span>
<span class="sd">    to specify the resource name (gpu), the amount or number of GPUs per Executor,</span>
<span class="sd">    the discovery script would be specified so that when the Executor starts up it can</span>
<span class="sd">    discovery what GPU addresses are available for it to use because YARN doesn&#39;t tell</span>
<span class="sd">    Spark that, then vendor would not be used because its specific for Kubernetes.</span>

<span class="sd">    See the configuration and cluster specific docs for more details.</span>

<span class="sd">    Use :class:`pyspark.ExecutorResourceRequests` class as a convenience API.</span>

<span class="sd">    .. versionadded:: 3.1.0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    resourceName : str</span>
<span class="sd">        Name of the resource</span>
<span class="sd">    amount : str</span>
<span class="sd">        Amount requesting</span>
<span class="sd">    discoveryScript : str, optional</span>
<span class="sd">        Optional script used to discover the resources. This is required on some</span>
<span class="sd">        cluster managers that don&#39;t tell Spark the addresses of the resources</span>
<span class="sd">        allocated. The script runs on Executors startup to discover the addresses</span>
<span class="sd">        of the resources available.</span>
<span class="sd">    vendor : str, optional</span>
<span class="sd">        Vendor, required for some cluster managers</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfile`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This API is evolving.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">resourceName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">discoveryScript</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vendor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">resourceName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span> <span class="o">=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_discovery_script</span> <span class="o">=</span> <span class="n">discoveryScript</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vendor</span> <span class="o">=</span> <span class="n">vendor</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">resourceName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Name of the resource</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">amount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Amount requesting</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">discoveryScript</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Amount requesting</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discovery_script</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vendor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Vendor, required for some cluster managers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vendor</span></div>


<div class="viewcode-block" id="ExecutorResourceRequests"><a class="viewcode-back" href="../../../reference/api/pyspark.resource.ExecutorResourceRequests.html#pyspark.resource.ExecutorResourceRequests">[docs]</a><span class="k">class</span> <span class="nc">ExecutorResourceRequests</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of Executor resource requests. This is used in conjunction with the</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfileBuilder` to programmatically specify the</span>
<span class="sd">    resources needed for an RDD that will be applied at the stage level.</span>

<span class="sd">    .. versionadded:: 3.1.0</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfile`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This API is evolving.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_CORES</span> <span class="o">=</span> <span class="s2">&quot;cores&quot;</span>
    <span class="n">_MEMORY</span> <span class="o">=</span> <span class="s2">&quot;memory&quot;</span>
    <span class="n">_OVERHEAD_MEM</span> <span class="o">=</span> <span class="s2">&quot;memoryOverhead&quot;</span>
    <span class="n">_PYSPARK_MEM</span> <span class="o">=</span> <span class="s2">&quot;pyspark.memory&quot;</span>
    <span class="n">_OFFHEAP_MEM</span> <span class="o">=</span> <span class="s2">&quot;offHeap&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_jvm</span><span class="p">:</span> <span class="n">JVMView</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">_jvm</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">_requests</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExecutorResourceRequest</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">_jvm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVMView</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_requests</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExecutorResourceRequest</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkContext</span>

        <span class="n">_jvm</span> <span class="o">=</span> <span class="n">_jvm</span> <span class="ow">or</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_jvm</span>
        <span class="k">if</span> <span class="n">_jvm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">ExecutorResourceRequests</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MEMORY</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">memory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_OVERHEAD_MEM</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">memoryOverhead</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PYSPARK_MEM</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">pysparkMemory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CORES</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">cores</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
                            <span class="n">v</span><span class="o">.</span><span class="n">resourceName</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">discoveryScript</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">vendor</span>
                        <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExecutorResourceRequest</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify heap memory. The value specified will be converted to MiB.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for &quot;memory&quot; resource.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : str</span>
<span class="sd">            Amount of memory. In the same format as JVM memory strings (e.g. 512m, 2g).</span>
<span class="sd">            Default unit is MiB if not specified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">memory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_MEMORY</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_MEMORY</span><span class="p">,</span> <span class="n">_parse_memory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">memoryOverhead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify overhead memory. The value specified will be converted to MiB.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for &quot;memoryOverhead&quot;</span>
<span class="sd">        resource.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : str</span>
<span class="sd">            Amount of memory. In the same format as JVM memory strings (e.g. 512m, 2g).</span>
<span class="sd">            Default unit is MiB if not specified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">memoryOverhead</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_OVERHEAD_MEM</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_OVERHEAD_MEM</span><span class="p">,</span> <span class="n">_parse_memory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">pysparkMemory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify pyspark memory. The value specified will be converted to MiB.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for &quot;pyspark.memory&quot;</span>
<span class="sd">        resource.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : str</span>
<span class="sd">            Amount of memory. In the same format as JVM memory strings (e.g. 512m, 2g).</span>
<span class="sd">            Default unit is MiB if not specified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">pysparkMemory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_PYSPARK_MEM</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_PYSPARK_MEM</span><span class="p">,</span> <span class="n">_parse_memory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">offheapMemory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify off heap memory. The value specified will be converted to MiB.</span>
<span class="sd">        This value only take effect when MEMORY_OFFHEAP_ENABLED is true.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for &quot;offHeap&quot;</span>
<span class="sd">        resource.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : str</span>
<span class="sd">            Amount of memory. In the same format as JVM memory strings (e.g. 512m, 2g).</span>
<span class="sd">            Default unit is MiB if not specified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">offHeapMemory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_OFFHEAP_MEM</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_OFFHEAP_MEM</span><span class="p">,</span> <span class="n">_parse_memory</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">cores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify number of cores per Executor.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for &quot;cores&quot; resource.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : int</span>
<span class="sd">            Number of cores to allocate per Executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">cores</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_CORES</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CORES</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">resource</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">resourceName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">discoveryScript</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vendor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutorResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Amount of a particular custom resource(GPU, FPGA, etc) to use. The resource names supported</span>
<span class="sd">        correspond to the regular Spark configs with the prefix removed. For instance, resources</span>
<span class="sd">        like GPUs are gpu (spark configs `spark.executor.resource.gpu.*`). If you pass in a resource</span>
<span class="sd">        that the cluster manager doesn&#39;t support the result is undefined, it may error or may just</span>
<span class="sd">        be ignored.</span>
<span class="sd">        This is a convenient API to add :class:`ExecutorResourceRequest` for custom resources.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        resourceName : str</span>
<span class="sd">            Name of the resource.</span>
<span class="sd">        amount : str</span>
<span class="sd">            amount of that resource per executor to use.</span>
<span class="sd">        discoveryScript : str, optional</span>
<span class="sd">            Optional script used to discover the resources. This is required on</span>
<span class="sd">            some cluster managers that don&#39;t tell Spark the addresses of</span>
<span class="sd">            the resources allocated. The script runs on Executors startup to</span>
<span class="sd">            of the resources available.</span>
<span class="sd">        vendor : str</span>
<span class="sd">            Optional vendor, required for some cluster managers</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`ExecutorResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
                <span class="n">resourceName</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">discoveryScript</span><span class="p">,</span> <span class="n">vendor</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span><span class="p">[</span><span class="n">resourceName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                <span class="n">resourceName</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">discoveryScript</span><span class="p">,</span> <span class="n">vendor</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExecutorResourceRequest</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Returns all the resource requests for the executor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">execRes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_executor_resource_requests</span><span class="o">.</span><span class="n">requestsJMap</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">execRes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExecutorResourceRequest</span><span class="p">(</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">resourceName</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">discoveryScript</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">vendor</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executor_resources</span></div>


<div class="viewcode-block" id="TaskResourceRequest"><a class="viewcode-back" href="../../../reference/api/pyspark.resource.TaskResourceRequest.html#pyspark.resource.TaskResourceRequest">[docs]</a><span class="k">class</span> <span class="nc">TaskResourceRequest</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A task resource request. This is used in conjunction with the</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfile` to programmatically specify the resources</span>
<span class="sd">    needed for an RDD that will be applied at the stage level. The amount is specified</span>
<span class="sd">    as a float to allow for saying you want more than 1 task per resource. Valid values</span>
<span class="sd">    are less than or equal to 0.5 or whole numbers.</span>
<span class="sd">    Use :class:`pyspark.resource.TaskResourceRequests` class as a convenience API.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    resourceName : str</span>
<span class="sd">        Name of the resource</span>
<span class="sd">    amount : float</span>
<span class="sd">        Amount requesting as a float to support fractional resource requests.</span>
<span class="sd">        Valid values are less than or equal to 0.5 or whole numbers. This essentially</span>
<span class="sd">        lets you configure X number of tasks to run on a single resource,</span>
<span class="sd">        ie amount equals 0.5 translates into 2 tasks per resource address.</span>

<span class="sd">    .. versionadded:: 3.1.0</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfile`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This API is evolving.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resourceName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">resourceName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">resourceName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Name of the resource.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">amount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Amount requesting as a float to support fractional resource requests.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span></div>


<div class="viewcode-block" id="TaskResourceRequests"><a class="viewcode-back" href="../../../reference/api/pyspark.resource.TaskResourceRequests.html#pyspark.resource.TaskResourceRequests">[docs]</a><span class="k">class</span> <span class="nc">TaskResourceRequests</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of task resource requests. This is used in conjunction with the</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfileBuilder` to programmatically specify the resources</span>
<span class="sd">    needed for an RDD that will be applied at the stage level.</span>

<span class="sd">    .. versionadded:: 3.1.0</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`pyspark.resource.ResourceProfile`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This API is evolving.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_CPUS</span> <span class="o">=</span> <span class="s2">&quot;cpus&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_jvm</span><span class="p">:</span> <span class="n">JVMView</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">_jvm</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">_requests</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TaskResourceRequest</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">_jvm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVMView</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_requests</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TaskResourceRequest</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkContext</span>

        <span class="n">_jvm</span> <span class="o">=</span> <span class="n">_jvm</span> <span class="ow">or</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_jvm</span>
        <span class="k">if</span> <span class="n">_jvm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
                <span class="n">JavaObject</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">TaskResourceRequests</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CPUS</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="o">.</span><span class="n">cpus</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">resourceName</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_task_resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TaskResourceRequest</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">cpus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TaskResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify number of cpus per Task.</span>
<span class="sd">        This is a convenient API to add :class:`TaskResourceRequest` for cpus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amount : int</span>
<span class="sd">            Number of cpus to allocate per Task.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TaskResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="o">.</span><span class="n">cpus</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_task_resources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_CPUS</span><span class="p">]</span> <span class="o">=</span> <span class="n">TaskResourceRequest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CPUS</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resourceName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TaskResourceRequests&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Amount of a particular custom resource(GPU, FPGA, etc) to use.</span>
<span class="sd">        This is a convenient API to add :class:`TaskResourceRequest` for custom resources.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        resourceName : str</span>
<span class="sd">            Name of the resource.</span>
<span class="sd">        amount : float</span>
<span class="sd">            Amount requesting as a float to support fractional resource requests.</span>
<span class="sd">            Valid values are less than or equal to 0.5 or whole numbers. This essentially</span>
<span class="sd">            lets you configure X number of tasks to run on a single resource,</span>
<span class="sd">            ie amount equals 0.5 translates into 2 tasks per resource address.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TaskResourceRequests`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="n">resourceName</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">amount</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_task_resources</span><span class="p">[</span><span class="n">resourceName</span><span class="p">]</span> <span class="o">=</span> <span class="n">TaskResourceRequest</span><span class="p">(</span><span class="n">resourceName</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TaskResourceRequest</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Returns all the resource requests for the task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">taskRes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_java_task_resource_requests</span><span class="o">.</span><span class="n">requestsJMap</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">taskRes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">TaskResourceRequest</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">resourceName</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">amount</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_task_resources</span></div>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright .<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>