
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyspark.ml.classification &#8212; PySpark 2.4.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/pyspark.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/pyspark.js"></script>
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-0"><a href="../../../index.html">PySpark 2.4.1 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyspark.ml.classification</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span class="c1"># contributor license agreements.  See the NOTICE file distributed with</span>
<span class="c1"># this work for additional information regarding copyright ownership.</span>
<span class="c1"># The ASF licenses this file to You under the Apache License, Version 2.0</span>
<span class="c1"># (the &quot;License&quot;); you may not use this file except in compliance with</span>
<span class="c1"># the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">multiprocessing.pool</span> <span class="k">import</span> <span class="n">ThreadPool</span>

<span class="kn">from</span> <span class="nn">pyspark</span> <span class="k">import</span> <span class="n">since</span><span class="p">,</span> <span class="n">keyword_only</span>
<span class="kn">from</span> <span class="nn">pyspark.ml</span> <span class="k">import</span> <span class="n">Estimator</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.param.shared</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.regression</span> <span class="k">import</span> <span class="n">DecisionTreeModel</span><span class="p">,</span> <span class="n">DecisionTreeRegressionModel</span><span class="p">,</span> \
    <span class="n">RandomForestParams</span><span class="p">,</span> <span class="n">TreeEnsembleModel</span><span class="p">,</span> <span class="n">TreeEnsembleParams</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.util</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.wrapper</span> <span class="k">import</span> <span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">JavaModel</span><span class="p">,</span> <span class="n">JavaParams</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.wrapper</span> <span class="k">import</span> <span class="n">JavaWrapper</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.common</span> <span class="k">import</span> <span class="n">inherit_doc</span><span class="p">,</span> <span class="n">_java2py</span><span class="p">,</span> <span class="n">_py2java</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="k">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="k">import</span> <span class="n">udf</span><span class="p">,</span> <span class="n">when</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="k">import</span> <span class="n">ArrayType</span><span class="p">,</span> <span class="n">DoubleType</span>
<span class="kn">from</span> <span class="nn">pyspark.storagelevel</span> <span class="k">import</span> <span class="n">StorageLevel</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LinearSVC&#39;</span><span class="p">,</span> <span class="s1">&#39;LinearSVCModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;LogisticRegression&#39;</span><span class="p">,</span> <span class="s1">&#39;LogisticRegressionModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;LogisticRegressionSummary&#39;</span><span class="p">,</span> <span class="s1">&#39;LogisticRegressionTrainingSummary&#39;</span><span class="p">,</span>
           <span class="s1">&#39;BinaryLogisticRegressionSummary&#39;</span><span class="p">,</span> <span class="s1">&#39;BinaryLogisticRegressionTrainingSummary&#39;</span><span class="p">,</span>
           <span class="s1">&#39;DecisionTreeClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;DecisionTreeClassificationModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;GBTClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;GBTClassificationModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;RandomForestClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomForestClassificationModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;NaiveBayes&#39;</span><span class="p">,</span> <span class="s1">&#39;NaiveBayesModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;MultilayerPerceptronClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;MultilayerPerceptronClassificationModel&#39;</span><span class="p">,</span>
           <span class="s1">&#39;OneVsRest&#39;</span><span class="p">,</span> <span class="s1">&#39;OneVsRestModel&#39;</span><span class="p">]</span>


<span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">JavaClassificationModel</span><span class="p">(</span><span class="n">JavaPredictionModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    (Private) Java Model produced by a ``Classifier``.</span>
<span class="sd">    Classes are indexed {0, 1, ..., numClasses - 1}.</span>
<span class="sd">    To be mixed in with class:`pyspark.ml.JavaModel`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">numClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of classes (values which the label can take).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;numClasses&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="LinearSVC"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LinearSVC">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">LinearSVC</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span> <span class="n">HasMaxIter</span><span class="p">,</span>
                <span class="n">HasRegParam</span><span class="p">,</span> <span class="n">HasTol</span><span class="p">,</span> <span class="n">HasRawPredictionCol</span><span class="p">,</span> <span class="n">HasFitIntercept</span><span class="p">,</span> <span class="n">HasStandardization</span><span class="p">,</span>
                <span class="n">HasWeightCol</span><span class="p">,</span> <span class="n">HasAggregationDepth</span><span class="p">,</span> <span class="n">HasThreshold</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    `Linear SVM Classifier &lt;https://en.wikipedia.org/wiki/Support_vector_machine#Linear_SVM&gt;`_</span>

<span class="sd">    This binary classifier optimizes the Hinge Loss using the OWLQN optimizer.</span>
<span class="sd">    Only supports L2 regularization currently.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.sql import Row</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; df = sc.parallelize([</span>
<span class="sd">    ...     Row(label=1.0, features=Vectors.dense(1.0, 1.0, 1.0)),</span>
<span class="sd">    ...     Row(label=0.0, features=Vectors.dense(1.0, 2.0, 3.0))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; svm = LinearSVC(maxIter=5, regParam=0.01)</span>
<span class="sd">    &gt;&gt;&gt; model = svm.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; model.coefficients</span>
<span class="sd">    DenseVector([0.0, -0.2792, -0.1833])</span>
<span class="sd">    &gt;&gt;&gt; model.intercept</span>
<span class="sd">    1.0206118982229047</span>
<span class="sd">    &gt;&gt;&gt; model.numClasses</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; model.numFeatures</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; test0 = sc.parallelize([Row(features=Vectors.dense(-1.0, -1.0, -1.0))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; result.rawPrediction</span>
<span class="sd">    DenseVector([-1.4831, 1.4831])</span>
<span class="sd">    &gt;&gt;&gt; svm_path = temp_path + &quot;/svm&quot;</span>
<span class="sd">    &gt;&gt;&gt; svm.save(svm_path)</span>
<span class="sd">    &gt;&gt;&gt; svm2 = LinearSVC.load(svm_path)</span>
<span class="sd">    &gt;&gt;&gt; svm2.getMaxIter()</span>
<span class="sd">    5</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/svm_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = LinearSVCModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.coefficients[0] == model2.coefficients[0]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model.intercept == model2.intercept</span>
<span class="sd">    True</span>

<span class="sd">    .. versionadded:: 2.2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">threshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;The threshold in binary classification applied to the linear model&quot;</span>
                      <span class="s2">&quot; prediction.  This threshold can be any real number, where Inf will make&quot;</span>
                      <span class="s2">&quot; all predictions 0.0 and -Inf will make all predictions 1.0.&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                 <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">standardization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">aggregationDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 maxIter=100, regParam=0.0, tol=1e-6, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                 fitIntercept=True, standardization=True, threshold=0.0, weightCol=None, \</span>
<span class="sd">                 aggregationDepth=2):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.LinearSVC&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">standardization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">aggregationDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="LinearSVC.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LinearSVC.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.2.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                  <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">standardization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">aggregationDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  maxIter=100, regParam=0.0, tol=1e-6, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                  fitIntercept=True, standardization=True, threshold=0.0, weightCol=None, \</span>
<span class="sd">                  aggregationDepth=2):</span>
<span class="sd">        Sets params for Linear SVM Classifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LinearSVCModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="LinearSVCModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LinearSVCModel">[docs]</a><span class="k">class</span> <span class="nc">LinearSVCModel</span><span class="p">(</span><span class="n">JavaModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Model fitted by LinearSVC.</span>

<span class="sd">    .. versionadded:: 2.2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.2.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model coefficients of Linear SVM Classifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;coefficients&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.2.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model intercept of Linear SVM Classifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="LogisticRegression"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">LogisticRegression</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span> <span class="n">HasMaxIter</span><span class="p">,</span>
                         <span class="n">HasRegParam</span><span class="p">,</span> <span class="n">HasTol</span><span class="p">,</span> <span class="n">HasProbabilityCol</span><span class="p">,</span> <span class="n">HasRawPredictionCol</span><span class="p">,</span>
                         <span class="n">HasElasticNetParam</span><span class="p">,</span> <span class="n">HasFitIntercept</span><span class="p">,</span> <span class="n">HasStandardization</span><span class="p">,</span> <span class="n">HasThresholds</span><span class="p">,</span>
                         <span class="n">HasWeightCol</span><span class="p">,</span> <span class="n">HasAggregationDepth</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logistic regression.</span>
<span class="sd">    This class supports multinomial logistic (softmax) and binomial logistic regression.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.sql import Row</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; bdf = sc.parallelize([</span>
<span class="sd">    ...     Row(label=1.0, weight=1.0, features=Vectors.dense(0.0, 5.0)),</span>
<span class="sd">    ...     Row(label=0.0, weight=2.0, features=Vectors.dense(1.0, 2.0)),</span>
<span class="sd">    ...     Row(label=1.0, weight=3.0, features=Vectors.dense(2.0, 1.0)),</span>
<span class="sd">    ...     Row(label=0.0, weight=4.0, features=Vectors.dense(3.0, 3.0))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; blor = LogisticRegression(regParam=0.01, weightCol=&quot;weight&quot;)</span>
<span class="sd">    &gt;&gt;&gt; blorModel = blor.fit(bdf)</span>
<span class="sd">    &gt;&gt;&gt; blorModel.coefficients</span>
<span class="sd">    DenseVector([-1.080..., -0.646...])</span>
<span class="sd">    &gt;&gt;&gt; blorModel.intercept</span>
<span class="sd">    3.112...</span>
<span class="sd">    &gt;&gt;&gt; data_path = &quot;data/mllib/sample_multiclass_classification_data.txt&quot;</span>
<span class="sd">    &gt;&gt;&gt; mdf = spark.read.format(&quot;libsvm&quot;).load(data_path)</span>
<span class="sd">    &gt;&gt;&gt; mlor = LogisticRegression(regParam=0.1, elasticNetParam=1.0, family=&quot;multinomial&quot;)</span>
<span class="sd">    &gt;&gt;&gt; mlorModel = mlor.fit(mdf)</span>
<span class="sd">    &gt;&gt;&gt; mlorModel.coefficientMatrix</span>
<span class="sd">    SparseMatrix(3, 4, [0, 1, 2, 3], [3, 2, 1], [1.87..., -2.75..., -0.50...], 1)</span>
<span class="sd">    &gt;&gt;&gt; mlorModel.interceptVector</span>
<span class="sd">    DenseVector([0.04..., -0.42..., 0.37...])</span>
<span class="sd">    &gt;&gt;&gt; test0 = sc.parallelize([Row(features=Vectors.dense(-1.0, 1.0))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; result = blorModel.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; result.probability</span>
<span class="sd">    DenseVector([0.02..., 0.97...])</span>
<span class="sd">    &gt;&gt;&gt; result.rawPrediction</span>
<span class="sd">    DenseVector([-3.54..., 3.54...])</span>
<span class="sd">    &gt;&gt;&gt; test1 = sc.parallelize([Row(features=Vectors.sparse(2, [0], [1.0]))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; blorModel.transform(test1).head().prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; blor.setParams(&quot;vector&quot;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    TypeError: Method setParams forces keyword arguments.</span>
<span class="sd">    &gt;&gt;&gt; lr_path = temp_path + &quot;/lr&quot;</span>
<span class="sd">    &gt;&gt;&gt; blor.save(lr_path)</span>
<span class="sd">    &gt;&gt;&gt; lr2 = LogisticRegression.load(lr_path)</span>
<span class="sd">    &gt;&gt;&gt; lr2.getRegParam()</span>
<span class="sd">    0.01</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/lr_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; blorModel.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = LogisticRegressionModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; blorModel.coefficients[0] == model2.coefficients[0]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; blorModel.intercept == model2.intercept</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model2</span>
<span class="sd">    LogisticRegressionModel: uid = ..., numClasses = 2, numFeatures = 2</span>

<span class="sd">    .. versionadded:: 1.3.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">threshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Threshold in binary classification prediction, in range [0, 1].&quot;</span> <span class="o">+</span>
                      <span class="s2">&quot; If threshold and thresholds are both set, they must match.&quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;e.g. if threshold is p, then thresholds must be equal to [1-p, p].&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">family</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;The name of family which is a description of the label distribution to &quot;</span> <span class="o">+</span>
                   <span class="s2">&quot;be used in the model. Supported options: auto, binomial, multinomial&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">lowerBoundsOnCoefficients</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;lowerBoundsOnCoefficients&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;The lower bounds on coefficients if fitting under bound &quot;</span>
                                      <span class="s2">&quot;constrained optimization. The bound matrix must be &quot;</span>
                                      <span class="s2">&quot;compatible with the shape &quot;</span>
                                      <span class="s2">&quot;(1, number of features) for binomial regression, or &quot;</span>
                                      <span class="s2">&quot;(number of classes, number of features) &quot;</span>
                                      <span class="s2">&quot;for multinomial regression.&quot;</span><span class="p">,</span>
                                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">)</span>

    <span class="n">upperBoundsOnCoefficients</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;upperBoundsOnCoefficients&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;The upper bounds on coefficients if fitting under bound &quot;</span>
                                      <span class="s2">&quot;constrained optimization. The bound matrix must be &quot;</span>
                                      <span class="s2">&quot;compatible with the shape &quot;</span>
                                      <span class="s2">&quot;(1, number of features) for binomial regression, or &quot;</span>
                                      <span class="s2">&quot;(number of classes, number of features) &quot;</span>
                                      <span class="s2">&quot;for multinomial regression.&quot;</span><span class="p">,</span>
                                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">)</span>

    <span class="n">lowerBoundsOnIntercepts</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;lowerBoundsOnIntercepts&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;The lower bounds on intercepts if fitting under bound &quot;</span>
                                    <span class="s2">&quot;constrained optimization. The bounds vector size must be&quot;</span>
                                    <span class="s2">&quot;equal with 1 for binomial regression, or the number of&quot;</span>
                                    <span class="s2">&quot;lasses for multinomial regression.&quot;</span><span class="p">,</span>
                                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toVector</span><span class="p">)</span>

    <span class="n">upperBoundsOnIntercepts</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;upperBoundsOnIntercepts&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;The upper bounds on intercepts if fitting under bound &quot;</span>
                                    <span class="s2">&quot;constrained optimization. The bound vector size must be &quot;</span>
                                    <span class="s2">&quot;equal with 1 for binomial regression, or the number of &quot;</span>
                                    <span class="s2">&quot;classes for multinomial regression.&quot;</span><span class="p">,</span>
                                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toVector</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">elasticNetParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span>
                 <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span> <span class="n">standardization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">aggregationDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                 <span class="n">lowerBoundsOnCoefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upperBoundsOnCoefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">lowerBoundsOnIntercepts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upperBoundsOnIntercepts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 maxIter=100, regParam=0.0, elasticNetParam=0.0, tol=1e-6, fitIntercept=True, \</span>
<span class="sd">                 threshold=0.5, thresholds=None, probabilityCol=&quot;probability&quot;, \</span>
<span class="sd">                 rawPredictionCol=&quot;rawPrediction&quot;, standardization=True, weightCol=None, \</span>
<span class="sd">                 aggregationDepth=2, family=&quot;auto&quot;, \</span>
<span class="sd">                 lowerBoundsOnCoefficients=None, upperBoundsOnCoefficients=None, \</span>
<span class="sd">                 lowerBoundsOnIntercepts=None, upperBoundsOnIntercepts=None):</span>
<span class="sd">        If the threshold and thresholds Params are both set, they must be equivalent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.LogisticRegression&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1E-6</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkThresholdConsistency</span><span class="p">()</span>

<div class="viewcode-block" id="LogisticRegression.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">regParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">elasticNetParam</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span>
                  <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span> <span class="n">standardization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">aggregationDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                  <span class="n">lowerBoundsOnCoefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upperBoundsOnCoefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">lowerBoundsOnIntercepts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upperBoundsOnIntercepts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  maxIter=100, regParam=0.0, elasticNetParam=0.0, tol=1e-6, fitIntercept=True, \</span>
<span class="sd">                  threshold=0.5, thresholds=None, probabilityCol=&quot;probability&quot;, \</span>
<span class="sd">                  rawPredictionCol=&quot;rawPrediction&quot;, standardization=True, weightCol=None, \</span>
<span class="sd">                  aggregationDepth=2, family=&quot;auto&quot;, \</span>
<span class="sd">                  lowerBoundsOnCoefficients=None, upperBoundsOnCoefficients=None, \</span>
<span class="sd">                  lowerBoundsOnIntercepts=None, upperBoundsOnIntercepts=None):</span>
<span class="sd">        Sets params for logistic regression.</span>
<span class="sd">        If the threshold and thresholds Params are both set, they must be equivalent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkThresholdConsistency</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LogisticRegressionModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="LogisticRegression.setThreshold"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setThreshold">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`threshold`.</span>
<span class="sd">        Clears value of :py:attr:`thresholds` if it has been set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="LogisticRegression.getThreshold"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getThreshold">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get threshold for binary classification.</span>

<span class="sd">        If :py:attr:`thresholds` is set with length 2 (i.e., binary classification),</span>
<span class="sd">        this returns the equivalent threshold:</span>
<span class="sd">        :math:`\\frac{1}{1 + \\frac{thresholds(0)}{thresholds(1)}}`.</span>
<span class="sd">        Otherwise, returns :py:attr:`threshold` if set or its default value if unset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkThresholdConsistency</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Logistic Regression getThreshold only applies to&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; binary classification, but thresholds has length != 2.&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot;  thresholds: &quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">ts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.setThresholds"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setThresholds">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setThresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`thresholds`.</span>
<span class="sd">        Clears value of :py:attr:`threshold` if it has been set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">thresholds</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="LogisticRegression.getThresholds"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getThresholds">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getThresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If :py:attr:`thresholds` is set, return its value.</span>
<span class="sd">        Otherwise, if :py:attr:`threshold` is set, return the equivalent thresholds for binary</span>
<span class="sd">        classification: (1-threshold, threshold).</span>
<span class="sd">        If neither are set, throw an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkThresholdConsistency</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_checkThresholdConsistency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Logistic Regression getThreshold only applies to&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; binary classification, but thresholds has length != 2.&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; thresholds: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ts</span><span class="p">)))</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">ts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1E-5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Logistic Regression getThreshold found inconsistent values for&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; threshold (</span><span class="si">%g</span><span class="s2">) and thresholds (equivalent to </span><span class="si">%g</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

<div class="viewcode-block" id="LogisticRegression.setFamily"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setFamily">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setFamily</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`family`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.getFamily"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getFamily">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getFamily</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of :py:attr:`family` or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.setLowerBoundsOnCoefficients"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setLowerBoundsOnCoefficients">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setLowerBoundsOnCoefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`lowerBoundsOnCoefficients`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lowerBoundsOnCoefficients</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.getLowerBoundsOnCoefficients"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getLowerBoundsOnCoefficients">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getLowerBoundsOnCoefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of :py:attr:`lowerBoundsOnCoefficients`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowerBoundsOnCoefficients</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.setUpperBoundsOnCoefficients"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setUpperBoundsOnCoefficients">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setUpperBoundsOnCoefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`upperBoundsOnCoefficients`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">upperBoundsOnCoefficients</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.getUpperBoundsOnCoefficients"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getUpperBoundsOnCoefficients">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getUpperBoundsOnCoefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of :py:attr:`upperBoundsOnCoefficients`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upperBoundsOnCoefficients</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.setLowerBoundsOnIntercepts"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setLowerBoundsOnIntercepts">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setLowerBoundsOnIntercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`lowerBoundsOnIntercepts`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lowerBoundsOnIntercepts</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.getLowerBoundsOnIntercepts"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getLowerBoundsOnIntercepts">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getLowerBoundsOnIntercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of :py:attr:`lowerBoundsOnIntercepts`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowerBoundsOnIntercepts</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.setUpperBoundsOnIntercepts"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.setUpperBoundsOnIntercepts">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setUpperBoundsOnIntercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`upperBoundsOnIntercepts`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">upperBoundsOnIntercepts</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="LogisticRegression.getUpperBoundsOnIntercepts"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegression.getUpperBoundsOnIntercepts">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getUpperBoundsOnIntercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of :py:attr:`upperBoundsOnIntercepts`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upperBoundsOnIntercepts</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="LogisticRegressionModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionModel">[docs]</a><span class="k">class</span> <span class="nc">LogisticRegressionModel</span><span class="p">(</span><span class="n">JavaModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by LogisticRegression.</span>

<span class="sd">    .. versionadded:: 1.3.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model coefficients of binomial logistic regression.</span>
<span class="sd">        An exception is thrown in the case of multinomial logistic regression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;coefficients&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model intercept of binomial logistic regression.</span>
<span class="sd">        An exception is thrown in the case of multinomial logistic regression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coefficientMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model coefficients.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;coefficientMatrix&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">interceptVector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model intercept.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;interceptVector&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets summary (e.g. accuracy/precision/recall, objective history, total iterations) of model</span>
<span class="sd">        trained on the training set. An exception is thrown if `trainingSummary is None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasSummary</span><span class="p">:</span>
            <span class="n">java_lrt_summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numClasses</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">BinaryLogisticRegressionTrainingSummary</span><span class="p">(</span><span class="n">java_lrt_summary</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">LogisticRegressionTrainingSummary</span><span class="p">(</span><span class="n">java_lrt_summary</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No training summary available for this </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                               <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">hasSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicates whether a training summary exists for this model</span>
<span class="sd">        instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;hasSummary&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="LogisticRegressionModel.evaluate"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionModel.evaluate">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates the model on a test dataset.</span>

<span class="sd">        :param dataset:</span>
<span class="sd">          Test dataset to evaluate model on, where dataset is an</span>
<span class="sd">          instance of :py:class:`pyspark.sql.DataFrame`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dataset must be a DataFrame but got </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
        <span class="n">java_blr_summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;evaluate&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">BinaryLogisticRegressionSummary</span><span class="p">(</span><span class="n">java_blr_summary</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;toString&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="LogisticRegressionSummary"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionSummary">[docs]</a><span class="k">class</span> <span class="nc">LogisticRegressionSummary</span><span class="p">(</span><span class="n">JavaWrapper</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Abstraction for Logistic Regression Results for a given model.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dataframe outputted by the model&#39;s `transform` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;predictions&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">probabilityCol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Field in &quot;predictions&quot; which gives the probability</span>
<span class="sd">        of each class as a vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;probabilityCol&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predictionCol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Field in &quot;predictions&quot; which gives the prediction of each class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;predictionCol&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">labelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Field in &quot;predictions&quot; which gives the true label of each</span>
<span class="sd">        instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;labelCol&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">featuresCol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Field in &quot;predictions&quot; which gives the features of each instance</span>
<span class="sd">        as a vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;featuresCol&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the sequence of labels in ascending order. This order matches the order used</span>
<span class="sd">        in metrics which are specified as arrays over labels, e.g., truePositiveRateByLabel.</span>

<span class="sd">        Note: In most cases, it will be values {0.0, 1.0, ..., numClasses-1}, However, if the</span>
<span class="sd">        training set is missing a label, then all of the arrays over labels</span>
<span class="sd">        (e.g., from truePositiveRateByLabel) will be of length numClasses-1 instead of the</span>
<span class="sd">        expected numClasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">truePositiveRateByLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns true positive rate for each label (category).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;truePositiveRateByLabel&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">falsePositiveRateByLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns false positive rate for each label (category).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;falsePositiveRateByLabel&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">precisionByLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns precision for each label (category).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;precisionByLabel&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">recallByLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns recall for each label (category).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;recallByLabel&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="LogisticRegressionSummary.fMeasureByLabel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionSummary.fMeasureByLabel">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fMeasureByLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns f-measure for each label (category).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;fMeasureByLabel&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns accuracy.</span>
<span class="sd">        (equals to the total number of correctly classified instances</span>
<span class="sd">        out of the total number of instances.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weightedTruePositiveRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns weighted true positive rate.</span>
<span class="sd">        (equals to precision, recall and f-measure)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weightedTruePositiveRate&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weightedFalsePositiveRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns weighted false positive rate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weightedFalsePositiveRate&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weightedRecall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns weighted averaged recall.</span>
<span class="sd">        (equals to precision, recall and f-measure)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weightedRecall&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weightedPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns weighted averaged precision.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weightedPrecision&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="LogisticRegressionSummary.weightedFMeasure"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionSummary.weightedFMeasure">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.3.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weightedFMeasure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns weighted averaged f-measure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weightedFMeasure&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="LogisticRegressionTrainingSummary"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.LogisticRegressionTrainingSummary">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">LogisticRegressionTrainingSummary</span><span class="p">(</span><span class="n">LogisticRegressionSummary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Abstraction for multinomial Logistic Regression Training results.</span>
<span class="sd">    Currently, the training summary ignores the training weights except</span>
<span class="sd">    for the objective trace.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">objectiveHistory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Objective function (scaled loss + regularization) at each</span>
<span class="sd">        iteration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;objectiveHistory&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">totalIterations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of training iterations until termination.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;totalIterations&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BinaryLogisticRegressionSummary"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.BinaryLogisticRegressionSummary">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">BinaryLogisticRegressionSummary</span><span class="p">(</span><span class="n">LogisticRegressionSummary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Binary Logistic regression results for a given model.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">roc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the receiver operating characteristic (ROC) curve,</span>
<span class="sd">        which is a Dataframe having two fields (FPR, TPR) with</span>
<span class="sd">        (0.0, 0.0) prepended and (1.0, 1.0) appended to it.</span>

<span class="sd">        .. seealso:: `Wikipedia reference</span>
<span class="sd">            &lt;http://en.wikipedia.org/wiki/Receiver_operating_characteristic&gt;`_</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;roc&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">areaUnderROC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the area under the receiver operating characteristic</span>
<span class="sd">        (ROC) curve.</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;areaUnderROC&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">pr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the precision-recall curve, which is a Dataframe</span>
<span class="sd">        containing two fields recall, precision with (0.0, 1.0) prepended</span>
<span class="sd">        to it.</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;pr&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fMeasureByThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dataframe with two fields (threshold, F-Measure) curve</span>
<span class="sd">        with beta = 1.0.</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;fMeasureByThreshold&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">precisionByThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dataframe with two fields (threshold, precision) curve.</span>
<span class="sd">        Every possible probability obtained in transforming the dataset</span>
<span class="sd">        are used as thresholds used in calculating the precision.</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;precisionByThreshold&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">recallByThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dataframe with two fields (threshold, recall) curve.</span>
<span class="sd">        Every possible probability obtained in transforming the dataset</span>
<span class="sd">        are used as thresholds used in calculating the recall.</span>

<span class="sd">        .. note:: This ignores instance weights (setting all to 1.0) from</span>
<span class="sd">            `LogisticRegression.weightCol`. This will change in later Spark</span>
<span class="sd">            versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;recallByThreshold&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BinaryLogisticRegressionTrainingSummary"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.BinaryLogisticRegressionTrainingSummary">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">BinaryLogisticRegressionTrainingSummary</span><span class="p">(</span><span class="n">BinaryLogisticRegressionSummary</span><span class="p">,</span>
                                              <span class="n">LogisticRegressionTrainingSummary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Binary Logistic regression training results for a given model.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="k">class</span> <span class="nc">TreeClassifierParams</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Private class to track supported impurity measures.</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">supportedImpurities</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;entropy&quot;</span><span class="p">,</span> <span class="s2">&quot;gini&quot;</span><span class="p">]</span>

    <span class="n">impurity</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;impurity&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Criterion used for information gain calculation (case-insensitive). &quot;</span> <span class="o">+</span>
                     <span class="s2">&quot;Supported options: &quot;</span> <span class="o">+</span>
                     <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">supportedImpurities</span><span class="p">),</span> <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TreeClassifierParams</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setImpurity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`impurity`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">impurity</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getImpurity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of impurity or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impurity</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GBTParams</span><span class="p">(</span><span class="n">TreeEnsembleParams</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Private class to track supported GBT params.</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">supportedLossTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;logistic&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="DecisionTreeClassifier"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.DecisionTreeClassifier">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">DecisionTreeClassifier</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span>
                             <span class="n">HasProbabilityCol</span><span class="p">,</span> <span class="n">HasRawPredictionCol</span><span class="p">,</span> <span class="n">DecisionTreeParams</span><span class="p">,</span>
                             <span class="n">TreeClassifierParams</span><span class="p">,</span> <span class="n">HasCheckpointInterval</span><span class="p">,</span> <span class="n">HasSeed</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                             <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `Decision tree &lt;http://en.wikipedia.org/wiki/Decision_tree_learning&gt;`_</span>
<span class="sd">    learning algorithm for classification.</span>
<span class="sd">    It supports both binary and multiclass labels, as well as both continuous and categorical</span>
<span class="sd">    features.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.feature import StringIndexer</span>
<span class="sd">    &gt;&gt;&gt; df = spark.createDataFrame([</span>
<span class="sd">    ...     (1.0, Vectors.dense(1.0)),</span>
<span class="sd">    ...     (0.0, Vectors.sparse(1, [], []))], [&quot;label&quot;, &quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; stringIndexer = StringIndexer(inputCol=&quot;label&quot;, outputCol=&quot;indexed&quot;)</span>
<span class="sd">    &gt;&gt;&gt; si_model = stringIndexer.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; td = si_model.transform(df)</span>
<span class="sd">    &gt;&gt;&gt; dt = DecisionTreeClassifier(maxDepth=2, labelCol=&quot;indexed&quot;)</span>
<span class="sd">    &gt;&gt;&gt; model = dt.fit(td)</span>
<span class="sd">    &gt;&gt;&gt; model.numNodes</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; model.depth</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances</span>
<span class="sd">    SparseVector(1, {0: 1.0})</span>
<span class="sd">    &gt;&gt;&gt; model.numFeatures</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; model.numClasses</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; print(model.toDebugString)</span>
<span class="sd">    DecisionTreeClassificationModel (uid=...) of depth 1 with 3 nodes...</span>
<span class="sd">    &gt;&gt;&gt; test0 = spark.createDataFrame([(Vectors.dense(-1.0),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    0.0</span>
<span class="sd">    &gt;&gt;&gt; result.probability</span>
<span class="sd">    DenseVector([1.0, 0.0])</span>
<span class="sd">    &gt;&gt;&gt; result.rawPrediction</span>
<span class="sd">    DenseVector([1.0, 0.0])</span>
<span class="sd">    &gt;&gt;&gt; test1 = spark.createDataFrame([(Vectors.sparse(1, [0], [1.0]),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test1).head().prediction</span>
<span class="sd">    1.0</span>

<span class="sd">    &gt;&gt;&gt; dtc_path = temp_path + &quot;/dtc&quot;</span>
<span class="sd">    &gt;&gt;&gt; dt.save(dtc_path)</span>
<span class="sd">    &gt;&gt;&gt; dt2 = DecisionTreeClassifier.load(dtc_path)</span>
<span class="sd">    &gt;&gt;&gt; dt2.getMaxDepth()</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/dtc_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = DecisionTreeClassificationModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances == model2.featureImportances</span>
<span class="sd">    True</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                 <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                 maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                 maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, impurity=&quot;gini&quot;, \</span>
<span class="sd">                 seed=None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.DecisionTreeClassifier&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                         <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                         <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="DecisionTreeClassifier.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.DecisionTreeClassifier.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                  <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                  <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                  <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                  maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                  maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, impurity=&quot;gini&quot;, \</span>
<span class="sd">                  seed=None)</span>
<span class="sd">        Sets params for the DecisionTreeClassifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DecisionTreeClassificationModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="DecisionTreeClassificationModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.DecisionTreeClassificationModel">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">DecisionTreeClassificationModel</span><span class="p">(</span><span class="n">DecisionTreeModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                                      <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by DecisionTreeClassifier.</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">featureImportances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate of the importance of each feature.</span>

<span class="sd">        This generalizes the idea of &quot;Gini&quot; importance to other losses,</span>
<span class="sd">        following the explanation of Gini importance from &quot;Random Forests&quot; documentation</span>
<span class="sd">        by Leo Breiman and Adele Cutler, and following the implementation from scikit-learn.</span>

<span class="sd">        This feature importance is calculated as follows:</span>
<span class="sd">          - importance(feature j) = sum (over nodes which split on feature j) of the gain,</span>
<span class="sd">            where gain is scaled by the number of instances passing through node</span>
<span class="sd">          - Normalize importances for tree to sum to 1.</span>

<span class="sd">        .. note:: Feature importance for single decision trees can have high variance due to</span>
<span class="sd">            correlated predictor variables. Consider using a :py:class:`RandomForestClassifier`</span>
<span class="sd">            to determine feature importance instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;featureImportances&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="RandomForestClassifier"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.RandomForestClassifier">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">RandomForestClassifier</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span> <span class="n">HasSeed</span><span class="p">,</span>
                             <span class="n">HasRawPredictionCol</span><span class="p">,</span> <span class="n">HasProbabilityCol</span><span class="p">,</span>
                             <span class="n">RandomForestParams</span><span class="p">,</span> <span class="n">TreeClassifierParams</span><span class="p">,</span> <span class="n">HasCheckpointInterval</span><span class="p">,</span>
                             <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `Random Forest &lt;http://en.wikipedia.org/wiki/Random_forest&gt;`_</span>
<span class="sd">    learning algorithm for classification.</span>
<span class="sd">    It supports both binary and multiclass labels, as well as both continuous and categorical</span>
<span class="sd">    features.</span>

<span class="sd">    &gt;&gt;&gt; import numpy</span>
<span class="sd">    &gt;&gt;&gt; from numpy import allclose</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.feature import StringIndexer</span>
<span class="sd">    &gt;&gt;&gt; df = spark.createDataFrame([</span>
<span class="sd">    ...     (1.0, Vectors.dense(1.0)),</span>
<span class="sd">    ...     (0.0, Vectors.sparse(1, [], []))], [&quot;label&quot;, &quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; stringIndexer = StringIndexer(inputCol=&quot;label&quot;, outputCol=&quot;indexed&quot;)</span>
<span class="sd">    &gt;&gt;&gt; si_model = stringIndexer.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; td = si_model.transform(df)</span>
<span class="sd">    &gt;&gt;&gt; rf = RandomForestClassifier(numTrees=3, maxDepth=2, labelCol=&quot;indexed&quot;, seed=42)</span>
<span class="sd">    &gt;&gt;&gt; model = rf.fit(td)</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances</span>
<span class="sd">    SparseVector(1, {0: 1.0})</span>
<span class="sd">    &gt;&gt;&gt; allclose(model.treeWeights, [1.0, 1.0, 1.0])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; test0 = spark.createDataFrame([(Vectors.dense(-1.0),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    0.0</span>
<span class="sd">    &gt;&gt;&gt; numpy.argmax(result.probability)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; numpy.argmax(result.rawPrediction)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; test1 = spark.createDataFrame([(Vectors.sparse(1, [0], [1.0]),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test1).head().prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; model.trees</span>
<span class="sd">    [DecisionTreeClassificationModel (uid=...) of depth..., DecisionTreeClassificationModel...]</span>
<span class="sd">    &gt;&gt;&gt; rfc_path = temp_path + &quot;/rfc&quot;</span>
<span class="sd">    &gt;&gt;&gt; rf.save(rfc_path)</span>
<span class="sd">    &gt;&gt;&gt; rf2 = RandomForestClassifier.load(rfc_path)</span>
<span class="sd">    &gt;&gt;&gt; rf2.getNumTrees()</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/rfc_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = RandomForestClassificationModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances == model2.featureImportances</span>
<span class="sd">    True</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                 <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span>
                 <span class="n">numTrees</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                 maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                 maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, impurity=&quot;gini&quot;, \</span>
<span class="sd">                 numTrees=20, featureSubsetStrategy=&quot;auto&quot;, seed=None, subsamplingRate=1.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.RandomForestClassifier&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                         <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                         <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span> <span class="n">numTrees</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                         <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="RandomForestClassifier.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.RandomForestClassifier.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span>
                  <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                  <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">impurity</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span> <span class="n">numTrees</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, \</span>
<span class="sd">                  maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                  maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, seed=None, \</span>
<span class="sd">                  impurity=&quot;gini&quot;, numTrees=20, featureSubsetStrategy=&quot;auto&quot;, subsamplingRate=1.0)</span>
<span class="sd">        Sets params for linear classification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">RandomForestClassificationModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="RandomForestClassifier.setFeatureSubsetStrategy"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.RandomForestClassifier.setFeatureSubsetStrategy">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setFeatureSubsetStrategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`featureSubsetStrategy`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="RandomForestClassificationModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.RandomForestClassificationModel">[docs]</a><span class="k">class</span> <span class="nc">RandomForestClassificationModel</span><span class="p">(</span><span class="n">TreeEnsembleModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                                      <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by RandomForestClassifier.</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">featureImportances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate of the importance of each feature.</span>

<span class="sd">        Each feature&#39;s importance is the average of its importance across all trees in the ensemble</span>
<span class="sd">        The importance vector is normalized to sum to 1. This method is suggested by Hastie et al.</span>
<span class="sd">        (Hastie, Tibshirani, Friedman. &quot;The Elements of Statistical Learning, 2nd Edition.&quot; 2001.)</span>
<span class="sd">        and follows the implementation from scikit-learn.</span>

<span class="sd">        .. seealso:: :py:attr:`DecisionTreeClassificationModel.featureImportances`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;featureImportances&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trees in this ensemble. Warning: These have null parent Estimators.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">DecisionTreeClassificationModel</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;trees&quot;</span><span class="p">))]</span></div>


<div class="viewcode-block" id="GBTClassifier"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassifier">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">GBTClassifier</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span> <span class="n">HasMaxIter</span><span class="p">,</span>
                    <span class="n">GBTParams</span><span class="p">,</span> <span class="n">HasCheckpointInterval</span><span class="p">,</span> <span class="n">HasStepSize</span><span class="p">,</span> <span class="n">HasSeed</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                    <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `Gradient-Boosted Trees (GBTs) &lt;http://en.wikipedia.org/wiki/Gradient_boosting&gt;`_</span>
<span class="sd">    learning algorithm for classification.</span>
<span class="sd">    It supports binary labels, as well as both continuous and categorical features.</span>

<span class="sd">    The implementation is based upon: J.H. Friedman. &quot;Stochastic Gradient Boosting.&quot; 1999.</span>

<span class="sd">    Notes on Gradient Boosting vs. TreeBoost:</span>
<span class="sd">    - This implementation is for Stochastic Gradient Boosting, not for TreeBoost.</span>
<span class="sd">    - Both algorithms learn tree ensembles by minimizing loss functions.</span>
<span class="sd">    - TreeBoost (Friedman, 1999) additionally modifies the outputs at tree leaf nodes</span>
<span class="sd">    based on the loss function, whereas the original gradient boosting method does not.</span>
<span class="sd">    - We expect to implement TreeBoost in the future:</span>
<span class="sd">    `SPARK-4240 &lt;https://issues.apache.org/jira/browse/SPARK-4240&gt;`_</span>

<span class="sd">    .. note:: Multiclass labels are not currently supported.</span>

<span class="sd">    &gt;&gt;&gt; from numpy import allclose</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.feature import StringIndexer</span>
<span class="sd">    &gt;&gt;&gt; df = spark.createDataFrame([</span>
<span class="sd">    ...     (1.0, Vectors.dense(1.0)),</span>
<span class="sd">    ...     (0.0, Vectors.sparse(1, [], []))], [&quot;label&quot;, &quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; stringIndexer = StringIndexer(inputCol=&quot;label&quot;, outputCol=&quot;indexed&quot;)</span>
<span class="sd">    &gt;&gt;&gt; si_model = stringIndexer.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; td = si_model.transform(df)</span>
<span class="sd">    &gt;&gt;&gt; gbt = GBTClassifier(maxIter=5, maxDepth=2, labelCol=&quot;indexed&quot;, seed=42)</span>
<span class="sd">    &gt;&gt;&gt; gbt.getFeatureSubsetStrategy()</span>
<span class="sd">    &#39;all&#39;</span>
<span class="sd">    &gt;&gt;&gt; model = gbt.fit(td)</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances</span>
<span class="sd">    SparseVector(1, {0: 1.0})</span>
<span class="sd">    &gt;&gt;&gt; allclose(model.treeWeights, [1.0, 0.1, 0.1, 0.1, 0.1])</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; test0 = spark.createDataFrame([(Vectors.dense(-1.0),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test0).head().prediction</span>
<span class="sd">    0.0</span>
<span class="sd">    &gt;&gt;&gt; test1 = spark.createDataFrame([(Vectors.sparse(1, [0], [1.0]),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test1).head().prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; model.totalNumNodes</span>
<span class="sd">    15</span>
<span class="sd">    &gt;&gt;&gt; print(model.toDebugString)</span>
<span class="sd">    GBTClassificationModel (uid=...)...with 5 trees...</span>
<span class="sd">    &gt;&gt;&gt; gbtc_path = temp_path + &quot;gbtc&quot;</span>
<span class="sd">    &gt;&gt;&gt; gbt.save(gbtc_path)</span>
<span class="sd">    &gt;&gt;&gt; gbt2 = GBTClassifier.load(gbtc_path)</span>
<span class="sd">    &gt;&gt;&gt; gbt2.getMaxDepth()</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;gbtc_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = GBTClassificationModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.featureImportances == model2.featureImportances</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model.treeWeights == model2.treeWeights</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model.trees</span>
<span class="sd">    [DecisionTreeRegressionModel (uid=...) of depth..., DecisionTreeRegressionModel...]</span>
<span class="sd">    &gt;&gt;&gt; validation = spark.createDataFrame([(0.0, Vectors.dense(-1.0),)],</span>
<span class="sd">    ...              [&quot;indexed&quot;, &quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.evaluateEachIteration(validation)</span>
<span class="sd">    [0.25..., 0.23..., 0.21..., 0.19..., 0.18...]</span>
<span class="sd">    &gt;&gt;&gt; model.numClasses</span>
<span class="sd">    2</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lossType</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;lossType&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Loss function which GBT tries to minimize (case-insensitive). &quot;</span> <span class="o">+</span>
                     <span class="s2">&quot;Supported options: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GBTParams</span><span class="o">.</span><span class="n">supportedLossTypes</span><span class="p">),</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">stepSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;stepSize&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Step size (a.k.a. learning rate) in interval (0, 1] for shrinking &quot;</span> <span class="o">+</span>
                     <span class="s2">&quot;the contribution of each estimator.&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lossType</span><span class="o">=</span><span class="s2">&quot;logistic&quot;</span><span class="p">,</span>
                 <span class="n">maxIter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                 <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                 maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, \</span>
<span class="sd">                 lossType=&quot;logistic&quot;, maxIter=20, stepSize=0.1, seed=None, subsamplingRate=1.0, \</span>
<span class="sd">                 featureSubsetStrategy=&quot;all&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GBTClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.GBTClassifier&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                         <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                         <span class="n">lossType</span><span class="o">=</span><span class="s2">&quot;logistic&quot;</span><span class="p">,</span> <span class="n">maxIter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                         <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="GBTClassifier.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassifier.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">maxDepth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxBins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">minInstancesPerNode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minInfoGain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                  <span class="n">maxMemoryInMB</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cacheNodeIds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpointInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                  <span class="n">lossType</span><span class="o">=</span><span class="s2">&quot;logistic&quot;</span><span class="p">,</span> <span class="n">maxIter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsamplingRate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                  <span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  maxDepth=5, maxBins=32, minInstancesPerNode=1, minInfoGain=0.0, \</span>
<span class="sd">                  maxMemoryInMB=256, cacheNodeIds=False, checkpointInterval=10, \</span>
<span class="sd">                  lossType=&quot;logistic&quot;, maxIter=20, stepSize=0.1, seed=None, subsamplingRate=1.0, \</span>
<span class="sd">                  featureSubsetStrategy=&quot;all&quot;)</span>
<span class="sd">        Sets params for Gradient Boosted Tree Classification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GBTClassificationModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="GBTClassifier.setLossType"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassifier.setLossType">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setLossType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`lossType`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lossType</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="GBTClassifier.getLossType"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassifier.getLossType">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getLossType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of lossType or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lossType</span><span class="p">)</span></div>

<div class="viewcode-block" id="GBTClassifier.setFeatureSubsetStrategy"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassifier.setFeatureSubsetStrategy">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setFeatureSubsetStrategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`featureSubsetStrategy`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">featureSubsetStrategy</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GBTClassificationModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassificationModel">[docs]</a><span class="k">class</span> <span class="nc">GBTClassificationModel</span><span class="p">(</span><span class="n">TreeEnsembleModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                             <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by GBTClassifier.</span>

<span class="sd">    .. versionadded:: 1.4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">featureImportances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate of the importance of each feature.</span>

<span class="sd">        Each feature&#39;s importance is the average of its importance across all trees in the ensemble</span>
<span class="sd">        The importance vector is normalized to sum to 1. This method is suggested by Hastie et al.</span>
<span class="sd">        (Hastie, Tibshirani, Friedman. &quot;The Elements of Statistical Learning, 2nd Edition.&quot; 2001.)</span>
<span class="sd">        and follows the implementation from scikit-learn.</span>

<span class="sd">        .. seealso:: :py:attr:`DecisionTreeClassificationModel.featureImportances`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;featureImportances&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trees in this ensemble. Warning: These have null parent Estimators.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">DecisionTreeRegressionModel</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;trees&quot;</span><span class="p">))]</span>

<div class="viewcode-block" id="GBTClassificationModel.evaluateEachIteration"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.GBTClassificationModel.evaluateEachIteration">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.4.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">evaluateEachIteration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to compute error or loss for every iteration of gradient boosting.</span>

<span class="sd">        :param dataset:</span>
<span class="sd">            Test dataset to evaluate model on, where dataset is an</span>
<span class="sd">            instance of :py:class:`pyspark.sql.DataFrame`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;evaluateEachIteration&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NaiveBayes"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">NaiveBayes</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span> <span class="n">HasProbabilityCol</span><span class="p">,</span>
                 <span class="n">HasRawPredictionCol</span><span class="p">,</span> <span class="n">HasThresholds</span><span class="p">,</span> <span class="n">HasWeightCol</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Naive Bayes Classifiers.</span>
<span class="sd">    It supports both Multinomial and Bernoulli NB. `Multinomial NB</span>
<span class="sd">    &lt;http://nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html&gt;`_</span>
<span class="sd">    can handle finitely supported discrete data. For example, by converting documents into</span>
<span class="sd">    TF-IDF vectors, it can be used for document classification. By making every vector a</span>
<span class="sd">    binary (0/1) data, it can also be used as `Bernoulli NB</span>
<span class="sd">    &lt;http://nlp.stanford.edu/IR-book/html/htmledition/the-bernoulli-model-1.html&gt;`_.</span>
<span class="sd">    The input feature values must be nonnegative.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.sql import Row</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; df = spark.createDataFrame([</span>
<span class="sd">    ...     Row(label=0.0, weight=0.1, features=Vectors.dense([0.0, 0.0])),</span>
<span class="sd">    ...     Row(label=0.0, weight=0.5, features=Vectors.dense([0.0, 1.0])),</span>
<span class="sd">    ...     Row(label=1.0, weight=1.0, features=Vectors.dense([1.0, 0.0]))])</span>
<span class="sd">    &gt;&gt;&gt; nb = NaiveBayes(smoothing=1.0, modelType=&quot;multinomial&quot;, weightCol=&quot;weight&quot;)</span>
<span class="sd">    &gt;&gt;&gt; model = nb.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; model.pi</span>
<span class="sd">    DenseVector([-0.81..., -0.58...])</span>
<span class="sd">    &gt;&gt;&gt; model.theta</span>
<span class="sd">    DenseMatrix(2, 2, [-0.91..., -0.51..., -0.40..., -1.09...], 1)</span>
<span class="sd">    &gt;&gt;&gt; test0 = sc.parallelize([Row(features=Vectors.dense([1.0, 0.0]))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; result.probability</span>
<span class="sd">    DenseVector([0.32..., 0.67...])</span>
<span class="sd">    &gt;&gt;&gt; result.rawPrediction</span>
<span class="sd">    DenseVector([-1.72..., -0.99...])</span>
<span class="sd">    &gt;&gt;&gt; test1 = sc.parallelize([Row(features=Vectors.sparse(2, [0], [1.0]))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test1).head().prediction</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; nb_path = temp_path + &quot;/nb&quot;</span>
<span class="sd">    &gt;&gt;&gt; nb.save(nb_path)</span>
<span class="sd">    &gt;&gt;&gt; nb2 = NaiveBayes.load(nb_path)</span>
<span class="sd">    &gt;&gt;&gt; nb2.getSmoothing()</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/nb_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = NaiveBayesModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.pi == model2.pi</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model.theta == model2.theta</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; nb = nb.setThresholds([0.01, 10.00])</span>
<span class="sd">    &gt;&gt;&gt; model3 = nb.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; result = model3.transform(test0).head()</span>
<span class="sd">    &gt;&gt;&gt; result.prediction</span>
<span class="sd">    0.0</span>

<span class="sd">    .. versionadded:: 1.5.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">smoothing</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;smoothing&quot;</span><span class="p">,</span> <span class="s2">&quot;The smoothing parameter, should be &gt;= 0, &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;default is 1.0&quot;</span><span class="p">,</span> <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">modelType</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;modelType&quot;</span><span class="p">,</span> <span class="s2">&quot;The model type which is a string &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;(case-sensitive). Supported options: multinomial (default) and bernoulli.&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                 <span class="n">modelType</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, smoothing=1.0, \</span>
<span class="sd">                 modelType=&quot;multinomial&quot;, thresholds=None, weightCol=None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NaiveBayes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.NaiveBayes&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">smoothing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">modelType</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="NaiveBayes.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                  <span class="n">modelType</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  probabilityCol=&quot;probability&quot;, rawPredictionCol=&quot;rawPrediction&quot;, smoothing=1.0, \</span>
<span class="sd">                  modelType=&quot;multinomial&quot;, thresholds=None, weightCol=None)</span>
<span class="sd">        Sets params for Naive Bayes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NaiveBayesModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="NaiveBayes.setSmoothing"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes.setSmoothing">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setSmoothing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`smoothing`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">smoothing</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NaiveBayes.getSmoothing"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes.getSmoothing">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getSmoothing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of smoothing or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smoothing</span><span class="p">)</span></div>

<div class="viewcode-block" id="NaiveBayes.setModelType"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes.setModelType">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setModelType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`modelType`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">modelType</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NaiveBayes.getModelType"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayes.getModelType">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.5.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getModelType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of modelType or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modelType</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NaiveBayesModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.NaiveBayesModel">[docs]</a><span class="k">class</span> <span class="nc">NaiveBayesModel</span><span class="p">(</span><span class="n">JavaModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by NaiveBayes.</span>

<span class="sd">    .. versionadded:: 1.5.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">pi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        log of class priors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;pi&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">theta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        log of class conditional probabilities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MultilayerPerceptronClassifier"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">MultilayerPerceptronClassifier</span><span class="p">(</span><span class="n">JavaEstimator</span><span class="p">,</span> <span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">,</span>
                                     <span class="n">HasMaxIter</span><span class="p">,</span> <span class="n">HasTol</span><span class="p">,</span> <span class="n">HasSeed</span><span class="p">,</span> <span class="n">HasStepSize</span><span class="p">,</span> <span class="n">HasSolver</span><span class="p">,</span>
                                     <span class="n">JavaMLWritable</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">,</span> <span class="n">HasProbabilityCol</span><span class="p">,</span>
                                     <span class="n">HasRawPredictionCol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classifier trainer based on the Multilayer Perceptron.</span>
<span class="sd">    Each layer has sigmoid activation function, output layer has softmax.</span>
<span class="sd">    Number of inputs has to be equal to the size of feature vectors.</span>
<span class="sd">    Number of outputs has to be equal to the total number of labels.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; df = spark.createDataFrame([</span>
<span class="sd">    ...     (0.0, Vectors.dense([0.0, 0.0])),</span>
<span class="sd">    ...     (1.0, Vectors.dense([0.0, 1.0])),</span>
<span class="sd">    ...     (1.0, Vectors.dense([1.0, 0.0])),</span>
<span class="sd">    ...     (0.0, Vectors.dense([1.0, 1.0]))], [&quot;label&quot;, &quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; mlp = MultilayerPerceptronClassifier(maxIter=100, layers=[2, 2, 2], blockSize=1, seed=123)</span>
<span class="sd">    &gt;&gt;&gt; model = mlp.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; model.layers</span>
<span class="sd">    [2, 2, 2]</span>
<span class="sd">    &gt;&gt;&gt; model.weights.size</span>
<span class="sd">    12</span>
<span class="sd">    &gt;&gt;&gt; testDF = spark.createDataFrame([</span>
<span class="sd">    ...     (Vectors.dense([1.0, 0.0]),),</span>
<span class="sd">    ...     (Vectors.dense([0.0, 0.0]),)], [&quot;features&quot;])</span>
<span class="sd">    &gt;&gt;&gt; model.transform(testDF).select(&quot;features&quot;, &quot;prediction&quot;).show()</span>
<span class="sd">    +---------+----------+</span>
<span class="sd">    | features|prediction|</span>
<span class="sd">    +---------+----------+</span>
<span class="sd">    |[1.0,0.0]|       1.0|</span>
<span class="sd">    |[0.0,0.0]|       0.0|</span>
<span class="sd">    +---------+----------+</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; mlp_path = temp_path + &quot;/mlp&quot;</span>
<span class="sd">    &gt;&gt;&gt; mlp.save(mlp_path)</span>
<span class="sd">    &gt;&gt;&gt; mlp2 = MultilayerPerceptronClassifier.load(mlp_path)</span>
<span class="sd">    &gt;&gt;&gt; mlp2.getBlockSize()</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/mlp_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = MultilayerPerceptronClassificationModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model.layers == model2.layers</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model.weights == model2.weights</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; mlp2 = mlp2.setInitialWeights(list(range(0, 12)))</span>
<span class="sd">    &gt;&gt;&gt; model3 = mlp2.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; model3.weights != model2.weights</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; model3.layers == model.layers</span>
<span class="sd">    True</span>

<span class="sd">    .. versionadded:: 1.6.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">layers</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;layers&quot;</span><span class="p">,</span> <span class="s2">&quot;Sizes of layers from input layer to output layer &quot;</span> <span class="o">+</span>
                   <span class="s2">&quot;E.g., Array(780, 100, 10) means 780 inputs, one hidden layer with 100 &quot;</span> <span class="o">+</span>
                   <span class="s2">&quot;neurons and output layer of 10 neurons.&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListInt</span><span class="p">)</span>
    <span class="n">blockSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blockSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Block size for stacking input data in &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;matrices. Data is stacked within partitions. If block size is more than &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;remaining data in a partition then it is adjusted to the size of this &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;data. Recommended size is between 10 and 1000, default is 128.&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;solver&quot;</span><span class="p">,</span> <span class="s2">&quot;The solver algorithm for optimization. Supported &quot;</span> <span class="o">+</span>
                   <span class="s2">&quot;options: l-bfgs, gd.&quot;</span><span class="p">,</span> <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">initialWeights</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;initialWeights&quot;</span><span class="p">,</span> <span class="s2">&quot;The initial weights of the model.&quot;</span><span class="p">,</span>
                           <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toVector</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blockSize</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                 <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;l-bfgs&quot;</span><span class="p">,</span> <span class="n">initialWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span>
                 <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 maxIter=100, tol=1e-6, seed=None, layers=None, blockSize=128, stepSize=0.03, \</span>
<span class="sd">                 solver=&quot;l-bfgs&quot;, initialWeights=None, probabilityCol=&quot;probability&quot;, \</span>
<span class="sd">                 rawPredictionCol=&quot;rawPrediction&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MultilayerPerceptronClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span>
            <span class="s2">&quot;org.apache.spark.ml.classification.MultilayerPerceptronClassifier&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1E-6</span><span class="p">,</span> <span class="n">blockSize</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;l-bfgs&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">maxIter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blockSize</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">stepSize</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;l-bfgs&quot;</span><span class="p">,</span> <span class="n">initialWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">probabilityCol</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span>
                  <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s2">&quot;rawPrediction&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  maxIter=100, tol=1e-6, seed=None, layers=None, blockSize=128, stepSize=0.03, \</span>
<span class="sd">                  solver=&quot;l-bfgs&quot;, initialWeights=None, probabilityCol=&quot;probability&quot;, \</span>
<span class="sd">                  rawPredictionCol=&quot;rawPrediction&quot;):</span>
<span class="sd">        Sets params for MultilayerPerceptronClassifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MultilayerPerceptronClassificationModel</span><span class="p">(</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.setLayers"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.setLayers">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`layers`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.getLayers"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.getLayers">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of layers or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.setBlockSize"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.setBlockSize">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setBlockSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`blockSize`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">blockSize</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.getBlockSize"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.getBlockSize">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getBlockSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of blockSize or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blockSize</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.setStepSize"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.setStepSize">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setStepSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`stepSize`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">stepSize</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.getStepSize"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.getStepSize">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getStepSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of stepSize or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stepSize</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.setInitialWeights"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.setInitialWeights">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setInitialWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`initialWeights`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">initialWeights</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultilayerPerceptronClassifier.getInitialWeights"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassifier.getInitialWeights">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getInitialWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of initialWeights or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialWeights</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MultilayerPerceptronClassificationModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.MultilayerPerceptronClassificationModel">[docs]</a><span class="k">class</span> <span class="nc">MultilayerPerceptronClassificationModel</span><span class="p">(</span><span class="n">JavaModel</span><span class="p">,</span> <span class="n">JavaClassificationModel</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">,</span>
                                              <span class="n">JavaMLReadable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model fitted by MultilayerPerceptronClassifier.</span>

<span class="sd">    .. versionadded:: 1.6.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;1.6.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        array of layer sizes including input and output layers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;javaLayers&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        the weights of layers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">OneVsRestParams</span><span class="p">(</span><span class="n">HasFeaturesCol</span><span class="p">,</span> <span class="n">HasLabelCol</span><span class="p">,</span> <span class="n">HasWeightCol</span><span class="p">,</span> <span class="n">HasPredictionCol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters for OneVsRest and OneVsRestModel.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">classifier</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="s2">&quot;base binary classifier&quot;</span><span class="p">)</span>

    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setClassifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the value of :py:attr:`classifier`.</span>

<span class="sd">        .. note:: Only LogisticRegression and NaiveBayes are supported now.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">classifier</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getClassifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the value of classifier or its default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="p">)</span>


<div class="viewcode-block" id="OneVsRest"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.OneVsRest">[docs]</a><span class="nd">@inherit_doc</span>
<span class="k">class</span> <span class="nc">OneVsRest</span><span class="p">(</span><span class="n">Estimator</span><span class="p">,</span> <span class="n">OneVsRestParams</span><span class="p">,</span> <span class="n">HasParallelism</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Reduction of Multiclass Classification to Binary Classification.</span>
<span class="sd">    Performs reduction using one against all strategy.</span>
<span class="sd">    For a multiclass classification with k classes, train k models (one per class).</span>
<span class="sd">    Each example is scored against all k models and the model with highest score</span>
<span class="sd">    is picked to label the example.</span>

<span class="sd">    &gt;&gt;&gt; from pyspark.sql import Row</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml.linalg import Vectors</span>
<span class="sd">    &gt;&gt;&gt; data_path = &quot;data/mllib/sample_multiclass_classification_data.txt&quot;</span>
<span class="sd">    &gt;&gt;&gt; df = spark.read.format(&quot;libsvm&quot;).load(data_path)</span>
<span class="sd">    &gt;&gt;&gt; lr = LogisticRegression(regParam=0.01)</span>
<span class="sd">    &gt;&gt;&gt; ovr = OneVsRest(classifier=lr)</span>
<span class="sd">    &gt;&gt;&gt; model = ovr.fit(df)</span>
<span class="sd">    &gt;&gt;&gt; model.models[0].coefficients</span>
<span class="sd">    DenseVector([0.5..., -1.0..., 3.4..., 4.2...])</span>
<span class="sd">    &gt;&gt;&gt; model.models[1].coefficients</span>
<span class="sd">    DenseVector([-2.1..., 3.1..., -2.6..., -2.3...])</span>
<span class="sd">    &gt;&gt;&gt; model.models[2].coefficients</span>
<span class="sd">    DenseVector([0.3..., -3.4..., 1.0..., -1.1...])</span>
<span class="sd">    &gt;&gt;&gt; [x.intercept for x in model.models]</span>
<span class="sd">    [-2.7..., -2.5..., -1.3...]</span>
<span class="sd">    &gt;&gt;&gt; test0 = sc.parallelize([Row(features=Vectors.dense(-1.0, 0.0, 1.0, 1.0))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test0).head().prediction</span>
<span class="sd">    0.0</span>
<span class="sd">    &gt;&gt;&gt; test1 = sc.parallelize([Row(features=Vectors.sparse(4, [0], [1.0]))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test1).head().prediction</span>
<span class="sd">    2.0</span>
<span class="sd">    &gt;&gt;&gt; test2 = sc.parallelize([Row(features=Vectors.dense(0.5, 0.4, 0.3, 0.2))]).toDF()</span>
<span class="sd">    &gt;&gt;&gt; model.transform(test2).head().prediction</span>
<span class="sd">    0.0</span>
<span class="sd">    &gt;&gt;&gt; model_path = temp_path + &quot;/ovr_model&quot;</span>
<span class="sd">    &gt;&gt;&gt; model.save(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2 = OneVsRestModel.load(model_path)</span>
<span class="sd">    &gt;&gt;&gt; model2.transform(test0).head().prediction</span>
<span class="sd">    0.0</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                 <span class="n">classifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallelism</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                 classifier=None, weightCol=None, parallelism=1):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OneVsRest</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">parallelism</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="OneVsRest.setParams"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.OneVsRest.setParams">[docs]</a>    <span class="nd">@keyword_only</span>
    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
                  <span class="n">classifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weightCol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallelism</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, \</span>
<span class="sd">                  classifier=None, weightCol=None, parallelism=1):</span>
<span class="sd">        Sets params for OneVsRest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">labelCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLabelCol</span><span class="p">()</span>
        <span class="n">featuresCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFeaturesCol</span><span class="p">()</span>
        <span class="n">predictionCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">()</span>
        <span class="n">classifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">HasRawPredictionCol</span><span class="p">),</span>\
            <span class="s2">&quot;Classifier </span><span class="si">%s</span><span class="s2"> doesn&#39;t extend from HasRawPredictionCol.&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>

        <span class="n">numClasses</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="n">labelCol</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">head</span><span class="p">()[</span><span class="s2">&quot;max(&quot;</span><span class="o">+</span><span class="n">labelCol</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">weightCol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isDefined</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weightCol</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWeightCol</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">HasWeightCol</span><span class="p">):</span>
                <span class="n">weightCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWeightCol</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;weightCol is ignored, &quot;</span>
                              <span class="s2">&quot;as it is not supported by </span><span class="si">{}</span><span class="s2"> now.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classifier</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">weightCol</span><span class="p">:</span>
            <span class="n">multiclassLabeled</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">labelCol</span><span class="p">,</span> <span class="n">featuresCol</span><span class="p">,</span> <span class="n">weightCol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">multiclassLabeled</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">labelCol</span><span class="p">,</span> <span class="n">featuresCol</span><span class="p">)</span>

        <span class="c1"># persist if underlying dataset is not persistent.</span>
        <span class="n">handlePersistence</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">storageLevel</span> <span class="o">==</span> <span class="n">StorageLevel</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">handlePersistence</span><span class="p">:</span>
            <span class="n">multiclassLabeled</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="n">StorageLevel</span><span class="o">.</span><span class="n">MEMORY_AND_DISK</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">trainSingleClass</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="n">binaryLabelCol</span> <span class="o">=</span> <span class="s2">&quot;mc2b$&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">trainingDataset</span> <span class="o">=</span> <span class="n">multiclassLabeled</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
                <span class="n">binaryLabelCol</span><span class="p">,</span>
                <span class="n">when</span><span class="p">(</span><span class="n">multiclassLabeled</span><span class="p">[</span><span class="n">labelCol</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="n">paramMap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">classifier</span><span class="o">.</span><span class="n">labelCol</span><span class="p">,</span> <span class="n">binaryLabelCol</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">featuresCol</span><span class="p">,</span> <span class="n">featuresCol</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">predictionCol</span><span class="p">,</span> <span class="n">predictionCol</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">weightCol</span><span class="p">:</span>
                <span class="n">paramMap</span><span class="p">[</span><span class="n">classifier</span><span class="o">.</span><span class="n">weightCol</span><span class="p">]</span> <span class="o">=</span> <span class="n">weightCol</span>
            <span class="k">return</span> <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainingDataset</span><span class="p">,</span> <span class="n">paramMap</span><span class="p">)</span>

        <span class="n">pool</span> <span class="o">=</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParallelism</span><span class="p">(),</span> <span class="n">numClasses</span><span class="p">))</span>

        <span class="n">models</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">trainSingleClass</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">numClasses</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">handlePersistence</span><span class="p">:</span>
            <span class="n">multiclassLabeled</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copyValues</span><span class="p">(</span><span class="n">OneVsRestModel</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">))</span>

<div class="viewcode-block" id="OneVsRest.copy"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.OneVsRest.copy">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of this instance with a randomly generated uid</span>
<span class="sd">        and some extra params. This creates a deep copy of the embedded paramMap,</span>
<span class="sd">        and copies the embedded and extra parameters over.</span>

<span class="sd">        :param extra: Extra parameters to copy to the new instance</span>
<span class="sd">        :return: Copy of this instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">extra</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">newOvr</span> <span class="o">=</span> <span class="n">Params</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="p">):</span>
            <span class="n">newOvr</span><span class="o">.</span><span class="n">setClassifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">extra</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">newOvr</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_java</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">java_stage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a Java OneVsRest, create and return a Python wrapper of it.</span>
<span class="sd">        Used for ML persistence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">featuresCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getFeaturesCol</span><span class="p">()</span>
        <span class="n">labelCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getLabelCol</span><span class="p">()</span>
        <span class="n">predictionCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">()</span>
        <span class="n">classifier</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_from_java</span><span class="p">(</span><span class="n">java_stage</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">())</span>
        <span class="n">parallelism</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getParallelism</span><span class="p">()</span>
        <span class="n">py_stage</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">featuresCol</span><span class="o">=</span><span class="n">featuresCol</span><span class="p">,</span> <span class="n">labelCol</span><span class="o">=</span><span class="n">labelCol</span><span class="p">,</span> <span class="n">predictionCol</span><span class="o">=</span><span class="n">predictionCol</span><span class="p">,</span>
                       <span class="n">classifier</span><span class="o">=</span><span class="n">classifier</span><span class="p">,</span> <span class="n">parallelism</span><span class="o">=</span><span class="n">parallelism</span><span class="p">)</span>
        <span class="n">py_stage</span><span class="o">.</span><span class="n">_resetUid</span><span class="p">(</span><span class="n">java_stage</span><span class="o">.</span><span class="n">uid</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">py_stage</span>

    <span class="k">def</span> <span class="nf">_to_java</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transfer this instance to a Java OneVsRest. Used for ML persistence.</span>

<span class="sd">        :return: Java object equivalent to this instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_java_obj</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.ml.classification.OneVsRest&quot;</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">setClassifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">_to_java</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">setParallelism</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParallelism</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">setFeaturesCol</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getFeaturesCol</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">setLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLabelCol</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">setPredictionCol</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">_java_obj</span>

    <span class="k">def</span> <span class="nf">_make_java_param_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes a Java param pair.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_active_spark_context</span>
        <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolveParam</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="n">_java_obj</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.ml.classification.OneVsRest&quot;</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
        <span class="n">java_param</span> <span class="o">=</span> <span class="n">_java_obj</span><span class="o">.</span><span class="n">getParam</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">JavaParams</span><span class="p">):</span>
            <span class="c1"># used in the case of an estimator having another estimator as a parameter</span>
            <span class="c1"># the reason why this is not in _py2java in common.py is that importing</span>
            <span class="c1"># Estimator and Model in common.py results in a circular import with inherit_doc</span>
            <span class="n">java_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_to_java</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">java_value</span> <span class="o">=</span> <span class="n">_py2java</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">java_param</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">java_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transfer_param_map_to_java</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pyParamMap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms a Python ParamMap into a Java ParamMap.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paramMap</span> <span class="o">=</span> <span class="n">JavaWrapper</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.ml.param.ParamMap&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">pyParamMap</span><span class="p">:</span>
                <span class="n">pair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_java_param_pair</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">pyParamMap</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                <span class="n">paramMap</span><span class="o">.</span><span class="n">put</span><span class="p">([</span><span class="n">pair</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">paramMap</span>

    <span class="k">def</span> <span class="nf">_transfer_param_map_from_java</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">javaParamMap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms a Java ParamMap into a Python ParamMap.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_active_spark_context</span>
        <span class="n">paramMap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">javaParamMap</span><span class="o">.</span><span class="n">toList</span><span class="p">():</span>
            <span class="n">param</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">param</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasParam</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">())):</span>
                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;classifier&quot;</span><span class="p">:</span>
                    <span class="n">paramMap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getParam</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">())]</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_from_java</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">paramMap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getParam</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">())]</span> <span class="o">=</span> <span class="n">_java2py</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">pair</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">paramMap</span></div>


<div class="viewcode-block" id="OneVsRestModel"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.OneVsRestModel">[docs]</a><span class="k">class</span> <span class="nc">OneVsRestModel</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">OneVsRestParams</span><span class="p">,</span> <span class="n">JavaMLReadable</span><span class="p">,</span> <span class="n">JavaMLWritable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. note:: Experimental</span>

<span class="sd">    Model fitted by OneVsRest.</span>
<span class="sd">    This stores the models resulting from training k binary classifiers: one for each class.</span>
<span class="sd">    Each example is scored against all k models, and the model with the highest score</span>
<span class="sd">    is picked to label the example.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OneVsRestModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">models</span>
        <span class="n">java_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">_to_java</span><span class="p">()</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_active_spark_context</span>
        <span class="n">java_models_array</span> <span class="o">=</span> <span class="n">JavaWrapper</span><span class="o">.</span><span class="n">_new_java_array</span><span class="p">(</span><span class="n">java_models</span><span class="p">,</span>
                                                        <span class="n">sc</span><span class="o">.</span><span class="n">_gateway</span><span class="o">.</span><span class="n">jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">ml</span>
                                                        <span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">ClassificationModel</span><span class="p">)</span>
        <span class="c1"># TODO: need to set metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.sql.types.Metadata&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_java_obj</span> <span class="o">=</span> \
            <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.ml.classification.OneVsRestModel&quot;</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">metadata</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span> <span class="n">java_models_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="c1"># determine the input columns: these need to be passed through</span>
        <span class="n">origCols</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span>

        <span class="c1"># add an accumulator column to store predictions of all the models</span>
        <span class="n">accColName</span> <span class="o">=</span> <span class="s2">&quot;mbc$acc&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">initUDF</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="p">[],</span> <span class="n">ArrayType</span><span class="p">(</span><span class="n">DoubleType</span><span class="p">()))</span>
        <span class="n">newDataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">accColName</span><span class="p">,</span> <span class="n">initUDF</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">origCols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>

        <span class="c1"># persist if underlying dataset is not persistent.</span>
        <span class="n">handlePersistence</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">storageLevel</span> <span class="o">==</span> <span class="n">StorageLevel</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">handlePersistence</span><span class="p">:</span>
            <span class="n">newDataset</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="n">StorageLevel</span><span class="o">.</span><span class="n">MEMORY_AND_DISK</span><span class="p">)</span>

        <span class="c1"># update the accumulator column with the result of prediction of models</span>
        <span class="n">aggregatedDataset</span> <span class="o">=</span> <span class="n">newDataset</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">):</span>
            <span class="n">rawPredictionCol</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getRawPredictionCol&quot;</span><span class="p">)</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">origCols</span> <span class="o">+</span> <span class="p">[</span><span class="n">rawPredictionCol</span><span class="p">,</span> <span class="n">accColName</span><span class="p">]</span>

            <span class="c1"># add temporary column to store intermediate scores and update</span>
            <span class="n">tmpColName</span> <span class="o">=</span> <span class="s2">&quot;mbc$tmp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
            <span class="n">updateUDF</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">predictions</span> <span class="o">+</span> <span class="p">[</span><span class="n">prediction</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="n">ArrayType</span><span class="p">(</span><span class="n">DoubleType</span><span class="p">()))</span>
            <span class="n">transformedDataset</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">aggregatedDataset</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">updatedDataset</span> <span class="o">=</span> <span class="n">transformedDataset</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
                <span class="n">tmpColName</span><span class="p">,</span>
                <span class="n">updateUDF</span><span class="p">(</span><span class="n">transformedDataset</span><span class="p">[</span><span class="n">accColName</span><span class="p">],</span> <span class="n">transformedDataset</span><span class="p">[</span><span class="n">rawPredictionCol</span><span class="p">]))</span>
            <span class="n">newColumns</span> <span class="o">=</span> <span class="n">origCols</span> <span class="o">+</span> <span class="p">[</span><span class="n">tmpColName</span><span class="p">]</span>

            <span class="c1"># switch out the intermediate column with the accumulator column</span>
            <span class="n">aggregatedDataset</span> <span class="o">=</span> <span class="n">updatedDataset</span>\
                <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">newColumns</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="n">tmpColName</span><span class="p">,</span> <span class="n">accColName</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">handlePersistence</span><span class="p">:</span>
            <span class="n">newDataset</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>

        <span class="c1"># output the index of the classifier with highest confidence as prediction</span>
        <span class="n">labelUDF</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">predictions</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">DoubleType</span><span class="p">())</span>

        <span class="c1"># output label and label metadata as prediction</span>
        <span class="k">return</span> <span class="n">aggregatedDataset</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">(),</span> <span class="n">labelUDF</span><span class="p">(</span><span class="n">aggregatedDataset</span><span class="p">[</span><span class="n">accColName</span><span class="p">]))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">accColName</span><span class="p">)</span>

<div class="viewcode-block" id="OneVsRestModel.copy"><a class="viewcode-back" href="../../../pyspark.ml.html#pyspark.ml.classification.OneVsRestModel.copy">[docs]</a>    <span class="nd">@since</span><span class="p">(</span><span class="s2">&quot;2.0.0&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of this instance with a randomly generated uid</span>
<span class="sd">        and some extra params. This creates a deep copy of the embedded paramMap,</span>
<span class="sd">        and copies the embedded and extra parameters over.</span>

<span class="sd">        :param extra: Extra parameters to copy to the new instance</span>
<span class="sd">        :return: Copy of this instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">extra</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">newModel</span> <span class="o">=</span> <span class="n">Params</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="p">)</span>
        <span class="n">newModel</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">newModel</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_java</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">java_stage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a Java OneVsRestModel, create and return a Python wrapper of it.</span>
<span class="sd">        Used for ML persistence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">featuresCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getFeaturesCol</span><span class="p">()</span>
        <span class="n">labelCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getLabelCol</span><span class="p">()</span>
        <span class="n">predictionCol</span> <span class="o">=</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">()</span>
        <span class="n">classifier</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_from_java</span><span class="p">(</span><span class="n">java_stage</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">())</span>
        <span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">JavaParams</span><span class="o">.</span><span class="n">_from_java</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">java_stage</span><span class="o">.</span><span class="n">models</span><span class="p">()]</span>
        <span class="n">py_stage</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">)</span><span class="o">.</span><span class="n">setPredictionCol</span><span class="p">(</span><span class="n">predictionCol</span><span class="p">)</span><span class="o">.</span><span class="n">setLabelCol</span><span class="p">(</span><span class="n">labelCol</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">setFeaturesCol</span><span class="p">(</span><span class="n">featuresCol</span><span class="p">)</span><span class="o">.</span><span class="n">setClassifier</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
        <span class="n">py_stage</span><span class="o">.</span><span class="n">_resetUid</span><span class="p">(</span><span class="n">java_stage</span><span class="o">.</span><span class="n">uid</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">py_stage</span>

    <span class="k">def</span> <span class="nf">_to_java</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transfer this instance to a Java OneVsRestModel. Used for ML persistence.</span>

<span class="sd">        :return: Java object equivalent to this instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">_active_spark_context</span>
        <span class="n">java_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">_to_java</span><span class="p">()</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
        <span class="n">java_models_array</span> <span class="o">=</span> <span class="n">JavaWrapper</span><span class="o">.</span><span class="n">_new_java_array</span><span class="p">(</span>
            <span class="n">java_models</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">_gateway</span><span class="o">.</span><span class="n">jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">ClassificationModel</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.sql.types.Metadata&quot;</span><span class="p">)</span>
        <span class="n">_java_obj</span> <span class="o">=</span> <span class="n">JavaParams</span><span class="o">.</span><span class="n">_new_java_obj</span><span class="p">(</span><span class="s2">&quot;org.apache.spark.ml.classification.OneVsRestModel&quot;</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">metadata</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span> <span class="n">java_models_array</span><span class="p">)</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">_to_java</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;featuresCol&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFeaturesCol</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;labelCol&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLabelCol</span><span class="p">())</span>
        <span class="n">_java_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;predictionCol&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPredictionCol</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">_java_obj</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="kn">import</span> <span class="nn">pyspark.ml.classification</span>
    <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="k">import</span> <span class="n">SparkSession</span>
    <span class="n">globs</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># The small batch size here ensures that we see multiple batches,</span>
    <span class="c1"># even in these small test examples:</span>
    <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span>\
        <span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="s2">&quot;local[2]&quot;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;ml.classification tests&quot;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>
    <span class="n">globs</span><span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span>
    <span class="n">globs</span><span class="p">[</span><span class="s1">&#39;spark&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spark</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>
    <span class="n">temp_path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
    <span class="n">globs</span><span class="p">[</span><span class="s1">&#39;temp_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_path</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">failure_count</span><span class="p">,</span> <span class="n">test_count</span><span class="p">)</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">globs</span><span class="o">=</span><span class="n">globs</span><span class="p">,</span> <span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">ELLIPSIS</span><span class="p">)</span>
        <span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">shutil</span> <span class="k">import</span> <span class="n">rmtree</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">temp_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="n">failure_count</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/spark-logo-hd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-0"><a href="../../../index.html">PySpark 2.4.1 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>