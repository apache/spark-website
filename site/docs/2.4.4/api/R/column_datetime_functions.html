<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Date time functions for Column operations</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for column_datetime_functions {SparkR}"><tr><td>column_datetime_functions {SparkR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Date time functions for Column operations</h2>

<h3>Description</h3>

<p>Date time functions defined for <code>Column</code>.
</p>


<h3>Usage</h3>

<pre>
current_date(x = "missing")

current_timestamp(x = "missing")

date_trunc(format, x)

dayofmonth(x)

dayofweek(x)

dayofyear(x)

from_unixtime(x, ...)

hour(x)

last_day(x)

minute(x)

month(x)

quarter(x)

second(x)

to_date(x, format)

to_timestamp(x, format)

unix_timestamp(x, format)

weekofyear(x)

window(x, ...)

year(x)

## S4 method for signature 'Column'
dayofmonth(x)

## S4 method for signature 'Column'
dayofweek(x)

## S4 method for signature 'Column'
dayofyear(x)

## S4 method for signature 'Column'
hour(x)

## S4 method for signature 'Column'
last_day(x)

## S4 method for signature 'Column'
minute(x)

## S4 method for signature 'Column'
month(x)

## S4 method for signature 'Column'
quarter(x)

## S4 method for signature 'Column'
second(x)

## S4 method for signature 'Column,missing'
to_date(x, format)

## S4 method for signature 'Column,character'
to_date(x, format)

## S4 method for signature 'Column,missing'
to_timestamp(x, format)

## S4 method for signature 'Column,character'
to_timestamp(x, format)

## S4 method for signature 'Column'
weekofyear(x)

## S4 method for signature 'Column'
year(x)

## S4 method for signature 'Column'
from_unixtime(x, format = "yyyy-MM-dd HH:mm:ss")

## S4 method for signature 'Column'
window(x, windowDuration, slideDuration = NULL,
  startTime = NULL)

## S4 method for signature 'missing,missing'
unix_timestamp(x, format)

## S4 method for signature 'Column,missing'
unix_timestamp(x, format)

## S4 method for signature 'Column,character'
unix_timestamp(x,
  format = "yyyy-MM-dd HH:mm:ss")

## S4 method for signature 'Column'
trunc(x, format)

## S4 method for signature 'character,Column'
date_trunc(format, x)

## S4 method for signature 'missing'
current_date()

## S4 method for signature 'missing'
current_timestamp()
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>Column to compute on. In <code>window</code>, it must be a time Column of
<code>TimestampType</code>. This is not used with <code>current_date</code> and
<code>current_timestamp</code></p>
</td></tr>
<tr valign="top"><td><code>format</code></td>
<td>
<p>The format for the given dates or timestamps in Column <code>x</code>. See the
format used in the following methods:
</p>

<ul>
<li> <p><code>to_date</code> and <code>to_timestamp</code>: it is the string to use to parse
Column <code>x</code> to DateType or TimestampType.
</p>
</li>
<li> <p><code>trunc</code>: it is the string to use to specify the truncation method.
For example, &quot;year&quot;, &quot;yyyy&quot;, &quot;yy&quot; for truncate by year, or &quot;month&quot;, &quot;mon&quot;,
&quot;mm&quot; for truncate by month.
</p>
</li>
<li> <p><code>date_trunc</code>: it is similar with <code>trunc</code>'s but additionally
supports &quot;day&quot;, &quot;dd&quot;, &quot;second&quot;, &quot;minute&quot;, &quot;hour&quot;, &quot;week&quot; and &quot;quarter&quot;.
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional argument(s).</p>
</td></tr>
<tr valign="top"><td><code>windowDuration</code></td>
<td>
<p>a string specifying the width of the window, e.g. '1 second',
'1 day 12 hours', '2 minutes'. Valid interval strings are 'week',
'day', 'hour', 'minute', 'second', 'millisecond', 'microsecond'. Note that
the duration is a fixed length of time, and does not vary over time
according to a calendar. For example, '1 day' always means 86,400,000
milliseconds, not a calendar day.</p>
</td></tr>
<tr valign="top"><td><code>slideDuration</code></td>
<td>
<p>a string specifying the sliding interval of the window. Same format as
<code>windowDuration</code>. A new window will be generated every
<code>slideDuration</code>. Must be less than or equal to
the <code>windowDuration</code>. This duration is likewise absolute, and does not
vary according to a calendar.</p>
</td></tr>
<tr valign="top"><td><code>startTime</code></td>
<td>
<p>the offset with respect to 1970-01-01 00:00:00 UTC with which to start
window intervals. For example, in order to have hourly tumbling windows
that start 15 minutes past the hour, e.g. 12:15-13:15, 13:15-14:15... provide
<code>startTime</code> as <code>"15 minutes"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dayofmonth</code>: Extracts the day of the month as an integer from a
given date/timestamp/string.
</p>
<p><code>dayofweek</code>: Extracts the day of the week as an integer from a
given date/timestamp/string.
</p>
<p><code>dayofyear</code>: Extracts the day of the year as an integer from a
given date/timestamp/string.
</p>
<p><code>hour</code>: Extracts the hour as an integer from a given date/timestamp/string.
</p>
<p><code>last_day</code>: Given a date column, returns the last day of the month which the
given date belongs to. For example, input &quot;2015-07-27&quot; returns &quot;2015-07-31&quot; since
July 31 is the last day of the month in July 2015.
</p>
<p><code>minute</code>: Extracts the minute as an integer from a given date/timestamp/string.
</p>
<p><code>month</code>: Extracts the month as an integer from a given date/timestamp/string.
</p>
<p><code>quarter</code>: Extracts the quarter as an integer from a given date/timestamp/string.
</p>
<p><code>second</code>: Extracts the second as an integer from a given date/timestamp/string.
</p>
<p><code>to_date</code>: Converts the column into a DateType. You may optionally specify
a format according to the rules in:
<a href="http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html">http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html</a>.
If the string cannot be parsed according to the specified format (or default),
the value of the column will be null.
By default, it follows casting rules to a DateType if the format is omitted
(equivalent to <code>cast(df$x, "date")</code>).
</p>
<p><code>to_timestamp</code>: Converts the column into a TimestampType. You may optionally specify
a format according to the rules in:
<a href="http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html">http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html</a>.
If the string cannot be parsed according to the specified format (or default),
the value of the column will be null.
By default, it follows casting rules to a TimestampType if the format is omitted
(equivalent to <code>cast(df$x, "timestamp")</code>).
</p>
<p><code>weekofyear</code>: Extracts the week number as an integer from a given date/timestamp/string.
</p>
<p><code>year</code>: Extracts the year as an integer from a given date/timestamp/string.
</p>
<p><code>from_unixtime</code>: Converts the number of seconds from unix epoch (1970-01-01 00:00:00 UTC)
to a string representing the timestamp of that moment in the current system time zone in the JVM
in the given format.
See <a href="http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html">
Customizing Formats</a> for available options.
</p>
<p><code>window</code>: Bucketizes rows into one or more time windows given a timestamp specifying column.
Window starts are inclusive but the window ends are exclusive, e.g. 12:05 will be in the window
[12:05,12:10) but not in [12:00,12:05). Windows can support microsecond precision. Windows in
the order of months are not supported. It returns an output column of struct called 'window'
by default with the nested columns 'start' and 'end'
</p>
<p><code>unix_timestamp</code>: Gets current Unix timestamp in seconds.
</p>
<p><code>trunc</code>: Returns date truncated to the unit specified by the format.
</p>
<p><code>date_trunc</code>: Returns timestamp truncated to the unit specified by the format.
</p>
<p><code>current_date</code>: Returns the current date as a date column.
</p>
<p><code>current_timestamp</code>: Returns the current timestamp as a timestamp column.
</p>


<h3>Note</h3>

<p>dayofmonth since 1.5.0
</p>
<p>dayofweek since 2.3.0
</p>
<p>dayofyear since 1.5.0
</p>
<p>hour since 1.5.0
</p>
<p>last_day since 1.5.0
</p>
<p>minute since 1.5.0
</p>
<p>month since 1.5.0
</p>
<p>quarter since 1.5.0
</p>
<p>second since 1.5.0
</p>
<p>to_date(Column) since 1.5.0
</p>
<p>to_date(Column, character) since 2.2.0
</p>
<p>to_timestamp(Column) since 2.2.0
</p>
<p>to_timestamp(Column, character) since 2.2.0
</p>
<p>weekofyear since 1.5.0
</p>
<p>year since 1.5.0
</p>
<p>from_unixtime since 1.5.0
</p>
<p>window since 2.0.0
</p>
<p>unix_timestamp since 1.5.0
</p>
<p>unix_timestamp(Column) since 1.5.0
</p>
<p>unix_timestamp(Column, character) since 1.5.0
</p>
<p>trunc since 2.3.0
</p>
<p>date_trunc since 2.3.0
</p>
<p>current_date since 2.3.0
</p>
<p>current_timestamp since 2.3.0
</p>


<h3>See Also</h3>

<p>Other data time functions: <code><a href="column_datetime_diff_functions.html">column_datetime_diff_functions</a></code>
</p>


<h3>Examples</h3>

<pre><code class="r">## Not run: 
##D dts &lt;- c(&quot;2005-01-02 18:47:22&quot;,
##D         &quot;2005-12-24 16:30:58&quot;,
##D         &quot;2005-10-28 07:30:05&quot;,
##D         &quot;2005-12-28 07:01:05&quot;,
##D         &quot;2006-01-24 00:01:10&quot;)
##D y &lt;- c(2.0, 2.2, 3.4, 2.5, 1.8)
##D df &lt;- createDataFrame(data.frame(time = as.POSIXct(dts), y = y))
## End(Not run)

## Not run: 
##D head(select(df, df$time, year(df$time), quarter(df$time), month(df$time),
##D             dayofmonth(df$time), dayofweek(df$time), dayofyear(df$time), weekofyear(df$time)))
##D head(agg(groupBy(df, year(df$time)), count(df$y), avg(df$y)))
##D head(agg(groupBy(df, month(df$time)), avg(df$y)))
## End(Not run)

## Not run: 
##D head(select(df, hour(df$time), minute(df$time), second(df$time)))
##D head(agg(groupBy(df, dayofmonth(df$time)), avg(df$y)))
##D head(agg(groupBy(df, hour(df$time)), avg(df$y)))
##D head(agg(groupBy(df, minute(df$time)), avg(df$y)))
## End(Not run)

## Not run: 
##D head(select(df, df$time, last_day(df$time), month(df$time)))
## End(Not run)

## Not run: 
##D tmp &lt;- createDataFrame(data.frame(time_string = dts))
##D tmp2 &lt;- mutate(tmp, date1 = to_date(tmp$time_string),
##D                    date2 = to_date(tmp$time_string, &quot;yyyy-MM-dd&quot;),
##D                    date3 = date_format(tmp$time_string, &quot;MM/dd/yyy&quot;),
##D                    time1 = to_timestamp(tmp$time_string),
##D                    time2 = to_timestamp(tmp$time_string, &quot;yyyy-MM-dd&quot;))
##D head(tmp2)
## End(Not run)

## Not run: 
##D tmp &lt;- mutate(df, to_unix = unix_timestamp(df$time),
##D                   to_unix2 = unix_timestamp(df$time, &#39;yyyy-MM-dd HH&#39;),
##D                   from_unix = from_unixtime(unix_timestamp(df$time)),
##D                   from_unix2 = from_unixtime(unix_timestamp(df$time), &#39;yyyy-MM-dd HH:mm&#39;))
##D head(tmp)
## End(Not run)

## Not run: 
##D # One minute windows every 15 seconds 10 seconds after the minute, e.g. 09:00:10-09:01:10,
##D # 09:00:25-09:01:25, 09:00:40-09:01:40, ...
##D window(df$time, &quot;1 minute&quot;, &quot;15 seconds&quot;, &quot;10 seconds&quot;)
##D 
##D # One minute tumbling windows 15 seconds after the minute, e.g. 09:00:15-09:01:15,
##D # 09:01:15-09:02:15...
##D window(df$time, &quot;1 minute&quot;, startTime = &quot;15 seconds&quot;)
##D 
##D # Thirty-second windows every 10 seconds, e.g. 09:00:00-09:00:30, 09:00:10-09:00:40, ...
##D window(df$time, &quot;30 seconds&quot;, &quot;10 seconds&quot;)
## End(Not run)

## Not run: 
##D head(select(df, df$time, trunc(df$time, &quot;year&quot;), trunc(df$time, &quot;yy&quot;),
##D            trunc(df$time, &quot;month&quot;), trunc(df$time, &quot;mon&quot;)))
## End(Not run)

## Not run: 
##D head(select(df, df$time, date_trunc(&quot;hour&quot;, df$time), date_trunc(&quot;minute&quot;, df$time),
##D             date_trunc(&quot;week&quot;, df$time), date_trunc(&quot;quarter&quot;, df$time)))
## End(Not run)
## Not run: 
##D head(select(df, current_date(), current_timestamp()))
## End(Not run)
</code></pre>


<hr /><div style="text-align: center;">[Package <em>SparkR</em> version 2.4.4 <a href="00Index.html">Index</a>]</div>
</body></html>
