
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pyspark package &#8212; PySpark 2.4.4 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/pyspark.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/pyspark.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyspark.sql module" href="pyspark.sql.html" />
    <link rel="prev" title="Welcome to Spark Python API Docs!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pyspark.sql.html" title="pyspark.sql module"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to Spark Python API Docs!"
             accesskey="P">previous</a> |</li>
    
        <li class="nav-item nav-item-0"><a href="index.html">PySpark 2.4.4 documentation</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pyspark-package">
<h1>pyspark package<a class="headerlink" href="#pyspark-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyspark.sql.html">pyspark.sql module</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyspark.streaming.html">pyspark.streaming module</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyspark.ml.html">pyspark.ml package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyspark.mllib.html">pyspark.mllib package</a></li>
</ul>
</div>
</div>
<div class="section" id="module-pyspark">
<span id="contents"></span><h2>Contents<a class="headerlink" href="#module-pyspark" title="Permalink to this headline">¶</a></h2>
<p>PySpark is the Python API for Spark.</p>
<p>Public classes:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.SparkContext" title="pyspark.SparkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext</span></code></a>:</dt><dd><p>Main entry point for Spark functionality.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.RDD" title="pyspark.RDD"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDD</span></code></a>:</dt><dd><p>A Resilient Distributed Dataset (RDD), the basic abstraction in Spark.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.Broadcast" title="pyspark.Broadcast"><code class="xref py py-class docutils literal notranslate"><span class="pre">Broadcast</span></code></a>:</dt><dd><p>A broadcast variable that gets reused across tasks.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.Accumulator" title="pyspark.Accumulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accumulator</span></code></a>:</dt><dd><p>An “add-only” shared variable that tasks can only add values to.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.SparkConf" title="pyspark.SparkConf"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkConf</span></code></a>:</dt><dd><p>For configuring Spark.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.SparkFiles" title="pyspark.SparkFiles"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkFiles</span></code></a>:</dt><dd><p>Access files shipped with jobs.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.StorageLevel" title="pyspark.StorageLevel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StorageLevel</span></code></a>:</dt><dd><p>Finer-grained cache persistence levels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.TaskContext" title="pyspark.TaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskContext</span></code></a>:</dt><dd><p>Information about the current running task, available on the workers and experimental.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.RDDBarrier" title="pyspark.RDDBarrier"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDDBarrier</span></code></a>:</dt><dd><p>Wraps an RDD under a barrier stage for barrier execution.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.BarrierTaskContext" title="pyspark.BarrierTaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">BarrierTaskContext</span></code></a>:</dt><dd><p>A <a class="reference internal" href="#pyspark.TaskContext" title="pyspark.TaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskContext</span></code></a> that provides extra info and tooling for barrier execution.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyspark.BarrierTaskInfo" title="pyspark.BarrierTaskInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">BarrierTaskInfo</span></code></a>:</dt><dd><p>Information about a barrier task.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pyspark.SparkConf">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">SparkConf</code><span class="sig-paren">(</span><em class="sig-param">loadDefaults=True</em>, <em class="sig-param">_jvm=None</em>, <em class="sig-param">_jconf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a Spark application. Used to set various Spark
parameters as key-value pairs.</p>
<p>Most of the time, you would create a SparkConf object with
<a class="reference internal" href="#pyspark.SparkConf" title="pyspark.SparkConf"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkConf()</span></code></a>, which will load values from <cite>spark.*</cite> Java system
properties as well. In this case, any parameters you set directly on
the <a class="reference internal" href="#pyspark.SparkConf" title="pyspark.SparkConf"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkConf</span></code></a> object take priority over system properties.</p>
<p>For unit tests, you can also call <code class="xref py py-class docutils literal notranslate"><span class="pre">SparkConf(false)</span></code> to skip
loading external settings and get the same configuration no matter
what the system properties are.</p>
<p>All setter methods in this class support chaining. For example,
you can write <cite>conf.setMaster(“local”).setAppName(“My app”)</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once a SparkConf object is passed to Spark, it is cloned
and can no longer be modified by the user.</p>
</div>
<dl class="method">
<dt id="pyspark.SparkConf.contains">
<code class="sig-name descname">contains</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Does this configuration contain a given key?</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">defaultValue=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the configured value for some key, or return a default otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.getAll">
<code class="sig-name descname">getAll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.getAll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.getAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all values as a list of key-value pairs.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.set">
<code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a configuration property.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setAll">
<code class="sig-name descname">setAll</code><span class="sig-paren">(</span><em class="sig-param">pairs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setAll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Set multiple parameters, passed as a list of key-value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pairs</strong> – list of key-value pairs to set</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setAppName">
<code class="sig-name descname">setAppName</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setAppName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setAppName" title="Permalink to this definition">¶</a></dt>
<dd><p>Set application name.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setExecutorEnv">
<code class="sig-name descname">setExecutorEnv</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">value=None</em>, <em class="sig-param">pairs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setExecutorEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setExecutorEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an environment variable to be passed to executors.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setIfMissing">
<code class="sig-name descname">setIfMissing</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setIfMissing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setIfMissing" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a configuration property, if not already set.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setMaster">
<code class="sig-name descname">setMaster</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setMaster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setMaster" title="Permalink to this definition">¶</a></dt>
<dd><p>Set master URL to connect to.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.setSparkHome">
<code class="sig-name descname">setSparkHome</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.setSparkHome"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.setSparkHome" title="Permalink to this definition">¶</a></dt>
<dd><p>Set path where Spark is installed on worker nodes.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkConf.toDebugString">
<code class="sig-name descname">toDebugString</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/conf.html#SparkConf.toDebugString"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkConf.toDebugString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a printable version of the configuration, as a list of
key=value pairs, one per line.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.SparkContext">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">SparkContext</code><span class="sig-paren">(</span><em class="sig-param">master=None</em>, <em class="sig-param">appName=None</em>, <em class="sig-param">sparkHome=None</em>, <em class="sig-param">pyFiles=None</em>, <em class="sig-param">environment=None</em>, <em class="sig-param">batchSize=0</em>, <em class="sig-param">serializer=PickleSerializer()</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">gateway=None</em>, <em class="sig-param">jsc=None</em>, <em class="sig-param">profiler_cls=&lt;class 'pyspark.profiler.BasicProfiler'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point for Spark functionality. A SparkContext represents the
connection to a Spark cluster, and can be used to create <a class="reference internal" href="#pyspark.RDD" title="pyspark.RDD"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDD</span></code></a> and
broadcast variables on that cluster.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#pyspark.SparkContext" title="pyspark.SparkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext</span></code></a> instance is not supported to share across multiple
processes out of the box, and PySpark does not guarantee multi-processing execution.
Use threads instead for concurrent processing purpose.</p>
</div>
<dl class="attribute">
<dt id="pyspark.SparkContext.PACKAGE_EXTENSIONS">
<code class="sig-name descname">PACKAGE_EXTENSIONS</code><em class="property"> = ('.zip', '.egg', '.jar')</em><a class="headerlink" href="#pyspark.SparkContext.PACKAGE_EXTENSIONS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.accumulator">
<code class="sig-name descname">accumulator</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">accum_param=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.accumulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.accumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <a class="reference internal" href="#pyspark.Accumulator" title="pyspark.Accumulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accumulator</span></code></a> with the given initial value, using a given
<a class="reference internal" href="#pyspark.AccumulatorParam" title="pyspark.AccumulatorParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">AccumulatorParam</span></code></a> helper object to define how to add values of the
data type if provided. Default AccumulatorParams are used for integers
and floating-point numbers if you do not provide one. For other types,
a custom AccumulatorParam can be used.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.addFile">
<code class="sig-name descname">addFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">recursive=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.addFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.addFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a file to be downloaded with this Spark job on every node.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">path</span></code> passed can be either a local file, a file in HDFS
(or other Hadoop-supported filesystems), or an HTTP, HTTPS or
FTP URI.</p>
<p>To access the file in Spark jobs, use
L{SparkFiles.get(fileName)&lt;pyspark.files.SparkFiles.get&gt;} with the
filename to find its download location.</p>
<p>A directory can be given if the recursive option is set to True.
Currently directories are only supported for Hadoop-supported filesystems.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A path can be added only once. Subsequent additions of the same path are ignored.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="k">import</span> <span class="n">SparkFiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">testFile</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">testFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;100&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">testFile</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">fileVal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">testFile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">fileVal</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">mapPartitions</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[100, 200, 300, 400]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.addPyFile">
<code class="sig-name descname">addPyFile</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.addPyFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.addPyFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a .py or .zip dependency for all tasks to be executed on this
SparkContext in the future.  The <code class="xref py py-class docutils literal notranslate"><span class="pre">path</span></code> passed can be either a local
file, a file in HDFS (or other Hadoop-supported filesystems), or an
HTTP, HTTPS or FTP URI.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A path can be added only once. Subsequent additions of the same path are ignored.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.applicationId">
<em class="property">property </em><code class="sig-name descname">applicationId</code><a class="headerlink" href="#pyspark.SparkContext.applicationId" title="Permalink to this definition">¶</a></dt>
<dd><p>A unique identifier for the Spark application.
Its format depends on the scheduler implementation.</p>
<ul class="simple">
<li><p>in case of local spark app something like ‘local-1433865536131’</p></li>
<li><p>in case of YARN something like ‘application_1433865536131_34483’</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">applicationId</span>  
<span class="go">&#39;local-...&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.binaryFiles">
<code class="sig-name descname">binaryFiles</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">minPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.binaryFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.binaryFiles" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Read a directory of binary files from HDFS, a local file system
(available on all nodes), or any Hadoop-supported file system URI
as a byte array. Each file is read as a single record and returned
in a key-value pair, where the key is the path of each file, the
value is the content of each file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Small files are preferred, large file is also allowable, but
may cause bad performance.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.binaryRecords">
<code class="sig-name descname">binaryRecords</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">recordLength</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.binaryRecords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.binaryRecords" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Load data from a flat binary file, assuming each record is a set of numbers
with the specified numerical format (see ByteBuffer), and the number of
bytes per record is constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Directory to the input data files</p></li>
<li><p><strong>recordLength</strong> – The length at which to split the records</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.broadcast">
<code class="sig-name descname">broadcast</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.broadcast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.broadcast" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcast a read-only variable to the cluster, returning a
L{Broadcast&lt;pyspark.broadcast.Broadcast&gt;}
object for reading it in distributed functions. The variable will
be sent to each cluster only once.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.cancelAllJobs">
<code class="sig-name descname">cancelAllJobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.cancelAllJobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.cancelAllJobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel all jobs that have been scheduled or are running.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.cancelJobGroup">
<code class="sig-name descname">cancelJobGroup</code><span class="sig-paren">(</span><em class="sig-param">groupId</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.cancelJobGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.cancelJobGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel active jobs for the specified group. See <a class="reference internal" href="#pyspark.SparkContext.setJobGroup" title="pyspark.SparkContext.setJobGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext.setJobGroup</span></code></a>
for more information.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.defaultMinPartitions">
<em class="property">property </em><code class="sig-name descname">defaultMinPartitions</code><a class="headerlink" href="#pyspark.SparkContext.defaultMinPartitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Default min number of partitions for Hadoop RDDs when not given by user</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.defaultParallelism">
<em class="property">property </em><code class="sig-name descname">defaultParallelism</code><a class="headerlink" href="#pyspark.SparkContext.defaultParallelism" title="Permalink to this definition">¶</a></dt>
<dd><p>Default level of parallelism to use when not given by user (e.g. for
reduce tasks)</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.dump_profiles">
<code class="sig-name descname">dump_profiles</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.dump_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.dump_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the profile stats into directory <cite>path</cite></p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.emptyRDD">
<code class="sig-name descname">emptyRDD</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.emptyRDD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.emptyRDD" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an RDD that has no partitions or elements.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.getConf">
<code class="sig-name descname">getConf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.getConf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.getConf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.getLocalProperty">
<code class="sig-name descname">getLocalProperty</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.getLocalProperty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.getLocalProperty" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a local property set in this thread, or null if it is missing. See
<a class="reference internal" href="#pyspark.SparkContext.setLocalProperty" title="pyspark.SparkContext.setLocalProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">setLocalProperty</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.getOrCreate">
<em class="property">classmethod </em><code class="sig-name descname">getOrCreate</code><span class="sig-paren">(</span><em class="sig-param">conf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.getOrCreate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.getOrCreate" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or instantiate a SparkContext and register it as a singleton object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>conf</strong> – SparkConf (optional)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.hadoopFile">
<code class="sig-name descname">hadoopFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">inputFormatClass</em>, <em class="sig-param">keyClass</em>, <em class="sig-param">valueClass</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">batchSize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.hadoopFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.hadoopFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an ‘old’ Hadoop InputFormat with arbitrary key and value class from HDFS,
a local file system (available on all nodes), or any Hadoop-supported file system URI.
The mechanism is the same as for sc.sequenceFile.</p>
<p>A Hadoop configuration can be passed in as a Python dict. This will be converted into a
Configuration in Java.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to Hadoop file</p></li>
<li><p><strong>inputFormatClass</strong> – fully qualified classname of Hadoop InputFormat
(e.g. “org.apache.hadoop.mapred.TextInputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.Text”)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.LongWritable”)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – Hadoop configuration, passed in as a dict
(None by default)</p></li>
<li><p><strong>batchSize</strong> – The number of Python objects represented as a single
Java object. (default 0, choose batchSize automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.hadoopRDD">
<code class="sig-name descname">hadoopRDD</code><span class="sig-paren">(</span><em class="sig-param">inputFormatClass</em>, <em class="sig-param">keyClass</em>, <em class="sig-param">valueClass</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">batchSize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.hadoopRDD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.hadoopRDD" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an ‘old’ Hadoop InputFormat with arbitrary key and value class, from an arbitrary
Hadoop configuration, which is passed in as a Python dict.
This will be converted into a Configuration in Java.
The mechanism is the same as for sc.sequenceFile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputFormatClass</strong> – fully qualified classname of Hadoop InputFormat
(e.g. “org.apache.hadoop.mapred.TextInputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.Text”)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.LongWritable”)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – Hadoop configuration, passed in as a dict
(None by default)</p></li>
<li><p><strong>batchSize</strong> – The number of Python objects represented as a single
Java object. (default 0, choose batchSize automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.newAPIHadoopFile">
<code class="sig-name descname">newAPIHadoopFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">inputFormatClass</em>, <em class="sig-param">keyClass</em>, <em class="sig-param">valueClass</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">batchSize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.newAPIHadoopFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.newAPIHadoopFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a ‘new API’ Hadoop InputFormat with arbitrary key and value class from HDFS,
a local file system (available on all nodes), or any Hadoop-supported file system URI.
The mechanism is the same as for sc.sequenceFile.</p>
<p>A Hadoop configuration can be passed in as a Python dict. This will be converted into a
Configuration in Java</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to Hadoop file</p></li>
<li><p><strong>inputFormatClass</strong> – fully qualified classname of Hadoop InputFormat
(e.g. “org.apache.hadoop.mapreduce.lib.input.TextInputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.Text”)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.LongWritable”)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – Hadoop configuration, passed in as a dict
(None by default)</p></li>
<li><p><strong>batchSize</strong> – The number of Python objects represented as a single
Java object. (default 0, choose batchSize automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.newAPIHadoopRDD">
<code class="sig-name descname">newAPIHadoopRDD</code><span class="sig-paren">(</span><em class="sig-param">inputFormatClass</em>, <em class="sig-param">keyClass</em>, <em class="sig-param">valueClass</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">batchSize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.newAPIHadoopRDD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.newAPIHadoopRDD" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a ‘new API’ Hadoop InputFormat with arbitrary key and value class, from an arbitrary
Hadoop configuration, which is passed in as a Python dict.
This will be converted into a Configuration in Java.
The mechanism is the same as for sc.sequenceFile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputFormatClass</strong> – fully qualified classname of Hadoop InputFormat
(e.g. “org.apache.hadoop.mapreduce.lib.input.TextInputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.Text”)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.LongWritable”)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – Hadoop configuration, passed in as a dict
(None by default)</p></li>
<li><p><strong>batchSize</strong> – The number of Python objects represented as a single
Java object. (default 0, choose batchSize automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.parallelize">
<code class="sig-name descname">parallelize</code><span class="sig-paren">(</span><em class="sig-param">c</em>, <em class="sig-param">numSlices=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.parallelize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.parallelize" title="Permalink to this definition">¶</a></dt>
<dd><p>Distribute a local Python collection to form an RDD. Using xrange
is recommended if the input represents a range for performance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[[0], [2], [3], [4], [6]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[[], [0], [], [2], [4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.pickleFile">
<code class="sig-name descname">pickleFile</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">minPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.pickleFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.pickleFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an RDD previously saved using <a class="reference internal" href="#pyspark.RDD.saveAsPickleFile" title="pyspark.RDD.saveAsPickleFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDD.saveAsPickleFile</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmpFile</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmpFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">saveAsPickleFile</span><span class="p">(</span><span class="n">tmpFile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">pickleFile</span><span class="p">(</span><span class="n">tmpFile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.range">
<code class="sig-name descname">range</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">end=None</em>, <em class="sig-param">step=1</em>, <em class="sig-param">numSlices=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.range" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new RDD of int containing elements from <cite>start</cite> to <cite>end</cite>
(exclusive), increased by <cite>step</cite> every element. Can be called the same
way as python’s built-in range() function. If called with a single argument,
the argument is interpreted as <cite>end</cite>, and <cite>start</cite> is set to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – the start value</p></li>
<li><p><strong>end</strong> – the end value (exclusive)</p></li>
<li><p><strong>step</strong> – the incremental step (default: 1)</p></li>
<li><p><strong>numSlices</strong> – the number of partitions of the new RDD</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An RDD of int</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[1, 3, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.runJob">
<code class="sig-name descname">runJob</code><span class="sig-paren">(</span><em class="sig-param">rdd</em>, <em class="sig-param">partitionFunc</em>, <em class="sig-param">partitions=None</em>, <em class="sig-param">allowLocal=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.runJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.runJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the given partitionFunc on the specified set of partitions,
returning the result as an array of elements.</p>
<p>If ‘partitions’ is not specified, this will run over all partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">myRDD</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">part</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">part</span><span class="p">])</span>
<span class="go">[0, 1, 4, 9, 16, 25]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">myRDD</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">part</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">part</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[0, 1, 16, 25]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.sequenceFile">
<code class="sig-name descname">sequenceFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">keyClass=None</em>, <em class="sig-param">valueClass=None</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">minSplits=None</em>, <em class="sig-param">batchSize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.sequenceFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.sequenceFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a Hadoop SequenceFile with arbitrary key and value Writable class from HDFS,
a local file system (available on all nodes), or any Hadoop-supported file system URI.
The mechanism is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>A Java RDD is created from the SequenceFile or other InputFormat, and the key
and value Writable classes</p></li>
<li><p>Serialization is attempted via Pyrolite pickling</p></li>
<li><p>If this fails, the fallback is to call ‘toString’ on each key and value</p></li>
<li><p><a class="reference internal" href="#pyspark.PickleSerializer" title="pyspark.PickleSerializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PickleSerializer</span></code></a> is used to deserialize pickled objects on the Python side</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to sequncefile</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.Text”)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.LongWritable”)</p></li>
<li><p><strong>keyConverter</strong> – </p></li>
<li><p><strong>valueConverter</strong> – </p></li>
<li><p><strong>minSplits</strong> – minimum splits in dataset
(default min(2, sc.defaultParallelism))</p></li>
<li><p><strong>batchSize</strong> – The number of Python objects represented as a single
Java object. (default 0, choose batchSize automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setCheckpointDir">
<code class="sig-name descname">setCheckpointDir</code><span class="sig-paren">(</span><em class="sig-param">dirName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setCheckpointDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setCheckpointDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the directory under which RDDs are going to be checkpointed. The
directory must be a HDFS path if running on a cluster.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setJobDescription">
<code class="sig-name descname">setJobDescription</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setJobDescription"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setJobDescription" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a human readable description of the current job.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setJobGroup">
<code class="sig-name descname">setJobGroup</code><span class="sig-paren">(</span><em class="sig-param">groupId</em>, <em class="sig-param">description</em>, <em class="sig-param">interruptOnCancel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setJobGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setJobGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a group ID to all the jobs started by this thread until the group ID is set to a
different value or cleared.</p>
<p>Often, a unit of execution in an application consists of multiple Spark actions or jobs.
Application programmers can use this method to group all those jobs together and give a
group description. Once set, the Spark web UI will associate such jobs with this group.</p>
<p>The application can use <a class="reference internal" href="#pyspark.SparkContext.cancelJobGroup" title="pyspark.SparkContext.cancelJobGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext.cancelJobGroup</span></code></a> to cancel all
running jobs in this group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">threading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Not Set&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">map_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Task should have been cancelled&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">start_job</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">global</span> <span class="n">result</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">sc</span><span class="o">.</span><span class="n">setJobGroup</span><span class="p">(</span><span class="s2">&quot;job_to_cancel&quot;</span><span class="p">,</span> <span class="s2">&quot;some description&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_func</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Cancelled&quot;</span>
<span class="gp">... </span>    <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">stop_job</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sc</span><span class="o">.</span><span class="n">cancelJobGroup</span><span class="p">(</span><span class="s2">&quot;job_to_cancel&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress</span> <span class="o">=</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">start_job</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">stop_job</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress</span> <span class="o">=</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">Cancelled</span>
</pre></div>
</div>
<p>If interruptOnCancel is set to true for the job group, then job cancellation will result
in Thread.interrupt() being called on the job’s executor threads. This is useful to help
ensure that the tasks are actually stopped in a timely manner, but is off by default due
to HDFS-1208, where HDFS may respond to Thread.interrupt() by marking nodes as dead.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setLocalProperty">
<code class="sig-name descname">setLocalProperty</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setLocalProperty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setLocalProperty" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a local property that affects jobs submitted from this thread, such as the
Spark fair scheduler pool.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setLogLevel">
<code class="sig-name descname">setLogLevel</code><span class="sig-paren">(</span><em class="sig-param">logLevel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setLogLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setLogLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Control our logLevel. This overrides any user-defined log settings.
Valid log levels include: ALL, DEBUG, ERROR, FATAL, INFO, OFF, TRACE, WARN</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.setSystemProperty">
<em class="property">classmethod </em><code class="sig-name descname">setSystemProperty</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.setSystemProperty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.setSystemProperty" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a Java system property, such as spark.executor.memory. This must
must be invoked before instantiating SparkContext.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.show_profiles">
<code class="sig-name descname">show_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.show_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.show_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the profile stats to stdout</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.sparkUser">
<code class="sig-name descname">sparkUser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.sparkUser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.sparkUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Get SPARK_USER for user who is running SparkContext.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.startTime">
<em class="property">property </em><code class="sig-name descname">startTime</code><a class="headerlink" href="#pyspark.SparkContext.startTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the epoch time when the Spark Context was started.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.statusTracker">
<code class="sig-name descname">statusTracker</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.statusTracker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.statusTracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#pyspark.StatusTracker" title="pyspark.StatusTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatusTracker</span></code></a> object</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Shut down the SparkContext.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.textFile">
<code class="sig-name descname">textFile</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">minPartitions=None</em>, <em class="sig-param">use_unicode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.textFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.textFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a text file from HDFS, a local file system (available on all
nodes), or any Hadoop-supported file system URI, and return it as an
RDD of Strings.</p>
<p>If use_unicode is False, the strings will be kept as <cite>str</cite> (encoding
as <cite>utf-8</cite>), which is faster and smaller than unicode. (Added in
Spark 1.2)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s2">&quot;sample-text.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">testFile</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">testFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textFile</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textFile</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[&#39;Hello world!&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.uiWebUrl">
<em class="property">property </em><code class="sig-name descname">uiWebUrl</code><a class="headerlink" href="#pyspark.SparkContext.uiWebUrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the URL of the SparkUI instance started by this SparkContext</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">rdds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.union"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the union of a list of RDDs.</p>
<p>This supports unions() of RDDs with different serialized formats,
although this forces them to be reserialized using the default
serializer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s2">&quot;union-text.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">testFile</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">testFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textFile</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textFile</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[&#39;Hello&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parallelized</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;World!&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="n">textFile</span><span class="p">,</span> <span class="n">parallelized</span><span class="p">])</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[&#39;Hello&#39;, &#39;World!&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.version">
<em class="property">property </em><code class="sig-name descname">version</code><a class="headerlink" href="#pyspark.SparkContext.version" title="Permalink to this definition">¶</a></dt>
<dd><p>The version of Spark on which this application is running.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkContext.wholeTextFiles">
<code class="sig-name descname">wholeTextFiles</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">minPartitions=None</em>, <em class="sig-param">use_unicode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/context.html#SparkContext.wholeTextFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkContext.wholeTextFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a directory of text files from HDFS, a local file system
(available on all nodes), or any  Hadoop-supported file system
URI. Each file is read as a single record and returned in a
key-value pair, where the key is the path of each file, the
value is the content of each file.</p>
<p>If use_unicode is False, the strings will be kept as <cite>str</cite> (encoding
as <cite>utf-8</cite>), which is faster and smaller than unicode. (Added in
Spark 1.2)</p>
<p>For example, if you have the following files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00000</span>
<span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span>
<span class="o">...</span>
<span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="n">nnnnn</span>
</pre></div>
</div>
<p>Do <cite>rdd = sparkContext.wholeTextFiles(“hdfs://a-hdfs-path”)</cite>,
then <code class="xref py py-class docutils literal notranslate"><span class="pre">rdd</span></code> contains:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00000</span><span class="p">,</span> <span class="n">its</span> <span class="n">content</span><span class="p">)</span>
<span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="mi">00001</span><span class="p">,</span> <span class="n">its</span> <span class="n">content</span><span class="p">)</span>
<span class="o">...</span>
<span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">hdfs</span><span class="o">-</span><span class="n">path</span><span class="o">/</span><span class="n">part</span><span class="o">-</span><span class="n">nnnnn</span><span class="p">,</span> <span class="n">its</span> <span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Small files are preferred, as each file will be loaded
fully in memory.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dirPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dirPath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirPath</span><span class="p">,</span> <span class="s2">&quot;1.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">file1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirPath</span><span class="p">,</span> <span class="s2">&quot;2.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">file2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textFiles</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">wholeTextFiles</span><span class="p">(</span><span class="n">dirPath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">textFiles</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;.../1.txt&#39;, &#39;1&#39;), (&#39;.../2.txt&#39;, &#39;2&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.SparkFiles">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">SparkFiles</code><a class="reference internal" href="_modules/pyspark/files.html#SparkFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves paths to files added through
L{SparkContext.addFile()&lt;pyspark.context.SparkContext.addFile&gt;}.</p>
<p>SparkFiles contains only classmethods; users should not create SparkFiles
instances.</p>
<dl class="method">
<dt id="pyspark.SparkFiles.get">
<em class="property">classmethod </em><code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/files.html#SparkFiles.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkFiles.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the absolute path of a file added through <a class="reference internal" href="#pyspark.SparkContext.addFile" title="pyspark.SparkContext.addFile"><code class="xref py py-func docutils literal notranslate"><span class="pre">SparkContext.addFile()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.SparkFiles.getRootDirectory">
<em class="property">classmethod </em><code class="sig-name descname">getRootDirectory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/files.html#SparkFiles.getRootDirectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkFiles.getRootDirectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the root directory that contains files added through
<a class="reference internal" href="#pyspark.SparkContext.addFile" title="pyspark.SparkContext.addFile"><code class="xref py py-func docutils literal notranslate"><span class="pre">SparkContext.addFile()</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.RDD">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">RDD</code><span class="sig-paren">(</span><em class="sig-param">jrdd</em>, <em class="sig-param">ctx</em>, <em class="sig-param">jrdd_deserializer=AutoBatchedSerializer(PickleSerializer())</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD" title="Permalink to this definition">¶</a></dt>
<dd><p>A Resilient Distributed Dataset (RDD), the basic abstraction in Spark.
Represents an immutable, partitioned collection of elements that can be
operated on in parallel.</p>
<dl class="method">
<dt id="pyspark.RDD.aggregate">
<code class="sig-name descname">aggregate</code><span class="sig-paren">(</span><em class="sig-param">zeroValue</em>, <em class="sig-param">seqOp</em>, <em class="sig-param">combOp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.aggregate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate the elements of each partition, and then the results for all
the partitions, using a given combine functions and a neutral “zero
value.”</p>
<p>The functions <cite>op(t1, t2)</cite> is allowed to modify <code class="xref py py-class docutils literal notranslate"><span class="pre">t1</span></code> and return it
as its result value to avoid object allocation; however, it should not
modify <code class="xref py py-class docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<p>The first function (seqOp) can return a different result type, U, than
the type of this RDD. Thus, we need one operation for merging a T into
an U and one operation for merging two U</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seqOp</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combOp</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seqOp</span><span class="p">,</span> <span class="n">combOp</span><span class="p">)</span>
<span class="go">(10, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([])</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seqOp</span><span class="p">,</span> <span class="n">combOp</span><span class="p">)</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.aggregateByKey">
<code class="sig-name descname">aggregateByKey</code><span class="sig-paren">(</span><em class="sig-param">zeroValue</em>, <em class="sig-param">seqFunc</em>, <em class="sig-param">combFunc</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.aggregateByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.aggregateByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate the values of each key, using given combine functions and a neutral
“zero value”. This function can return a different result type, U, than the type
of the values in this RDD, V. Thus, we need one operation for merging a V into
a U and one operation for merging two U’s, The former operation is used for merging
values within a partition, and the latter is used for merging values between
partitions. To avoid memory allocation, both of these functions are
allowed to modify and return their first argument instead of creating a new U.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.barrier">
<code class="sig-name descname">barrier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.barrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.barrier" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Marks the current stage as a barrier stage, where Spark must launch all tasks together.
In case of a task failure, instead of only restarting the failed task, Spark will abort the
entire stage and relaunch all tasks for this stage.
The barrier execution mode feature is experimental and it only handles limited scenarios.
Please read the linked SPIP and design docs to understand the limitations and future plans.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>an <a class="reference internal" href="#pyspark.RDDBarrier" title="pyspark.RDDBarrier"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDDBarrier</span></code></a> instance that provides actions within a barrier stage.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyspark.BarrierTaskContext" title="pyspark.BarrierTaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">BarrierTaskContext</span></code></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="http://jira.apache.org/jira/browse/SPARK-24374">SPIP: Barrier Execution Mode</a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://jira.apache.org/jira/browse/SPARK-24582">Design Doc</a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.cache">
<code class="sig-name descname">cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Persist this RDD with the default storage level (<code class="xref py py-class docutils literal notranslate"><span class="pre">MEMORY_ONLY</span></code>).</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.cartesian">
<code class="sig-name descname">cartesian</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.cartesian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Cartesian product of this RDD and another one, that is, the
RDD of all pairs of elements <cite>(a, b)</cite> where <code class="xref py py-class docutils literal notranslate"><span class="pre">a</span></code> is in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">b</span></code> is in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">cartesian</span><span class="p">(</span><span class="n">rdd</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(1, 1), (1, 2), (2, 1), (2, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.checkpoint">
<code class="sig-name descname">checkpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark this RDD for checkpointing. It will be saved to a file inside the
checkpoint directory set with <a class="reference internal" href="#pyspark.SparkContext.setCheckpointDir" title="pyspark.SparkContext.setCheckpointDir"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext.setCheckpointDir()</span></code></a> and
all references to its parent RDDs will be removed. This function must
be called before any job has been executed on this RDD. It is strongly
recommended that this RDD is persisted in memory, otherwise saving it
on a file will require recomputation.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.coalesce">
<code class="sig-name descname">coalesce</code><span class="sig-paren">(</span><em class="sig-param">numPartitions</em>, <em class="sig-param">shuffle=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.coalesce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.coalesce" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD that is reduced into <cite>numPartitions</cite> partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[[1], [2, 3], [4, 5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 4, 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.cogroup">
<code class="sig-name descname">cogroup</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.cogroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.cogroup" title="Permalink to this definition">¶</a></dt>
<dd><p>For each key k in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>, return a resulting RDD that
contains a tuple with the list of values for that key in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> as
well as <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">cogroup</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()))]</span>
<span class="go">[(&#39;a&#39;, ([1], [2])), (&#39;b&#39;, ([4], []))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.collect">
<code class="sig-name descname">collect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.collect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list that contains all of the elements in this RDD.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should only be used if the resulting array is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.collectAsMap">
<code class="sig-name descname">collectAsMap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.collectAsMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.collectAsMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the key-value pairs in this RDD to the master as a dictionary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method should only be used if the resulting data is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">collectAsMap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.combineByKey">
<code class="sig-name descname">combineByKey</code><span class="sig-paren">(</span><em class="sig-param">createCombiner</em>, <em class="sig-param">mergeValue</em>, <em class="sig-param">mergeCombiners</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.combineByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.combineByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to combine the elements for each key using a custom
set of aggregation functions.</p>
<p>Turns an RDD[(K, V)] into a result of type RDD[(K, C)], for a “combined
type” C.</p>
<p>Users provide three functions:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">createCombiner</span></code>, which turns a V into a C (e.g., creates
a one-element list)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">mergeValue</span></code>, to merge a V into a C (e.g., adds it to the end of
a list)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">mergeCombiners</span></code>, to combine two C’s into a single one (e.g., merges
the lists)</p></li>
</ul>
</div></blockquote>
<p>To avoid memory allocation, both mergeValue and mergeCombiners are allowed to
modify and return their first argument instead of creating a new C.</p>
<p>In addition, users can control the partitioning of the output RDD.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>V and C can be different – for example, one might group an RDD of type
(Int, Int) into an RDD of type (Int, List[Int]).</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">combineByKey</span><span class="p">(</span><span class="n">to_list</span><span class="p">,</span> <span class="n">append</span><span class="p">,</span> <span class="n">extend</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, [1, 2]), (&#39;b&#39;, [1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.context">
<em class="property">property </em><code class="sig-name descname">context</code><a class="headerlink" href="#pyspark.RDD.context" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pyspark.SparkContext" title="pyspark.SparkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext</span></code></a> that this RDD was created on.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.count">
<code class="sig-name descname">count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of elements in this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.countApprox">
<code class="sig-name descname">countApprox</code><span class="sig-paren">(</span><em class="sig-param">timeout</em>, <em class="sig-param">confidence=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.countApprox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.countApprox" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Approximate version of count() that returns a potentially incomplete
result within a timeout, even if not all tasks have finished.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">countApprox</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="go">1000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.countApproxDistinct">
<code class="sig-name descname">countApproxDistinct</code><span class="sig-paren">(</span><em class="sig-param">relativeSD=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.countApproxDistinct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.countApproxDistinct" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Return approximate number of distinct elements in the RDD.</p>
<p>The algorithm used is based on streamlib’s implementation of
<a class="reference external" href="http://dx.doi.org/10.1145/2452376.2452456">“HyperLogLog in Practice: Algorithmic Engineering of a State
of The Art Cardinality Estimation Algorithm”, available here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>relativeSD</strong> – Relative accuracy. Smaller values create
counters that require more space.
It must be greater than 0.000017.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">countApproxDistinct</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">900</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1100</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="n">i</span> <span class="o">%</span> <span class="mi">20</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)])</span><span class="o">.</span><span class="n">countApproxDistinct</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">16</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">24</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.countByKey">
<code class="sig-name descname">countByKey</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.countByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.countByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of elements for each key, and return the result to the
master as a dictionary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">countByKey</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 2), (&#39;b&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.countByValue">
<code class="sig-name descname">countByValue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.countByValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.countByValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the count of each unique value in this RDD as a dictionary of
(value, count) pairs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">countByValue</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, 2), (2, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.distinct">
<code class="sig-name descname">distinct</code><span class="sig-paren">(</span><em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.distinct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.distinct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD containing the distinct elements in this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD containing only the elements that satisfy a predicate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.first">
<code class="sig-name descname">first</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.first"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.first" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first element in this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">RDD is empty</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.flatMap">
<code class="sig-name descname">flatMap</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.flatMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.flatMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD by first applying a function to all elements of this
RDD, and then flattening the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[1, 1, 1, 2, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(2, 2), (2, 2), (3, 3), (3, 3), (4, 4), (4, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.flatMapValues">
<code class="sig-name descname">flatMapValues</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.flatMapValues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.flatMapValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass each value in the key-value pair RDD through a flatMap function
without changing the keys; this also retains the original RDD’s
partitioning.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">flatMapValues</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, &#39;x&#39;), (&#39;a&#39;, &#39;y&#39;), (&#39;a&#39;, &#39;z&#39;), (&#39;b&#39;, &#39;p&#39;), (&#39;b&#39;, &#39;r&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.fold">
<code class="sig-name descname">fold</code><span class="sig-paren">(</span><em class="sig-param">zeroValue</em>, <em class="sig-param">op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.fold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.fold" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate the elements of each partition, and then the results for all
the partitions, using a given associative function and a neutral “zero value.”</p>
<p>The function <cite>op(t1, t2)</cite> is allowed to modify <code class="xref py py-class docutils literal notranslate"><span class="pre">t1</span></code> and return it
as its result value to avoid object allocation; however, it should not
modify <code class="xref py py-class docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<p>This behaves somewhat differently from fold operations implemented
for non-distributed collections in functional languages like Scala.
This fold operation may be applied to partitions individually, and then
fold those results into the final result, rather than apply the fold
to each element sequentially in some defined ordering. For functions
that are not commutative, the result may differ from that of a fold
applied to a non-distributed collection.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">fold</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.foldByKey">
<code class="sig-name descname">foldByKey</code><span class="sig-paren">(</span><em class="sig-param">zeroValue</em>, <em class="sig-param">func</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.foldByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.foldByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the values for each key using an associative function “func”
and a neutral “zeroValue” which may be added to the result an
arbitrary number of times, and must not change the result
(e.g., 0 for addition, or 1 for multiplication.).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">foldByKey</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 2), (&#39;b&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.foreach">
<code class="sig-name descname">foreach</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.foreach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.foreach" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a function to all elements of this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.foreachPartition">
<code class="sig-name descname">foreachPartition</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.foreachPartition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.foreachPartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a function to each partition of this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
<span class="gp">... </span>         <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">foreachPartition</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.fullOuterJoin">
<code class="sig-name descname">fullOuterJoin</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.fullOuterJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.fullOuterJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a right outer join of <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>For each element (k, v) in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code>, the resulting RDD will either
contain all pairs (k, (v, w)) for w in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>, or the pair
(k, (v, None)) if no elements in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code> have key k.</p>
<p>Similarly, for each element (k, w) in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>, the resulting RDD will
either contain all pairs (k, (v, w)) for v in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code>, or the pair
(k, (None, w)) if no elements in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> have key k.</p>
<p>Hash-partitions the resulting RDD into the given number of partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fullOuterJoin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, (1, 2)), (&#39;b&#39;, (4, None)), (&#39;c&#39;, (None, 8))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.getCheckpointFile">
<code class="sig-name descname">getCheckpointFile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.getCheckpointFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.getCheckpointFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of the file to which this RDD was checkpointed</p>
<p>Not defined if RDD is checkpointed locally.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.getNumPartitions">
<code class="sig-name descname">getNumPartitions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.getNumPartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.getNumPartitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of partitions in RDD</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">getNumPartitions</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.getStorageLevel">
<code class="sig-name descname">getStorageLevel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.getStorageLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.getStorageLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the RDD’s current storage level.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span><span class="o">.</span><span class="n">getStorageLevel</span><span class="p">()</span>
<span class="go">StorageLevel(False, False, False, False, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rdd1</span><span class="o">.</span><span class="n">getStorageLevel</span><span class="p">())</span>
<span class="go">Serialized 1x Replicated</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.glom">
<code class="sig-name descname">glom</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.glom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.glom" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD created by coalescing all elements within each partition
into a list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[[1, 2], [3, 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.groupBy">
<code class="sig-name descname">groupBy</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.groupBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.groupBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD of grouped items.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">result</span><span class="p">])</span>
<span class="go">[(0, [2, 8]), (1, [1, 1, 3, 5])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.groupByKey">
<code class="sig-name descname">groupByKey</code><span class="sig-paren">(</span><em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.groupByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.groupByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Group the values for each key in the RDD into a single sequence.
Hash-partitions the resulting RDD with numPartitions partitions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are grouping in order to perform an aggregation (such as a
sum or average) over each key, using reduceByKey or aggregateByKey will
provide much better performance.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">groupByKey</span><span class="p">()</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 2), (&#39;b&#39;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">groupByKey</span><span class="p">()</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, [1, 1]), (&#39;b&#39;, [1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.groupWith">
<code class="sig-name descname">groupWith</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">*others</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.groupWith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.groupWith" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for cogroup but with support for multiple RDDs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">groupWith</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()))]</span>
<span class="go">[(&#39;a&#39;, ([5], [1], [2], [])), (&#39;b&#39;, ([6], [4], [], [42]))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.histogram">
<code class="sig-name descname">histogram</code><span class="sig-paren">(</span><em class="sig-param">buckets</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a histogram using the provided buckets. The buckets
are all open to the right except for the last which is closed.
e.g. [1,10,20,50] means the buckets are [1,10) [10,20) [20,50],
which means 1&lt;=x&lt;10, 10&lt;=x&lt;20, 20&lt;=x&lt;=50. And on the input of 1
and 50 we would have a histogram of 1,0,1.</p>
<p>If your histogram is evenly spaced (e.g. [0, 10, 20, 30]),
this can be switched from an O(log n) inseration to O(1) per
element (where n is the number of buckets).</p>
<p>Buckets must be sorted, not contain any duplicates, and have
at least two elements.</p>
<p>If <cite>buckets</cite> is a number, it will generate buckets which are
evenly spaced between the minimum and maximum of the RDD. For
example, if the min value is 0 and the max is 100, given <cite>buckets</cite>
as 2, the resulting buckets will be [0,50) [50,100]. <cite>buckets</cite> must
be at least 1. An exception is raised if the RDD contains infinity.
If the elements in the RDD do not vary (max == min), a single bucket
will be used.</p>
<p>The return value is a tuple of buckets and histogram.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([0, 25, 50], [25, 26])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">histogram</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="go">([0, 5, 25, 50], [5, 20, 26])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">histogram</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>  <span class="c1"># evenly spaced buckets</span>
<span class="go">([0, 15, 30, 45, 60], [15, 15, 15, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;bd&quot;</span><span class="p">,</span> <span class="s2">&quot;ef&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">histogram</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">))</span>
<span class="go">((&#39;a&#39;, &#39;b&#39;, &#39;c&#39;), [2, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.id">
<code class="sig-name descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A unique ID for this RDD (within its SparkContext).</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.intersection">
<code class="sig-name descname">intersection</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of this RDD and another one. The output will
not contain any duplicate elements, even if the input RDDs did.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method performs a shuffle internally.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">rdd2</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.isCheckpointed">
<code class="sig-name descname">isCheckpointed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.isCheckpointed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.isCheckpointed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this RDD is checkpointed and materialized, either reliably or locally.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.isEmpty">
<code class="sig-name descname">isEmpty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.isEmpty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.isEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if and only if the RDD contains no elements at all.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>an RDD may be empty even when it has at least 1 partition.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([])</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.isLocallyCheckpointed">
<code class="sig-name descname">isLocallyCheckpointed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.isLocallyCheckpointed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.isLocallyCheckpointed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this RDD is marked for local checkpointing.</p>
<p>Exposed for testing.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.join">
<code class="sig-name descname">join</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD containing all pairs of elements with matching keys in
<code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>Each pair of elements will be returned as a (k, (v1, v2)) tuple, where
(k, v1) is in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and (k, v2) is in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>Performs a hash join across the cluster.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, (1, 2)), (&#39;a&#39;, (1, 3))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.keyBy">
<code class="sig-name descname">keyBy</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.keyBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.keyBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tuples of the elements in this RDD by applying <code class="xref py py-class docutils literal notranslate"><span class="pre">f</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">keyBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">cogroup</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())]</span>
<span class="go">[(0, [[0], [0]]), (1, [[1], [1]]), (2, [[], [2]]), (3, [[], [3]]), (4, [[2], [4]])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.keys">
<code class="sig-name descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD with the keys of each tuple.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[1, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.leftOuterJoin">
<code class="sig-name descname">leftOuterJoin</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.leftOuterJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.leftOuterJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a left outer join of <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>For each element (k, v) in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code>, the resulting RDD will either
contain all pairs (k, (v, w)) for w in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>, or the pair
(k, (v, None)) if no elements in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code> have key k.</p>
<p>Hash-partitions the resulting RDD into the given number of partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">leftOuterJoin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, (1, 2)), (&#39;b&#39;, (4, None))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.localCheckpoint">
<code class="sig-name descname">localCheckpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.localCheckpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.localCheckpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark this RDD for local checkpointing using Spark’s existing caching layer.</p>
<p>This method is for users who wish to truncate RDD lineages while skipping the expensive
step of replicating the materialized data in a reliable distributed file system. This is
useful for RDDs with long lineages that need to be truncated periodically (e.g. GraphX).</p>
<p>Local checkpointing sacrifices fault-tolerance for performance. In particular, checkpointed
data is written to ephemeral local storage in the executors instead of to a reliable,
fault-tolerant storage. The effect is that if an executor fails during the computation,
the checkpointed data may no longer be accessible, causing an irrecoverable job failure.</p>
<p>This is NOT safe to use with dynamic allocation, which removes executors along
with their cached blocks. If you must use both features, you are advised to set
<code class="xref py py-class docutils literal notranslate"><span class="pre">spark.dynamicAllocation.cachedExecutorIdleTimeout</span></code> to a high value.</p>
<p>The checkpoint directory set through <a class="reference internal" href="#pyspark.SparkContext.setCheckpointDir" title="pyspark.SparkContext.setCheckpointDir"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext.setCheckpointDir()</span></code></a> is not used.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.lookup">
<code class="sig-name descname">lookup</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of values in the RDD for key <cite>key</cite>. This operation
is done efficiently if the RDD has a known partitioner by only
searching the partition that the key maps to.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># slow</span>
<span class="go">[42]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># fast</span>
<span class="go">[42]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">groupByKey</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">rdd2</span><span class="o">.</span><span class="n">lookup</span><span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[&#39;c&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.map">
<code class="sig-name descname">map</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD by applying a function to each element of this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;b&#39;, 1), (&#39;c&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.mapPartitions">
<code class="sig-name descname">mapPartitions</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.mapPartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.mapPartitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD by applying a function to each partition of this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span> <span class="k">yield</span> <span class="nb">sum</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">mapPartitions</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[3, 7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.mapPartitionsWithIndex">
<code class="sig-name descname">mapPartitionsWithIndex</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.mapPartitionsWithIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.mapPartitionsWithIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD by applying a function to each partition of this RDD,
while tracking the index of the original partition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">splitIndex</span><span class="p">,</span> <span class="n">iterator</span><span class="p">):</span> <span class="k">yield</span> <span class="n">splitIndex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">mapPartitionsWithIndex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.mapPartitionsWithSplit">
<code class="sig-name descname">mapPartitionsWithSplit</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.mapPartitionsWithSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.mapPartitionsWithSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated: use mapPartitionsWithIndex instead.</p>
<p>Return a new RDD by applying a function to each partition of this RDD,
while tracking the index of the original partition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">splitIndex</span><span class="p">,</span> <span class="n">iterator</span><span class="p">):</span> <span class="k">yield</span> <span class="n">splitIndex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">mapPartitionsWithSplit</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.mapValues">
<code class="sig-name descname">mapValues</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.mapValues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.mapValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass each value in the key-value pair RDD through a map function
without changing the keys; this also retains the original RDD’s
partitioning.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;lemon&quot;</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;grapes&quot;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 3), (&#39;b&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.max">
<code class="sig-name descname">max</code><span class="sig-paren">(</span><em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the maximum item in this RDD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – A function used to generate key for comparing</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">43.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">5.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.mean">
<code class="sig-name descname">mean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mean of this RDD’s elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.meanApprox">
<code class="sig-name descname">meanApprox</code><span class="sig-paren">(</span><em class="sig-param">timeout</em>, <em class="sig-param">confidence=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.meanApprox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.meanApprox" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Approximate operation to return the mean within a timeout
or meet the confidence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span> <span class="o">/</span> <span class="mf">1000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">meanApprox</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.min">
<code class="sig-name descname">min</code><span class="sig-paren">(</span><em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the minimum item in this RDD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – A function used to generate key for comparing</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">10.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.name">
<code class="sig-name descname">name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of this RDD.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.partitionBy">
<code class="sig-name descname">partitionBy</code><span class="sig-paren">(</span><em class="sig-param">numPartitions</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.partitionBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.partitionBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the RDD partitioned using the specified partitioner.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sets</span> <span class="o">=</span> <span class="n">pairs</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.persist">
<code class="sig-name descname">persist</code><span class="sig-paren">(</span><em class="sig-param">storageLevel=StorageLevel(False</em>, <em class="sig-param">True</em>, <em class="sig-param">False</em>, <em class="sig-param">False</em>, <em class="sig-param">1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.persist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Set this RDD’s storage level to persist its values across operations
after the first time it is computed. This can only be used to assign
a new storage level if the RDD does not have a storage level set yet.
If no storage level is specified defaults to (<code class="xref py py-class docutils literal notranslate"><span class="pre">MEMORY_ONLY</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span><span class="o">.</span><span class="n">is_cached</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.pipe">
<code class="sig-name descname">pipe</code><span class="sig-paren">(</span><em class="sig-param">command</em>, <em class="sig-param">env=None</em>, <em class="sig-param">checkCode=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.pipe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.pipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD created by piping elements to a forked external process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[&#39;1&#39;, &#39;2&#39;, &#39;&#39;, &#39;3&#39;]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>checkCode</strong> – whether or not to check the return value of the shell command.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.randomSplit">
<code class="sig-name descname">randomSplit</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.randomSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.randomSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly splits this RDD with the provided weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> – weights for splits, will be normalized if they don’t sum to 1</p></li>
<li><p><strong>seed</strong> – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>split RDDs in a list</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span><span class="p">,</span> <span class="n">rdd2</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd1</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span> <span class="o">+</span> <span class="n">rdd2</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">150</span> <span class="o">&lt;</span> <span class="n">rdd1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">250</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">250</span> <span class="o">&lt;</span> <span class="n">rdd2</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">350</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.reduce">
<code class="sig-name descname">reduce</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the elements of this RDD using the specified commutative and
associative binary operator. Currently reduces partitions locally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">((</span><span class="mi">2</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([])</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Can not reduce() empty RDD</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.reduceByKey">
<code class="sig-name descname">reduceByKey</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.reduceByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.reduceByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the values for each key using an associative and commutative reduce function.</p>
<p>This will also perform the merging locally on each mapper before
sending results to a reducer, similarly to a “combiner” in MapReduce.</p>
<p>Output will be partitioned with <code class="xref py py-class docutils literal notranslate"><span class="pre">numPartitions</span></code> partitions, or
the default parallelism level if <code class="xref py py-class docutils literal notranslate"><span class="pre">numPartitions</span></code> is not specified.
Default partitioner is hash-partition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 2), (&#39;b&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.reduceByKeyLocally">
<code class="sig-name descname">reduceByKeyLocally</code><span class="sig-paren">(</span><em class="sig-param">func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.reduceByKeyLocally"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.reduceByKeyLocally" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the values for each key using an associative and commutative reduce function, but
return the results immediately to the master as a dictionary.</p>
<p>This will also perform the merging locally on each mapper before
sending results to a reducer, similarly to a “combiner” in MapReduce.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">reduceByKeyLocally</span><span class="p">(</span><span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 2), (&#39;b&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.repartition">
<code class="sig-name descname">repartition</code><span class="sig-paren">(</span><em class="sig-param">numPartitions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.repartition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.repartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new RDD that has exactly numPartitions partitions.</p>
<p>Can increase or decrease the level of parallelism in this RDD.
Internally, this uses a shuffle to redistribute data.
If you are decreasing the number of partitions in this RDD, consider
using <cite>coalesce</cite>, which can avoid performing a shuffle.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[[1], [2, 3], [4, 5], [6, 7]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.repartitionAndSortWithinPartitions">
<code class="sig-name descname">repartitionAndSortWithinPartitions</code><span class="sig-paren">(</span><em class="sig-param">numPartitions=None</em>, <em class="sig-param">partitionFunc=&lt;function portable_hash&gt;</em>, <em class="sig-param">ascending=True</em>, <em class="sig-param">keyfunc=&lt;function RDD.&lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.repartitionAndSortWithinPartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.repartitionAndSortWithinPartitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Repartition the RDD according to the given partitioner and, within each resulting partition,
sort records by their keys.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd2</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">repartitionAndSortWithinPartitions</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd2</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[[(0, 5), (0, 8), (2, 6)], [(1, 3), (3, 8), (3, 8)]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.rightOuterJoin">
<code class="sig-name descname">rightOuterJoin</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.rightOuterJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.rightOuterJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a right outer join of <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>For each element (k, w) in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>, the resulting RDD will either
contain all pairs (k, (v, w)) for v in this, or the pair (k, (None, w))
if no elements in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> have key k.</p>
<p>Hash-partitions the resulting RDD into the given number of partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">rightOuterJoin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, (2, 1)), (&#39;b&#39;, (None, 4))]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">withReplacement</em>, <em class="sig-param">fraction</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sampled subset of this RDD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>withReplacement</strong> – can elements be sampled multiple times (replaced when sampled out)</p></li>
<li><p><strong>fraction</strong> – expected size of the sample as a fraction of this RDD’s size
without replacement: probability that each element is chosen; fraction must be [0, 1]
with replacement: expected number of times each element is chosen; fraction must be &gt;= 0</p></li>
<li><p><strong>seed</strong> – seed for the random number generator</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not guaranteed to provide exactly the fraction specified of the total
count of the given <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">6</span> <span class="o">&lt;=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">81</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">14</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sampleByKey">
<code class="sig-name descname">sampleByKey</code><span class="sig-paren">(</span><em class="sig-param">withReplacement</em>, <em class="sig-param">fractions</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sampleByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sampleByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a subset of this RDD sampled by key (via stratified sampling).
Create a sample of this RDD using variable sampling rates for
different keys as specified by fractions, a key to sampling rate map.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fractions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">fractions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">cartesian</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">sampleByKey</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">fractions</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">groupByKey</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="ow">and</span> <span class="mi">50</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">150</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">max</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">999</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">max</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">999</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sampleStdev">
<code class="sig-name descname">sampleStdev</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sampleStdev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sampleStdev" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sample standard deviation of this RDD’s elements (which
corrects for bias in estimating the standard deviation by dividing by
N-1 instead of N).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">sampleStdev</span><span class="p">()</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sampleVariance">
<code class="sig-name descname">sampleVariance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sampleVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sampleVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sample variance of this RDD’s elements (which corrects
for bias in estimating the variance by dividing by N-1 instead of N).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">sampleVariance</span><span class="p">()</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsHadoopDataset">
<code class="sig-name descname">saveAsHadoopDataset</code><span class="sig-paren">(</span><em class="sig-param">conf</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsHadoopDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsHadoopDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a Python RDD of key-value pairs (of form <cite>RDD[(K, V)]</cite>) to any Hadoop file
system, using the old Hadoop OutputFormat API (mapred package). Keys/values are
converted for output using either user specified converters or, by default,
<code class="xref py py-class docutils literal notranslate"><span class="pre">org.apache.spark.api.python.JavaToWritableConverter</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf</strong> – Hadoop job configuration, passed in as a dict</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsHadoopFile">
<code class="sig-name descname">saveAsHadoopFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">outputFormatClass</em>, <em class="sig-param">keyClass=None</em>, <em class="sig-param">valueClass=None</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em>, <em class="sig-param">compressionCodecClass=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsHadoopFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsHadoopFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a Python RDD of key-value pairs (of form <cite>RDD[(K, V)]</cite>) to any Hadoop file
system, using the old Hadoop OutputFormat API (mapred package). Key and value types
will be inferred if not specified. Keys and values are converted for output using either
user specified converters or <code class="xref py py-class docutils literal notranslate"><span class="pre">org.apache.spark.api.python.JavaToWritableConverter</span></code>. The
<code class="xref py py-class docutils literal notranslate"><span class="pre">conf</span></code> is applied on top of the base Hadoop conf associated with the SparkContext
of this RDD to create a merged Hadoop MapReduce job configuration for saving the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to Hadoop file</p></li>
<li><p><strong>outputFormatClass</strong> – fully qualified classname of Hadoop OutputFormat
(e.g. “org.apache.hadoop.mapred.SequenceFileOutputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.IntWritable”, None by default)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.Text”, None by default)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – (None by default)</p></li>
<li><p><strong>compressionCodecClass</strong> – (None by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsNewAPIHadoopDataset">
<code class="sig-name descname">saveAsNewAPIHadoopDataset</code><span class="sig-paren">(</span><em class="sig-param">conf</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsNewAPIHadoopDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsNewAPIHadoopDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a Python RDD of key-value pairs (of form <cite>RDD[(K, V)]</cite>) to any Hadoop file
system, using the new Hadoop OutputFormat API (mapreduce package). Keys/values are
converted for output using either user specified converters or, by default,
<code class="xref py py-class docutils literal notranslate"><span class="pre">org.apache.spark.api.python.JavaToWritableConverter</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf</strong> – Hadoop job configuration, passed in as a dict</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsNewAPIHadoopFile">
<code class="sig-name descname">saveAsNewAPIHadoopFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">outputFormatClass</em>, <em class="sig-param">keyClass=None</em>, <em class="sig-param">valueClass=None</em>, <em class="sig-param">keyConverter=None</em>, <em class="sig-param">valueConverter=None</em>, <em class="sig-param">conf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsNewAPIHadoopFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsNewAPIHadoopFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a Python RDD of key-value pairs (of form <cite>RDD[(K, V)]</cite>) to any Hadoop file
system, using the new Hadoop OutputFormat API (mapreduce package). Key and value types
will be inferred if not specified. Keys and values are converted for output using either
user specified converters or <code class="xref py py-class docutils literal notranslate"><span class="pre">org.apache.spark.api.python.JavaToWritableConverter</span></code>. The
<code class="xref py py-class docutils literal notranslate"><span class="pre">conf</span></code> is applied on top of the base Hadoop conf associated with the SparkContext
of this RDD to create a merged Hadoop MapReduce job configuration for saving the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to Hadoop file</p></li>
<li><p><strong>outputFormatClass</strong> – fully qualified classname of Hadoop OutputFormat
(e.g. “org.apache.hadoop.mapreduce.lib.output.SequenceFileOutputFormat”)</p></li>
<li><p><strong>keyClass</strong> – fully qualified classname of key Writable class
(e.g. “org.apache.hadoop.io.IntWritable”, None by default)</p></li>
<li><p><strong>valueClass</strong> – fully qualified classname of value Writable class
(e.g. “org.apache.hadoop.io.Text”, None by default)</p></li>
<li><p><strong>keyConverter</strong> – (None by default)</p></li>
<li><p><strong>valueConverter</strong> – (None by default)</p></li>
<li><p><strong>conf</strong> – Hadoop job configuration, passed in as a dict (None by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsPickleFile">
<code class="sig-name descname">saveAsPickleFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">batchSize=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsPickleFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsPickleFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save this RDD as a SequenceFile of serialized objects. The serializer
used is <code class="xref py py-class docutils literal notranslate"><span class="pre">pyspark.serializers.PickleSerializer</span></code>, default batch size
is 10.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmpFile</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmpFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;spark&#39;</span><span class="p">,</span> <span class="s1">&#39;rdd&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">saveAsPickleFile</span><span class="p">(</span><span class="n">tmpFile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">pickleFile</span><span class="p">(</span><span class="n">tmpFile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[&#39;1&#39;, &#39;2&#39;, &#39;rdd&#39;, &#39;spark&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsSequenceFile">
<code class="sig-name descname">saveAsSequenceFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">compressionCodecClass=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsSequenceFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsSequenceFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a Python RDD of key-value pairs (of form <cite>RDD[(K, V)]</cite>) to any Hadoop file
system, using the <code class="xref py py-class docutils literal notranslate"><span class="pre">org.apache.hadoop.io.Writable</span></code> types that we convert from the
RDD’s key and value types. The mechanism is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Pyrolite is used to convert pickled Python RDD into RDD of Java objects.</p></li>
<li><p>Keys and values of this Java RDD are converted to Writables and written out.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to sequence file</p></li>
<li><p><strong>compressionCodecClass</strong> – (None by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.saveAsTextFile">
<code class="sig-name descname">saveAsTextFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">compressionCodecClass=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.saveAsTextFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.saveAsTextFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save this RDD as a text file, using string representations of elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to text file</p></li>
<li><p><strong>compressionCodecClass</strong> – (None by default) string i.e.
“org.apache.hadoop.io.compress.GzipCodec”</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="p">(</span><span class="n">tempFile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fileinput</span> <span class="k">import</span> <span class="nb">input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">glob</span> <span class="k">import</span> <span class="n">glob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">tempFile</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;/part-0000*&quot;</span><span class="p">))))</span>
<span class="go">&#39;0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n&#39;</span>
</pre></div>
</div>
<p>Empty lines are tolerated when saving to text files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile2</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="p">(</span><span class="n">tempFile2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">tempFile2</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;/part-0000*&quot;</span><span class="p">))))</span>
<span class="go">&#39;\n\n\nbar\nfoo\n&#39;</span>
</pre></div>
</div>
<p>Using compressionCodecClass</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile3</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tempFile3</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">codec</span> <span class="o">=</span> <span class="s2">&quot;org.apache.hadoop.io.compress.GzipCodec&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="p">(</span><span class="n">tempFile3</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">codec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fileinput</span> <span class="k">import</span> <span class="nb">input</span><span class="p">,</span> <span class="n">hook_compressed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">tempFile3</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;/part*.gz&quot;</span><span class="p">),</span> <span class="n">openhook</span><span class="o">=</span><span class="n">hook_compressed</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="go">&#39;bar\nfoo\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.setName">
<code class="sig-name descname">setName</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.setName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.setName" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a name to this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd1</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;RDD1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;RDD1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sortBy">
<code class="sig-name descname">sortBy</code><span class="sig-paren">(</span><em class="sig-param">keyfunc</em>, <em class="sig-param">ascending=True</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sortBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sortBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts this RDD by the given keyfunc</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">sortBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;1&#39;, 3), (&#39;2&#39;, 5), (&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;d&#39;, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">sortBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;1&#39;, 3), (&#39;d&#39;, 4), (&#39;2&#39;, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sortByKey">
<code class="sig-name descname">sortByKey</code><span class="sig-paren">(</span><em class="sig-param">ascending=True</em>, <em class="sig-param">numPartitions=None</em>, <em class="sig-param">keyfunc=&lt;function RDD.&lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sortByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sortByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts this RDD, which is assumed to consist of (key, value) pairs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="go">(&#39;1&#39;, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;1&#39;, 3), (&#39;2&#39;, 5), (&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;d&#39;, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;1&#39;, 3), (&#39;2&#39;, 5), (&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;d&#39;, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp2</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Mary&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;had&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lamb&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp2</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="s1">&#39;whose&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;fleece&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;was&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">keyfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 3), (&#39;fleece&#39;, 7), (&#39;had&#39;, 2), (&#39;lamb&#39;, 5),...(&#39;white&#39;, 9), (&#39;whose&#39;, 6)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.stats">
<code class="sig-name descname">stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">StatCounter</span></code> object that captures the mean, variance
and count of the RDD’s elements in one operation.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.stdev">
<code class="sig-name descname">stdev</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.stdev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.stdev" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard deviation of this RDD’s elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">stdev</span><span class="p">()</span>
<span class="go">0.816...</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.subtract">
<code class="sig-name descname">subtract</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.subtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Return each value in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> that is not contained in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;b&#39;, 4), (&#39;b&#39;, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.subtractByKey">
<code class="sig-name descname">subtractByKey</code><span class="sig-paren">(</span><em class="sig-param">other</em>, <em class="sig-param">numPartitions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.subtractByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.subtractByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Return each (key, value) pair in <code class="xref py py-class docutils literal notranslate"><span class="pre">self</span></code> that has no pair with matching
key in <code class="xref py py-class docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">subtractByKey</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
<span class="go">[(&#39;b&#39;, 4), (&#39;b&#39;, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sum">
<code class="sig-name descname">sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add up the elements in this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">6.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.sumApprox">
<code class="sig-name descname">sumApprox</code><span class="sig-paren">(</span><em class="sig-param">timeout</em>, <em class="sig-param">confidence=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.sumApprox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.sumApprox" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Approximate operation to return the sum within a timeout
or meet the confidence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">sumApprox</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.take">
<code class="sig-name descname">take</code><span class="sig-paren">(</span><em class="sig-param">num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.take"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.take" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the first num elements of the RDD.</p>
<p>It works by first scanning one partition, and use the results from
that partition to estimate the number of additional partitions needed
to satisfy the limit.</p>
<p>Translated from the Scala implementation in RDD#take().</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method should only be used if the resulting array is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[2, 3, 4, 5, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[91, 92, 93]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.takeOrdered">
<code class="sig-name descname">takeOrdered</code><span class="sig-paren">(</span><em class="sig-param">num</em>, <em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.takeOrdered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.takeOrdered" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the N elements from an RDD ordered in ascending order or as
specified by the optional key function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method should only be used if the resulting array is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">takeOrdered</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">takeOrdered</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="go">[10, 9, 7, 6, 5, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.takeSample">
<code class="sig-name descname">takeSample</code><span class="sig-paren">(</span><em class="sig-param">withReplacement</em>, <em class="sig-param">num</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.takeSample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.takeSample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fixed-size sampled subset of this RDD.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should only be used if the resulting array is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">takeSample</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">takeSample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">rdd</span><span class="o">.</span><span class="n">takeSample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.toDebugString">
<code class="sig-name descname">toDebugString</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.toDebugString"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.toDebugString" title="Permalink to this definition">¶</a></dt>
<dd><p>A description of this RDD and its recursive dependencies for debugging.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.toLocalIterator">
<code class="sig-name descname">toLocalIterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.toLocalIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.toLocalIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator that contains all of the elements in this RDD.
The iterator will consume as much memory as the largest partition in this RDD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rdd</span><span class="o">.</span><span class="n">toLocalIterator</span><span class="p">()]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.top">
<code class="sig-name descname">top</code><span class="sig-paren">(</span><em class="sig-param">num</em>, <em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.top" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the top N elements from an RDD.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should only be used if the resulting array is expected
to be small, as all the data is loaded into the driver’s memory.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It returns the list sorted in descending order.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">top</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[12]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">top</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[6, 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">top</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[4, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.treeAggregate">
<code class="sig-name descname">treeAggregate</code><span class="sig-paren">(</span><em class="sig-param">zeroValue</em>, <em class="sig-param">seqOp</em>, <em class="sig-param">combOp</em>, <em class="sig-param">depth=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.treeAggregate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.treeAggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates the elements of this RDD in a multi-level tree
pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>depth</strong> – suggested depth of the tree (default: 2)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeAggregate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeAggregate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeAggregate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeAggregate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeAggregate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.treeReduce">
<code class="sig-name descname">treeReduce</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">depth=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.treeReduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.treeReduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the elements of this RDD in a multi-level tree pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>depth</strong> – suggested depth of the tree (default: 2)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeReduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeReduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeReduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeReduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">treeReduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.union"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of this RDD and another one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdd</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">rdd</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[1, 1, 2, 3, 1, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.unpersist">
<code class="sig-name descname">unpersist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.unpersist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.unpersist" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark the RDD as non-persistent, and remove all blocks for it from
memory and disk.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.values">
<code class="sig-name descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an RDD with the values of each tuple.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.variance">
<code class="sig-name descname">variance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the variance of this RDD’s elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">variance</span><span class="p">()</span>
<span class="go">0.666...</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.zip">
<code class="sig-name descname">zip</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.zip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.zip" title="Permalink to this definition">¶</a></dt>
<dd><p>Zips this RDD with another one, returning key-value pairs with the
first element in each RDD second element in each RDD, etc. Assumes
that the two RDDs have the same number of partitions and the same
number of elements in each partition (e.g. one was made through
a map on the other).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1005</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(0, 1000), (1, 1001), (2, 1002), (3, 1003), (4, 1004)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.zipWithIndex">
<code class="sig-name descname">zipWithIndex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.zipWithIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.zipWithIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Zips this RDD with its element indices.</p>
<p>The ordering is first based on the partition index and then the
ordering of items within each partition. So the first item in
the first partition gets index 0, and the last item in the last
partition receives the largest index.</p>
<p>This method needs to trigger a spark job when this RDD contains
more than one partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 0), (&#39;b&#39;, 1), (&#39;c&#39;, 2), (&#39;d&#39;, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.RDD.zipWithUniqueId">
<code class="sig-name descname">zipWithUniqueId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDD.zipWithUniqueId"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDD.zipWithUniqueId" title="Permalink to this definition">¶</a></dt>
<dd><p>Zips this RDD with generated unique Long ids.</p>
<p>Items in the kth partition will get ids k, n+k, 2*n+k, …, where
n is the number of partitions. So there may exist gaps, but this
method won’t trigger a spark job, which is different from
<a class="reference internal" href="#pyspark.RDD.zipWithIndex" title="pyspark.RDD.zipWithIndex"><code class="xref py py-class docutils literal notranslate"><span class="pre">zipWithIndex</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">zipWithUniqueId</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 0), (&#39;b&#39;, 1), (&#39;c&#39;, 4), (&#39;d&#39;, 2), (&#39;e&#39;, 5)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.StorageLevel">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">StorageLevel</code><span class="sig-paren">(</span><em class="sig-param">useDisk</em>, <em class="sig-param">useMemory</em>, <em class="sig-param">useOffHeap</em>, <em class="sig-param">deserialized</em>, <em class="sig-param">replication=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/storagelevel.html#StorageLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StorageLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags for controlling the storage of an RDD. Each StorageLevel records whether to use memory,
whether to drop the RDD to disk if it falls out of memory, whether to keep the data in memory
in a JAVA-specific serialized format, and whether to replicate the RDD partitions on multiple
nodes. Also contains static constants for some commonly used storage levels, MEMORY_ONLY.
Since the data is always serialized on the Python side, all the constants use the serialized
formats.</p>
<dl class="attribute">
<dt id="pyspark.StorageLevel.DISK_ONLY">
<code class="sig-name descname">DISK_ONLY</code><em class="property"> = StorageLevel(True, False, False, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.DISK_ONLY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.DISK_ONLY_2">
<code class="sig-name descname">DISK_ONLY_2</code><em class="property"> = StorageLevel(True, False, False, False, 2)</em><a class="headerlink" href="#pyspark.StorageLevel.DISK_ONLY_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_AND_DISK">
<code class="sig-name descname">MEMORY_AND_DISK</code><em class="property"> = StorageLevel(True, True, False, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_AND_DISK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_AND_DISK_2">
<code class="sig-name descname">MEMORY_AND_DISK_2</code><em class="property"> = StorageLevel(True, True, False, False, 2)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_AND_DISK_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_AND_DISK_SER">
<code class="sig-name descname">MEMORY_AND_DISK_SER</code><em class="property"> = StorageLevel(True, True, False, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_AND_DISK_SER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_AND_DISK_SER_2">
<code class="sig-name descname">MEMORY_AND_DISK_SER_2</code><em class="property"> = StorageLevel(True, True, False, False, 2)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_AND_DISK_SER_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_ONLY">
<code class="sig-name descname">MEMORY_ONLY</code><em class="property"> = StorageLevel(False, True, False, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_ONLY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_ONLY_2">
<code class="sig-name descname">MEMORY_ONLY_2</code><em class="property"> = StorageLevel(False, True, False, False, 2)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_ONLY_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_ONLY_SER">
<code class="sig-name descname">MEMORY_ONLY_SER</code><em class="property"> = StorageLevel(False, True, False, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_ONLY_SER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.MEMORY_ONLY_SER_2">
<code class="sig-name descname">MEMORY_ONLY_SER_2</code><em class="property"> = StorageLevel(False, True, False, False, 2)</em><a class="headerlink" href="#pyspark.StorageLevel.MEMORY_ONLY_SER_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyspark.StorageLevel.OFF_HEAP">
<code class="sig-name descname">OFF_HEAP</code><em class="property"> = StorageLevel(True, True, True, False, 1)</em><a class="headerlink" href="#pyspark.StorageLevel.OFF_HEAP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.Broadcast">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">Broadcast</code><span class="sig-paren">(</span><em class="sig-param">sc=None</em>, <em class="sig-param">value=None</em>, <em class="sig-param">pickle_registry=None</em>, <em class="sig-param">path=None</em>, <em class="sig-param">sock_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast" title="Permalink to this definition">¶</a></dt>
<dd><p>A broadcast variable created with <a class="reference internal" href="#pyspark.SparkContext.broadcast" title="pyspark.SparkContext.broadcast"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext.broadcast()</span></code></a>.
Access its value through <code class="xref py py-class docutils literal notranslate"><span class="pre">value</span></code>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.context</span> <span class="k">import</span> <span class="n">SparkContext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">broadcast</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">value</span>
<span class="go">[1, 2, 3, 4, 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5, 1, 2, 3, 4, 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">large_broadcast</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyspark.Broadcast.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast.destroy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy all data and metadata related to this broadcast variable.
Use this with caution; once a broadcast variable has been destroyed,
it cannot be used again. This method blocks until destroy has
completed.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.Broadcast.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast.dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast.dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspark.Broadcast.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspark.Broadcast.load_from_path">
<code class="sig-name descname">load_from_path</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast.load_from_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast.load_from_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspark.Broadcast.unpersist">
<code class="sig-name descname">unpersist</code><span class="sig-paren">(</span><em class="sig-param">blocking=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/broadcast.html#Broadcast.unpersist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Broadcast.unpersist" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete cached copies of this broadcast on the executors. If the
broadcast is used after this is called, it will need to be
re-sent to each executor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>blocking</strong> – Whether to block until unpersisting has completed</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspark.Broadcast.value">
<em class="property">property </em><code class="sig-name descname">value</code><a class="headerlink" href="#pyspark.Broadcast.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the broadcasted value</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.Accumulator">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">Accumulator</code><span class="sig-paren">(</span><em class="sig-param">aid</em>, <em class="sig-param">value</em>, <em class="sig-param">accum_param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/accumulators.html#Accumulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Accumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>A shared variable that can be accumulated, i.e., has a commutative and associative “add”
operation. Worker tasks on a Spark cluster can add values to an Accumulator with the <cite>+=</cite>
operator, but only the driver program is allowed to access its value, using <a class="reference internal" href="#pyspark.Accumulator.value" title="pyspark.Accumulator.value"><code class="xref py py-class docutils literal notranslate"><span class="pre">value</span></code></a>.
Updates from the workers get propagated automatically to the driver program.</p>
<p>While <a class="reference internal" href="#pyspark.SparkContext" title="pyspark.SparkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkContext</span></code></a> supports accumulators for primitive data types like <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, users can also define accumulators for custom types by providing a custom
<a class="reference internal" href="#pyspark.AccumulatorParam" title="pyspark.AccumulatorParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">AccumulatorParam</span></code></a> object. Refer to the doctest of this module for an example.</p>
<dl class="method">
<dt id="pyspark.Accumulator.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param">term</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/accumulators.html#Accumulator.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Accumulator.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a term to this accumulator’s value</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.Accumulator.value">
<em class="property">property </em><code class="sig-name descname">value</code><a class="headerlink" href="#pyspark.Accumulator.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the accumulator’s value; only usable in driver program</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.AccumulatorParam">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">AccumulatorParam</code><a class="reference internal" href="_modules/pyspark/accumulators.html#AccumulatorParam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.AccumulatorParam" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper object that defines how to accumulate values of a given type.</p>
<dl class="method">
<dt id="pyspark.AccumulatorParam.addInPlace">
<code class="sig-name descname">addInPlace</code><span class="sig-paren">(</span><em class="sig-param">value1</em>, <em class="sig-param">value2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/accumulators.html#AccumulatorParam.addInPlace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.AccumulatorParam.addInPlace" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two values of the accumulator’s data type, returning a new value;
for efficiency, can also update <code class="xref py py-class docutils literal notranslate"><span class="pre">value1</span></code> in place and return it.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.AccumulatorParam.zero">
<code class="sig-name descname">zero</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/accumulators.html#AccumulatorParam.zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.AccumulatorParam.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a “zero value” for the type, compatible in dimensions with the
provided <code class="xref py py-class docutils literal notranslate"><span class="pre">value</span></code> (e.g., a zero vector)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.MarshalSerializer">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">MarshalSerializer</code><a class="reference internal" href="_modules/pyspark/serializers.html#MarshalSerializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.MarshalSerializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes objects using Python’s Marshal serializer:</p>
<blockquote>
<div><p><a class="reference external" href="http://docs.python.org/2/library/marshal.html">http://docs.python.org/2/library/marshal.html</a></p>
</div></blockquote>
<p>This serializer is faster than PickleSerializer but supports fewer datatypes.</p>
<dl class="method">
<dt id="pyspark.MarshalSerializer.dumps">
<code class="sig-name descname">dumps</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/serializers.html#MarshalSerializer.dumps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.MarshalSerializer.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize an object into a byte array.
When batching is used, this will be called with an array of objects.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.MarshalSerializer.loads">
<code class="sig-name descname">loads</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/serializers.html#MarshalSerializer.loads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.MarshalSerializer.loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize an object from a byte array.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.PickleSerializer">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">PickleSerializer</code><a class="reference internal" href="_modules/pyspark/serializers.html#PickleSerializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.PickleSerializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes objects using Python’s pickle serializer:</p>
<blockquote>
<div><p><a class="reference external" href="http://docs.python.org/2/library/pickle.html">http://docs.python.org/2/library/pickle.html</a></p>
</div></blockquote>
<p>This serializer supports nearly any Python object, but may
not be as fast as more specialized serializers.</p>
<dl class="method">
<dt id="pyspark.PickleSerializer.dumps">
<code class="sig-name descname">dumps</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/serializers.html#PickleSerializer.dumps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.PickleSerializer.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize an object into a byte array.
When batching is used, this will be called with an array of objects.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.PickleSerializer.loads">
<code class="sig-name descname">loads</code><span class="sig-paren">(</span><em class="sig-param">obj</em>, <em class="sig-param">encoding='bytes'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/serializers.html#PickleSerializer.loads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.PickleSerializer.loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize an object from a byte array.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.StatusTracker">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">StatusTracker</code><span class="sig-paren">(</span><em class="sig-param">jtracker</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-level status reporting APIs for monitoring job and stage progress.</p>
<p>These APIs intentionally provide very weak consistency semantics;
consumers of these APIs should be prepared to handle empty / missing
information. For example, a job’s stage ids may be known but the status
API may not have any information about the details of those stages, so
<cite>getStageInfo</cite> could potentially return <cite>None</cite> for a valid stage id.</p>
<p>To limit memory usage, these APIs only provide information on recent
jobs / stages.  These APIs will provide information for the last
<cite>spark.ui.retainedStages</cite> stages and <cite>spark.ui.retainedJobs</cite> jobs.</p>
<dl class="method">
<dt id="pyspark.StatusTracker.getActiveJobsIds">
<code class="sig-name descname">getActiveJobsIds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker.getActiveJobsIds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker.getActiveJobsIds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array containing the ids of all active jobs.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.StatusTracker.getActiveStageIds">
<code class="sig-name descname">getActiveStageIds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker.getActiveStageIds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker.getActiveStageIds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array containing the ids of all active stages.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.StatusTracker.getJobIdsForGroup">
<code class="sig-name descname">getJobIdsForGroup</code><span class="sig-paren">(</span><em class="sig-param">jobGroup=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker.getJobIdsForGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker.getJobIdsForGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all known jobs in a particular job group.  If
<cite>jobGroup</cite> is None, then returns all known jobs that are not
associated with a job group.</p>
<p>The returned list may contain running, failed, and completed jobs,
and may vary across invocations of this method. This method does
not guarantee the order of the elements in its result.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.StatusTracker.getJobInfo">
<code class="sig-name descname">getJobInfo</code><span class="sig-paren">(</span><em class="sig-param">jobId</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker.getJobInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker.getJobInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#pyspark.SparkJobInfo" title="pyspark.SparkJobInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkJobInfo</span></code></a> object, or None if the job info
could not be found or was garbage collected.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.StatusTracker.getStageInfo">
<code class="sig-name descname">getStageInfo</code><span class="sig-paren">(</span><em class="sig-param">stageId</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/status.html#StatusTracker.getStageInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.StatusTracker.getStageInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#pyspark.SparkStageInfo" title="pyspark.SparkStageInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparkStageInfo</span></code></a> object, or None if the stage
info could not be found or was garbage collected.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.SparkJobInfo">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">SparkJobInfo</code><a class="reference internal" href="_modules/pyspark/status.html#SparkJobInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkJobInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Exposes information about Spark Jobs.</p>
</dd></dl>

<dl class="class">
<dt id="pyspark.SparkStageInfo">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">SparkStageInfo</code><a class="reference internal" href="_modules/pyspark/status.html#SparkStageInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.SparkStageInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Exposes information about Spark Stages.</p>
</dd></dl>

<dl class="class">
<dt id="pyspark.Profiler">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">Profiler</code><span class="sig-paren">(</span><em class="sig-param">ctx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#Profiler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Profiler" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>DeveloperApi</p>
</div>
<p>PySpark supports custom profilers, this is to allow for different profilers to
be used as well as outputting to different formats than what is provided in the
BasicProfiler.</p>
<dl class="simple">
<dt>A custom profiler has to define or inherit the following methods:</dt><dd><p>profile - will produce a system profile of some sort.
stats - return the collected stats.
dump - dumps the profiles to a path
add - adds a profile to the existing accumulated profile</p>
</dd>
</dl>
<p>The profiler class is chosen when creating a SparkContext</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="k">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="k">import</span> <span class="n">BasicProfiler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyCustomProfiler</span><span class="p">(</span><span class="n">BasicProfiler</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;My custom profiles for RDD:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.python.profile&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">,</span> <span class="n">profiler_cls</span><span class="o">=</span><span class="n">MyCustomProfiler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">show_profiles</span><span class="p">()</span>
<span class="go">My custom profiles for RDD:1</span>
<span class="go">My custom profiles for RDD:3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyspark.Profiler.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">id</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#Profiler.dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Profiler.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the profile into path, id is the RDD id</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.Profiler.profile">
<code class="sig-name descname">profile</code><span class="sig-paren">(</span><em class="sig-param">func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#Profiler.profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Profiler.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Do profiling on the function <cite>func</cite></p>
</dd></dl>

<dl class="method">
<dt id="pyspark.Profiler.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param">id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#Profiler.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Profiler.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the profile stats to stdout, id is the RDD id</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.Profiler.stats">
<code class="sig-name descname">stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#Profiler.stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.Profiler.stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the collected profiling stats (pstats.Stats)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.BasicProfiler">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">BasicProfiler</code><span class="sig-paren">(</span><em class="sig-param">ctx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#BasicProfiler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BasicProfiler" title="Permalink to this definition">¶</a></dt>
<dd><p>BasicProfiler is the default profiler, which is implemented based on
cProfile and Accumulator</p>
<dl class="method">
<dt id="pyspark.BasicProfiler.profile">
<code class="sig-name descname">profile</code><span class="sig-paren">(</span><em class="sig-param">func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#BasicProfiler.profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BasicProfiler.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs and profiles the method to_profile passed in. A profile object is returned.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.BasicProfiler.stats">
<code class="sig-name descname">stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/profiler.html#BasicProfiler.stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BasicProfiler.stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the collected profiling stats (pstats.Stats)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.TaskContext">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">TaskContext</code><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Contextual information about a task which can be read or mutated during
execution. To access the TaskContext for a running task, use:
<a class="reference internal" href="#pyspark.TaskContext.get" title="pyspark.TaskContext.get"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskContext.get()</span></code></a>.</p>
<dl class="method">
<dt id="pyspark.TaskContext.attemptNumber">
<code class="sig-name descname">attemptNumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.attemptNumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.attemptNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>”
How many times this task has been attempted.  The first task attempt will be assigned
attemptNumber = 0, and subsequent attempts will have increasing attempt numbers.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.TaskContext.get">
<em class="property">classmethod </em><code class="sig-name descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the currently active TaskContext. This can be called inside of
user functions to access contextual information about running tasks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be called on the worker, not the driver. Returns None if not initialized.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.TaskContext.getLocalProperty">
<code class="sig-name descname">getLocalProperty</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.getLocalProperty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.getLocalProperty" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a local property set upstream in the driver, or None if it is missing.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.TaskContext.partitionId">
<code class="sig-name descname">partitionId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.partitionId"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.partitionId" title="Permalink to this definition">¶</a></dt>
<dd><p>The ID of the RDD partition that is computed by this task.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.TaskContext.stageId">
<code class="sig-name descname">stageId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.stageId"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.stageId" title="Permalink to this definition">¶</a></dt>
<dd><p>The ID of the stage that this task belong to.</p>
</dd></dl>

<dl class="method">
<dt id="pyspark.TaskContext.taskAttemptId">
<code class="sig-name descname">taskAttemptId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#TaskContext.taskAttemptId"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.TaskContext.taskAttemptId" title="Permalink to this definition">¶</a></dt>
<dd><p>An ID that is unique to this task attempt (within the same SparkContext, no two task
attempts will share the same attempt ID).  This is roughly equivalent to Hadoop’s
TaskAttemptID.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.RDDBarrier">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">RDDBarrier</code><span class="sig-paren">(</span><em class="sig-param">rdd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDDBarrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDDBarrier" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Wraps an RDD in a barrier stage, which forces Spark to launch tasks of this stage together.
<a class="reference internal" href="#pyspark.RDDBarrier" title="pyspark.RDDBarrier"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDDBarrier</span></code></a> instances are created by <a class="reference internal" href="#pyspark.RDD.barrier" title="pyspark.RDD.barrier"><code class="xref py py-func docutils literal notranslate"><span class="pre">RDD.barrier()</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
<dl class="method">
<dt id="pyspark.RDDBarrier.mapPartitions">
<code class="sig-name descname">mapPartitions</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">preservesPartitioning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/rdd.html#RDDBarrier.mapPartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.RDDBarrier.mapPartitions" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Returns a new RDD by applying a function to each partition of the wrapped RDD,
where tasks are launched together in a barrier stage.
The interface is the same as <a class="reference internal" href="#pyspark.RDD.mapPartitions" title="pyspark.RDD.mapPartitions"><code class="xref py py-func docutils literal notranslate"><span class="pre">RDD.mapPartitions()</span></code></a>.
Please see the API doc there.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.BarrierTaskContext">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">BarrierTaskContext</code><a class="reference internal" href="_modules/pyspark/taskcontext.html#BarrierTaskContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BarrierTaskContext" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>A <a class="reference internal" href="#pyspark.TaskContext" title="pyspark.TaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskContext</span></code></a> with extra contextual info and tooling for tasks in a barrier stage.
Use <a class="reference internal" href="#pyspark.BarrierTaskContext.get" title="pyspark.BarrierTaskContext.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">BarrierTaskContext.get()</span></code></a> to obtain the barrier context for a running barrier task.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
<dl class="method">
<dt id="pyspark.BarrierTaskContext.barrier">
<code class="sig-name descname">barrier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#BarrierTaskContext.barrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BarrierTaskContext.barrier" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Sets a global barrier and waits until all tasks in this stage hit this barrier.
Similar to <cite>MPI_Barrier</cite> function in MPI, this function blocks until all tasks
in the same stage have reached this routine.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In a barrier stage, each task much have the same number of <cite>barrier()</cite>
calls, in all possible code branches.
Otherwise, you may get the job hanging or a SparkException after timeout.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.BarrierTaskContext.get">
<em class="property">classmethod </em><code class="sig-name descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#BarrierTaskContext.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BarrierTaskContext.get" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Return the currently active <a class="reference internal" href="#pyspark.BarrierTaskContext" title="pyspark.BarrierTaskContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">BarrierTaskContext</span></code></a>.
This can be called inside of user functions to access contextual information about
running tasks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be called on the worker, not the driver. Returns None if not initialized.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspark.BarrierTaskContext.getTaskInfos">
<code class="sig-name descname">getTaskInfos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#BarrierTaskContext.getTaskInfos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BarrierTaskContext.getTaskInfos" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Returns <a class="reference internal" href="#pyspark.BarrierTaskInfo" title="pyspark.BarrierTaskInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">BarrierTaskInfo</span></code></a> for all tasks in this barrier stage,
ordered by partition ID.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspark.BarrierTaskInfo">
<em class="property">class </em><code class="sig-prename descclassname">pyspark.</code><code class="sig-name descname">BarrierTaskInfo</code><span class="sig-paren">(</span><em class="sig-param">address</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspark/taskcontext.html#BarrierTaskInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspark.BarrierTaskInfo" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental</p>
</div>
<p>Carries all task infos of a barrier task.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>address</strong> – The IPv4 address (host:port) of the executor that the barrier task is running on</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.0.</span></p>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/spark-logo-hd.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyspark package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#module-pyspark">Contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Spark Python API Docs!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pyspark.sql.html"
                        title="next chapter">pyspark.sql module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyspark.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pyspark.sql.html" title="pyspark.sql module"
             >next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to Spark Python API Docs!"
             >previous</a> |</li>
    
        <li class="nav-item nav-item-0"><a href="index.html">PySpark 2.4.4 documentation</a> &#187;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>